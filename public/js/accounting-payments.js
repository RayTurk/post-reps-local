"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[186,565,960],{9350:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(1601),r={init:function(){this.onPaymentFormSubmit();var e='[name="payment_type"]',t=".form-another-card input",a='[name="card_profile"]',n=".form-another-card select";$(t).prop("disabled",!0),$(e).on("change",(function(r){var o=r.target;$(e).prop("checked",!1),o.checked=!0,"use_another_card"==o.getAttribute("id")?($(t).prop("disabled",!1),$(a).prop("disabled",!0),$(n).prop("disabled",!1)):($(a).prop("disabled",!1),$(t).prop("disabled",!0),$(n).prop("disabled",!0)),console.log(o)})),$('[name="repair_payment_type"]').on("change",(function(e){var a=e.target;$('[name="repair_payment_type"]').prop("checked",!1),a.checked=!0,"repair_use_another_card"==a.getAttribute("id")?($(t).prop("disabled",!1),$(n).prop("disabled",!1),$('[name="repair_card_profile"]').prop("disabled",!0)):($('[name="repair_card_profile"]').prop("disabled",!1),$(t).prop("disabled",!0),$(n).prop("disabled",!0))})),$('[name="removal_payment_type"]').on("change",(function(e){var a=e.target;$('[name="removal_payment_type"]').prop("checked",!1),a.checked=!0,"removal_use_another_card"==a.getAttribute("id")?($(t).prop("disabled",!1),$('[name="removal_card_profile"]').prop("disabled",!0),$(n).prop("disabled",!1)):($('[name="removal_card_profile"]').prop("disabled",!1),$(t).prop("disabled",!0),$(n).prop("disabled",!0))})),$('[name="delivery_payment_type"]').on("change",(function(e){var a=e.target;$('[name="delivery_payment_type"]').prop("checked",!1),a.checked=!0,"delivery_use_another_card"==a.getAttribute("id")?($(t).prop("disabled",!1),$('[name="delivery_card_profile"]').prop("disabled",!0),$(n).prop("disabled",!1)):($('[name="delivery_card_profile"]').prop("disabled",!1),$(t).prop("disabled",!0),$(n).prop("disabled",!0))})),this.orderHold(),this.repairOrderHold(),this.removalOrderHold(),this.deliveryOrderHold(),this.onRepairPaymentFormSubmit(),this.onRemovalPaymentFormSubmit(),this.onDeliveryPaymentFormSubmit(),this.onCardDeclinedOrderHold()},onPaymentFormSubmit:function(){var e=$("#paymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),n.Z.showLoader();var t={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;t[e.name]=e.value})),$.post(n.Z.getSiteUrl("/payment/pay"),t).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var t,a=$('[name="order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("install"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),n.Z.openModal("cardDeclinedModal"),n.Z.hideLoader(""),"card declined"==(null===(t=e.messages.message[1])||void 0===t?void 0:t.text)&&($('[name="payment_type"]').trigger("change"),$("#card_profile_select").empty())}})).fail((function(e){var t=e.responseJSON,a="<ul>";for(var r in a+="<li class='text-danger'><b>"+t.message+"</b></li>",t.errors)$('[name^="'.concat(r,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[r]+"</li>";a+="</ul>",n.Z.alertError(a),n.Z.hideLoader("")}))}))},loadCards:function(e,t){var a="".concat(n.Z.getSiteUrl(),"/payment/get-saved-cards/").concat(t);$.get(a).done((function(t){console.log(t);var a="";$.each(t,(function(t,n){0==e.find('option[value="'.concat(n.customerProfileId,"::").concat(t,'"]')).length&&(a+='<option value="'.concat(n.customerProfileId,"::").concat(t,'">').concat(n.cardType,": XXXX-XXXX-").concat(n.cardNumber,"  exp ").concat(n.expDate,"</option>"))})),e.append(a)})).fail((function(e){n.Z.alertError("Unable to load cards due to server error.")}))},loadAgentCardsVisibleToOffice:function(e,t,a){var r="".concat(n.Z.getSiteUrl(),"/payment/get-agent-cards-visible-to-office/").concat(t,"/").concat(a);$.get(r).done((function(t){console.log(t);var a="";$.each(t,(function(t,n){0==e.find('option[value="'.concat(n.customerProfileId,"::").concat(t,'"]')).length&&(a+='<option value="'.concat(n.customerProfileId,"::").concat(t,'">').concat(n.cardType,": XXXX-XXXX-").concat(n.cardNumber,"  exp ").concat(n.expDate,"</option>"))})),console.log(a),e.append(a)})).fail((function(e){n.Z.alertError("Unable to load cards due to server error.")}))},loadOfficeCardsVisibleToAgent:function(e,t,a,r,o){var s="".concat(n.Z.getSiteUrl(),"/payment/get-office-cards-visible-to-agents/").concat(t,"/").concat(a,"/").concat(r);$.get(s).done((function(t){console.log(t);var a="";$.each(t,(function(t,n){0==e.find('option[value="'.concat(n.customerProfileId,"::").concat(t,'"]')).length&&(a+='<option value="'.concat(n.customerProfileId,"::").concat(t,'">').concat(n.cardType,": XXXX-XXXX-").concat(n.cardNumber,"  exp ").concat(n.expDate,"</option>"))})),e.append(a),"function"==typeof o&&o()})).fail((function(e){n.Z.alertError("Unable to load cards due to server error.")}))},orderHold:function(){$(".order-hold").on("click",(function(e){e.stopImmediatePropagation(),n.Z.showLoader();var t=$('[name="order_id"]').val(),a="".concat(n.Z.getSiteUrl(),"/order/email/").concat(t);$.get(a).done((function(e){window.location.reload()}))}))},repairOrderHold:function(){$(".repair-order-hold").on("click",(function(e){e.stopImmediatePropagation(),n.Z.showLoader();var t=$('[name="repair_order_id"]').val(),a="".concat(n.Z.getSiteUrl(),"/repair/order/email/").concat(t);$.get(a).done((function(e){window.location.reload()}))}))},removalOrderHold:function(){$(".removal-order-hold").on("click",(function(e){e.stopImmediatePropagation(),n.Z.showLoader();var t=$('[name="removal_order_id"]').val(),a="".concat(n.Z.getSiteUrl(),"/removal/order/email/").concat(t);$.get(a).done((function(e){window.location.reload()}))}))},deliveryOrderHold:function(){$(".delivery-order-hold").on("click",(function(e){e.stopImmediatePropagation(),n.Z.showLoader();var t=$('[name="delivery_order_id"]').val(),a="".concat(n.Z.getSiteUrl(),"/delivery/order/email/").concat(t);$.get(a).done((function(e){window.location.reload()}))}))},onRepairPaymentFormSubmit:function(){var e=$("#repairPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),n.Z.showLoader();var t={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;t[e.name]=e.value})),$.post("".concat(n.Z.getSiteUrl(),"/payment/repair/pay"),t).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var t,a=$('[name="repair_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("repair"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),n.Z.openModal("cardDeclinedModal"),n.Z.hideLoader(""),"card declined"==(null===(t=e.messages.message[1])||void 0===t?void 0:t.text)&&($('[name="repair_payment_type"]').trigger("change"),$("#repair_card_profile_select").empty())}})).fail((function(e){console.log(e);var t=e.responseJSON,a="<ul>";for(var r in a+="<li class='text-danger'><b>"+t.message+"</b></li>",t.errors)$('[name^="'.concat(r,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[r]+"</li>";a+="</ul>",n.Z.alertError(a),n.Z.hideLoader("")}))}))},multiplePosts:!1,onRemovalPaymentFormSubmit:function(){var e=$("#removalPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),n.Z.showLoader();var t={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;t[e.name]=e.value})),t.multiplePosts=r.multiplePosts,$.post("".concat(n.Z.getSiteUrl(),"/payment/removal/pay"),t).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var t,a=$('[name="removal_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("removal"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),n.Z.openModal("cardDeclinedModal"),n.Z.hideLoader(""),"card declined"==(null===(t=e.messages.message[1])||void 0===t?void 0:t.text)&&($('[name="removal_payment_type"]').trigger("change"),$("#removal_card_profile_select").empty())}})).fail((function(e){console.log(e);var t=e.responseJSON,a="<ul>";for(var r in a+="<li class='text-danger'><b>"+t.message+"</b></li>",t.errors)$('[name^="'.concat(r,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[r]+"</li>";a+="</ul>",n.Z.alertError(a),n.Z.hideLoader("")}))}))},onDeliveryPaymentFormSubmit:function(){var e=$("#deliveryPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),n.Z.showLoader();var t={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;t[e.name]=e.value})),$.post("".concat(n.Z.getSiteUrl(),"/payment/delivery/pay"),t).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var t,a=$('[name="delivery_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("delivery"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),n.Z.openModal("cardDeclinedModal"),n.Z.hideLoader(""),"card declined"==(null===(t=e.messages.message[1])||void 0===t?void 0:t.text)&&($('[name="delivery_payment_type"]').trigger("change"),$("#delivery_card_profile_select").empty())}})).fail((function(e){console.log(e);var t=e.responseJSON,a="<ul>";for(var r in a+="<li class='text-danger'><b>"+t.message+"</b></li>",t.errors)$('[name^="'.concat(r,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[r]+"</li>";a+="</ul>",n.Z.alertError(a),n.Z.hideLoader("")}))}))},onCardDeclinedOrderHold:function(){$("#cardDeclinedHoldOrderBtn").on("click",(function(e){e.stopImmediatePropagation(),n.Z.closeModal("cardDeclinedModal"),n.Z.openModal("actionNeededModal")})),$("#closeActionNeededModalBtn").on("click",(function(e){e.stopImmediatePropagation(),n.Z.showLoader();var t={order_type:$("#actionNeededOrdertype").val(),order_id:$("#actionNeededOrderId").val()};$.post("".concat(n.Z.getSiteUrl(),"/order/action-needed/email"),t).done((function(e){n.Z.closeModal("actionNeededModal"),window.location.reload()})).fail((function(e){n.Z.alertError(n.Z.serverErrorMessage()),n.Z.hideLoader("")}))}))}};const o=r},5572:(e,t,a)=>{var n=a(7757),r=a.n(n),o=a(1601),s=a(9708),i=a(2630);function c(e,t,a,n,r,o,s){try{var i=e[o](s),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,r)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function s(e){c(o,n,r,s,i,"next",e)}function i(e){c(o,n,r,s,i,"throw",e)}s(void 0)}))}}var d={status_received:0,status_incomplete:1,status_scheduled:2,status_completed:3,status_cancelled:4,date:{asap:1,desired_date_type:2},table:{},userRole:$("#userRole").val(),check_payment:0,card_payment:1,balance_payment:2,invoice_type_single_order:1,init:function(){s.Z.init(),this.datatablePayments(),this.accountingPaymentsInput(),this.reversePayment(),this.exportPDF(),window.viewDetails=this.viewDetails,this.removeAgentFromInvoice(),this.initializeDatePickers(),this.onOfficeChage(),this.exportPayments(),"paymentAmount"in sessionStorage&&sessionStorage.removeItem("paymentAmount"),window.viewOrderDetails=this.viewOrderDetails},viewDetails:function(e){o.Z.showLoader();var t,a,n,r,s,i,c,l,d,p=$("#invoiceDetails"),m=$("#invoiceDetailsTable>tbody"),u=0,g=0,f=0,v=[],_=0;$.get("".concat(o.Z.getSiteUrl(),"/accounting/unpaid/invoice/").concat(e)).done((function(e){p.find("#invoiceNumber").text(e.invoice_number),p.find("#invoiceDate").text(o.Z.formatDate(e.created_at)),p.find("#invoiceDueDate").text(o.Z.formatDate(e.due_date)),t=p.find("#officeAgentName"),a=p.find("#officeAgentAddress"),n=p.find("#officeAgentState"),r=p.find("#officeAgentPhone"),s=p.find("#charges"),i=p.find("#adjustments"),c=p.find("#paid"),l=p.find("#amountDue"),e.agent_name?(t.text(e.agent_name),a.text(e.agent_address),n.text("".concat(e.agent_city,", ").concat(e.agent_state,", ").concat(e.agent_zipcode)),r.text(e.agent_phone)):e.office_name&&(t.text(e.office_name),a.text(e.office_address),n.text("".concat(e.office_city,", ").concat(e.office_state,", ").concat(e.office_zipcode)),r.text(e.office_phone)),e.adjustments.forEach((function(e){u+=parseFloat(e.amount),$("#invoiceAdjustmentsDetailsTable>tbody").append('\n                    <tr>\n                        <td class="">'.concat(e.description,'</td>\n                        <td style="text-align: end">').concat(o.Z.formatDateUsa(e.created_at),'</td>\n                        <td style="text-align: end">$ ').concat(e.amount,"</td>\n                    </tr>\n                "))})),e.payments.forEach((function(t){g+=parseFloat(t.total),$("#invoicePaymentsDetailsTable>tbody").append('\n                    <tr>\n                        <td class="">'.concat(0==t.payment_method?"CHECK":1==t.payment_method?"CC  "+t.card_type+" - "+t.card_last_four:"BALANCE",'</td>\n                        <td class="">').concat(1==e.fully_paid?"Payment Received":"Partial Payment Received",'</td>\n                        <td style="text-align: end">').concat(o.Z.formatDateUsa(t.created_at),'</td>\n                        <td style="text-align: end">$ ').concat(t.total.toFixed(2),"</td>\n                    </tr>\n                "))})),e.invoice_lines.forEach((function(e){f+=parseFloat(e.amount)})),s.text("$ ".concat(f.toFixed(2))),i.text("$ ".concat(u.toFixed(2))),c.text("$ ".concat(g.toFixed(2))),l.text("$ ".concat(Number(e.amount).toFixed(2)));var h,y=null,b=!$.isEmptyObject(e.payments);e.invoice_lines.forEach((function(t,a,n){switch(t.order_type){case 1:$.ajax({url:"".concat(o.Z.getSiteUrl(),"/order/").concat(t.order_id,"/install"),type:"GET",async:!1,success:function(n){h=n.agent_id,null==y||v.includes(n.agent_id)||0!=!a||m.append('\n                                            <tr class="agent-totals">\n                                                <td class=""></td>\n                                                <td class=""></td>\n                                                <td class=""><a href="#" class="'.concat(b?"d-none":"",' btn btn-danger text-white text-decoration-none btn-sm remove-agent" data-agent-id="').concat(n.agent_id,'" data-invoice-id="').concat(e.id,'">Remove Agent</a></td>\n                                                <td colspan="" class="text-right" style="padding-top: 0px; padding-bottom: 40px;">AGENT TOTALS:</td>\n                                                <td class="text-right" style="padding-top: 0px; padding-bottom: 40px;">$ ').concat(_.toFixed(2),"</td>\n                                            </tr>\n                                        ")),v.includes(n.agent_id)||(v.push(n.agent_id),_=0);var r=n.address,s=parseFloat(n.total).toFixed(2);1==t.missing_items&&(r="".concat(n.address,": ").concat(t.description),s=parseFloat(t.amount).toFixed(2)),m.append('\n                                    <tr>\n                                        <td><a href="#" class="text-primary text-uppercase" onclick="window.viewOrderDetails('.concat(n.id,", 'install')\">").concat(n.order_number,'</a></td>\n                                        <td><span class=""><u>INSTALL: </u></span> ').concat(r,"</td>\n                                        <td>\n                                            ").concat(n.agent?n.agent.user.name:"","<br>\n                                            ").concat(n.agent?n.agent.user.phone:"","\n                                        </td>\n                                        <td>").concat(n.date_completed?o.Z.formatDateUsa(n.date_completed):o.Z.formatDateUsa(n.updated_at),'</td>\n                                        <td class="text-right" >$ ').concat(s,"</td>\n                                    </tr>\n                                    ")),d=n,y=n.agent_id}});break;case 2:$.ajax({url:"".concat(o.Z.getSiteUrl(),"/order/").concat(t.order_id,"/repair"),type:"GET",async:!1,success:function(n){h=n.order.agent_id,null==y||v.includes(n.order.agent_id)||0!=!a||m.append('\n                                        <tr class="agent-totals">\n                                            <td class=""></td>\n                                            <td class=""></td>\n                                            <td class=""><a href="#" class="'.concat(b?"d-none":"",' btn btn-danger text-white text-decoration-none btn-sm remove-agent" data-agent-id="').concat(n.order.agent_id,'" data-invoice-id="').concat(e.id,'">Remove Agent</a></td>\n                                            <td colspan="" class="text-right" style="padding-top: 0px; padding-bottom: 40px;">AGENT TOTALS:</td>\n                                            <td class="text-right" style="padding-top: 0px; padding-bottom: 40px;">$ ').concat(_.toFixed(2),"</td>\n                                        </tr>\n                                    ")),v.includes(n.order.agent_id)||(v.push(n.order.agent_id),_=0);var r=n.order.address,s=parseFloat(n.total).toFixed(2);1==t.missing_items&&(r="".concat(n.order.address,": ").concat(t.description),s=parseFloat(t.amount).toFixed(2)),m.append('\n                                <tr>\n                                    <td><a href="#" class="text-primary text-uppercase" onclick="window.viewOrderDetails('.concat(n.id,", 'repair')\">").concat(n.order_number,'</a></td>\n                                    <td><span class=""><u>REPAIR: </u></span> ').concat(r,"</td>\n                                    <td>\n                                        ").concat(n.order.agent?n.order.agent.user.name:"","<br>\n                                        ").concat(n.order.agent?n.order.agent.user.phone:"","\n                                    </td>\n                                    <td>").concat(n.date_completed?o.Z.formatDateUsa(n.date_completed):o.Z.formatDateUsa(n.updated_at),'</td>\n                                    <td class="text-right" >$ ').concat(s,"</td>\n                                </tr>\n                                ")),d=n,y=n.order.agent_id}});break;case 3:$.ajax({url:"".concat(o.Z.getSiteUrl(),"/order/").concat(t.order_id,"/removal"),type:"GET",async:!1,success:function(n){h=n.order.agent_id,null==y||v.includes(n.order.agent_id)||0!=!a||m.append('\n                                        <tr class="agent-totals">\n                                            <td class=""></td>\n                                            <td class=""></td>\n                                            <td class=""><a href="#" class="'.concat(b?"d-none":"",' btn btn-danger text-white text-decoration-none btn-sm remove-agent" data-agent-id="').concat(n.order.agent_id,'" data-invoice-id="').concat(e.id,'">Remove Agent</a></td>\n                                            <td colspan="" class="text-right" style="padding-top: 0px; padding-bottom: 40px;">AGENT TOTALS:</td>\n                                            <td class="text-right" style="padding-top: 0px; padding-bottom: 40px;">$ ').concat(_.toFixed(2),"</td>\n                                        </tr>\n                                    ")),v.includes(n.order.agent_id)||(v.push(n.order.agent_id),_=0);var r=n.order.address,s=parseFloat(n.total).toFixed(2);1==t.missing_items&&(r="".concat(n.order.address,": ").concat(t.description),s=parseFloat(t.amount).toFixed(2)),m.append('\n                                <tr>\n                                    <td><a href="#" class="text-primary text-uppercase" onclick="window.viewOrderDetails('.concat(n.id,", 'removal')\">").concat(n.order_number,'</a></td>\n                                    <td><span class=""><u>REMOVAL: </u></span> ').concat(r,"</td>\n                                    <td>\n                                        ").concat(n.order.agent?n.order.agent.user.name:"","<br>\n                                        ").concat(n.order.agent?n.order.agent.user.phone:"","\n                                    </td>\n                                    <td>").concat(n.date_completed?o.Z.formatDateUsa(n.date_completed):o.Z.formatDateUsa(n.updated_at),'</td>\n                                    <td class="text-right" >$ ').concat(s,"</td>\n                                </tr>\n                                ")),d=n,y=n.order.agent_id}});break;case 4:$.ajax({url:"".concat(o.Z.getSiteUrl(),"/order/").concat(t.order_id,"/delivery"),type:"GET",async:!1,success:function(n){h=n.agent_id,null==y||v.includes(n.agent_id)||0!=!a||m.append('\n                                        <tr class="agent-totals">\n                                            <td class=""></td>\n                                            <td class=""></td>\n                                            <td class=""><a href="#" class="'.concat(b?"d-none":"",' btn btn-danger text-white text-decoration-none btn-sm remove-agent" data-agent-id="').concat(n.agent_id,'" data-invoice-id="').concat(e.id,'">Remove Agent</a></td>\n                                            <td colspan="" class="text-right" style="padding-top: 0px; padding-bottom: 40px;">AGENT TOTALS:</td>\n                                            <td class="text-right" style="padding-top: 0px; padding-bottom: 40px;">$ ').concat(_.toFixed(2),"</td>\n                                        </tr>\n                                    ")),v.includes(n.agent_id)||(v.push(n.agent_id),_=0);var r=n.address,s=parseFloat(n.total).toFixed(2);1==t.missing_items&&(r="".concat(n.address,": ").concat(t.description),s=parseFloat(t.amount).toFixed(2)),m.append('\n                                <tr>\n                                    <td><a href="#" class="text-primary text-uppercase" onclick="window.viewOrderDetails('.concat(n.id,", 'delivery')\">").concat(n.order_number,'</a></td>\n                                    <td><span class=""><u>DELIVERY: </u></span> ').concat(r,"</td>\n                                    <td>\n                                        ").concat(n.agent?n.agent.user.name:"","<br>\n                                        ").concat(n.agent?n.agent.user.phone:"","\n                                    </td>\n                                    <td>").concat(n.date_completed?o.Z.formatDateUsa(n.date_completed):o.Z.formatDateUsa(n.updated_at),'</td>\n                                    <td class="text-right" >$ ').concat(s,"</td>\n                                </tr>\n                                ")),d=n,y=n.agent_id}})}1==t.missing_items?_+=parseFloat(t.amount):_+=parseFloat(d.total),null!=y&&a==n.length-1&&$("#invoiceDetailsTable > tbody:last-child").append('\n                        <tr class="agent-totals-last">\n                            <td class=""></td>\n                            <td class=""></td>\n                            <td class=""><a href="#" class="'.concat(b?"d-none":"",' btn btn-danger text-white text-decoration-none btn-sm remove-agent" data-agent-id="').concat(h,'" data-invoice-id="').concat(e.id,'">Remove Agent</a></td>\n                            <td colspan="" class="text-right" >AGENT TOTALS:</td>\n                            <td class="text-right">$ ').concat(_.toFixed(2),"</td>\n                        </tr>\n                    ")),a==n.length-1&&o.Z.hideLoader("invoiceDetails")}))})),p.on("hidden.bs.modal",(function(e){$(this).removeData(),m.html(""),$("#invoiceAdjustmentsDetailsTable>tbody").html(""),$("#invoicePaymentsDetailsTable>tbody").html("")}))},accountingPaymentsInput:function(){document.getAll(".accountingPaymentsInput").forEach((function(e){(e=$(e)).on("keyup",(function(e){var t=e.target;d.table.fnFilter(t.value)}))}))},datatablePayments:function(){var e=this;return l(r().mark((function t(){var a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a="#accountingPaymentsTable",o.Z.isMobilePhone()&&(a="#accountingPaymentsTableMobile"),o.Z.showLoader(),d.table=$(a).dataTable({language:{search:"_INPUT_",searchPlaceholder:"Search..."},pageLength:10,dom:"rtip",ajax:o.Z.getSiteUrl("/datatable/payments"),serverSide:!0,columnDefs:[],columns:[{data:"invoice.invoice_number",defaultContent:"404",title:"INVOICE #",name:"invoice.invoice_number",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return'\n                            <a href="#" class="text-primary text-uppercase" onclick="window.viewDetails('.concat(a.invoice.id,')">').concat(a.invoice.invoice_number,"</a>\n                        ")}},{data:"invoice.office_name",defaultContent:"404",title:"OFFICE/AGENT",name:"invoice.office_name",searchable:!1,visible:0},{data:"invoice.agent_name",defaultContent:"404",title:"OFFICE/AGENT",name:"invoice.agent_name",searchable:!1,visible:0},{data:"",defaultContent:"404",title:"OFFICE/AGENT",name:"",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return a.invoice.agent_name?'\n                            <p class="m-0">'.concat(a.invoice.office_name,'</p>\n                            <p class="m-0">').concat(a.invoice.agent_name,"</p>\n                        "):"".concat(a.invoice.office_name)}},{data:"invoice.created_at",defaultContent:"...",title:"INV DATE",name:"invoice.created_at",searchable:!1,orderable:!1,visible:1,render:function(e,t,a){return o.Z.formatDateUsa(a.invoice.created_at)}},{data:"created_at",defaultContent:"...",title:"DATE PAID",name:"invoice.date_paid",searchable:!1,orderable:!1,visible:1,render:function(e,t,a){return o.Z.formatDateTime(a.created_at)}},{data:"payment_method",defaultContent:"...",title:"PAYMENT METHOD",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return 0==a.payment_method?'\n                                <span class="text-primary font-weight-bold">CHECK</span>\n                                <p># '.concat(a.check_number,"</p>\n                            "):1==a.payment_method?'\n                                <span class="text-primary font-weight-bold">CC:'.concat(a.card_type,"</span>\n                                <p>").concat(a.card_last_four,"</p>\n                            "):2==a.payment_method?'\n                                <span class="text-primary font-weight-bold">Balance</span>\n                            ':void 0}},{defaultContent:"...",title:"REVERSE PAYMENT",visible:1==e.userRole,searchable:!1,orderable:!1,render:function(e,t,a){return a.invoice.invoice_type==d.invoice_type_single_order?'\n                            <div class="text-center ">\n                                <button\n                                    class="refund-payment btn btn-sm pl-4 pr-4 btn-orange rounded-pill font-weight-bold"\n                                    data-payment-id="'.concat(a.id,'" data-payment-method="').concat(a.payment_method,'"\n                                    data-payment-amount="').concat(a.total,'"\n                                >REFUND</button>\n                            </div>\n                            '):'\n                                <div class="text-center ">\n                                    <button\n                                        class="reverse-payment btn btn-sm pl-4 pr-4 btn-orange rounded-pill font-weight-bold"\n                                        data-payment-id="'.concat(a.id,'" data-payment-method="').concat(a.payment_method,'"\n                                    >REVERSE</button>\n                                </div>\n                            ')}},{defaultContent:"...",title:"EXPORT",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return'\n                            <a href="'.concat(o.Z.getSiteUrl(),"/accounting/invoice-view/").concat(a.invoice.id,'" class="text-primary export-invoice-pdf">PDF</a>\n                        ')}}]}),setTimeout((function(){o.Z.hideLoader("")}),2e3);case 5:case"end":return t.stop()}}),t)})))()},reversePayment:function(){$("body").on("click",".reverse-payment",(function(e){var t=$(e.target),a=t.data("payment-id"),n=t.data("payment-method");a&&o.Z.confirm("Reverse Payment","Are you sure you wish to reverse this payment?",(function(){if(n==d.balance_payment){var e="".concat(o.Z.getSiteUrl(),"/accounting/payments/reverse/balance/").concat(a);o.Z.redirectTo(e)}if(n==d.check_payment){var t="".concat(o.Z.getSiteUrl(),"/accounting/payments/reverse/check/").concat(a);o.Z.redirectTo(t)}if(n==d.card_payment){var r="".concat(o.Z.getSiteUrl(),"/accounting/payments/reverse/balance/").concat(a);$("#refundToBalance").prop("href",r),r="".concat(o.Z.getSiteUrl(),"/accounting/payments/reverse/card/").concat(a),$("#refundToCard").prop("href",r),o.Z.openModal("reverseCardPaymentModal")}}),(function(){}))})),$("body").on("click",".refund-payment",(function(e){var t=$(e.target),a=t.data("payment-id"),n=t.data("payment-amount");$("#card_refund_amount").val(n),sessionStorage.removeItem("paymentAmount"),sessionStorage.setItem("paymentAmount",n);var r="".concat(o.Z.getSiteUrl(),"/accounting/payments/reverse/card/partial/").concat(a);$("#reversePaymentFormSingleOrder").prop("action",r),o.Z.openModal("reverseCardPaymentModalSingleOrder")})),$("body").on("change","#card_refund_amount",(function(e){var t=$(e.target),a=parseFloat(sessionStorage.getItem("paymentAmount"));(!t.val()||parseFloat(t.val())>a||parseFloat(t.val())<=0)&&t.val(a)})),$("#reversePaymentFormSingleOrder").on("submit",(function(e){$(e.target).find("#submitRefundPaymentBtn").prop("disabled",!0),o.Z.showLoader()}))},exportPDF:function(){$("body").on("click",".export-invoice-pdf",(function(){o.Z.showLoader(),setTimeout((function(){o.Z.hideLoader("")}),2e3)}))},removeAgentFromInvoice:function(){$("body").on("click",".remove-agent",(function(e){var t=$(e.target),a=t.data("agent-id"),n=t.data("invoice-id");o.Z.confirm("Remove Agent","Are you sure you wish to remove this agent?",(function(){o.Z.showLoader,o.Z.redirectTo("".concat(o.Z.getSiteUrl(),"/accounting/unpaid/invoice/remove/agent/").concat(a,"/").concat(n))}),(function(){}))}))},initializeDatePickers:function(){$("#from_date").datepicker({dateFormat:"m/d/yy"}),$("#to_date").datepicker({dateFormat:"m/d/yy"}),$("#from_date_excel").datepicker({dateFormat:"m/d/yy"}),$("#to_date_excel").datepicker({dateFormat:"m/d/yy"})},getAgent:function(e){return l(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.get(o.Z.getSiteUrl("/office/".concat(e,"/agents/order/by/name/json")));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},onOfficeChage:function(){var e=this,t=$('[name="export_to_csv_office"]');t.length&&t.on("change",function(){var t=l(r().mark((function t(a){var n,o,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.target.value,t.next=3,e.getAgent(n);case 3:o=t.sent,Array.isArray(o)||(o=Object.values(o)),(s=$('[name="export_to_csv_agent"]')).html(""),s.append(window.e("option",{value:"",htmlContent:"Select Agent"})),o.forEach((function(e){s.append(window.e("option",{value:e.id,htmlContent:e.user.lastNameFirstName}))}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},exportPayments:function(){var e=$("#exportToCsvModal"),t=$("#exportToExcelModal");$("body").on("click",".export-to-csv",(function(t){o.Z.showLoader(),setTimeout((function(){e.modal("hide"),e.on("hidden.bs.modal",(function(){$('[name="export_to_csv_agent"]').html(""),e.find("form").trigger("reset")})),o.Z.hideLoader("")}),2e3)})),$("body").on("click",".export-to-excel",(function(e){o.Z.showLoader(),setTimeout((function(){t.modal("hide"),t.on("hidden.bs.modal",(function(){$('[name="export_to_csv_agent"]').html(""),t.find("form").trigger("reset")})),o.Z.hideLoader("")}),2e3)}))},viewOrderDetails:function(e,t){if(!e||!t)return!1;"delivery"==t&&i.Z.viewDeliveryDetails(e,t),"install"==t&&i.Z.viewInstallDetails(e,t),"repair"==t&&i.Z.viewRepairDetails(e,t),"removal"==t&&i.Z.viewRemovalDetails(e,t)},getStatus:function(e,t){var a="";return e==d.status_received&&(a="Received"),e==d.status_incomplete&&(a="Action Needed"),e==d.status_cancelled&&(a="Cancelled"),e==d.status_scheduled&&(a="Scheduled"),e==d.status_completed&&("install"==t&&(a="Installed"),"repair"==t&&(a="Repaired"),"removal"==t&&(a="Removed"),"delivery"==t&&(a="Delivered")),a}};$((function(){d.init()}))},9708:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(1601),r={init:function(){n.Z.urlContains("/accounting")&&(n.Z.urlContains("analytics")&&($("[id=accountingAnalytics]").addClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active")),n.Z.urlContains("unpaid/invoices")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").addClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active")),n.Z.urlContains("payments")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").addClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active")),n.Z.urlContains("create/invoices")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").addClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active")),n.Z.urlContains("transaction/summary")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").addClass("order-tab-active")),n.Z.urlContains("/settings")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active"),$("[id=accountingSettings]").addClass("order-tab-active")),n.Z.urlContains("/manage-cards")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active"),$("[id=accountingSettings]").removeClass("order-tab-active"),$("[id=accountingManageCards]").addClass("order-tab-active")),n.Z.urlContains("/installer-points")&&($("[id=accountingAnalytics]").removeClass("order-tab-active"),$("[id=accountingUnpaidInvoices]").removeClass("order-tab-active"),$("[id=accountingPayments]").removeClass("order-tab-active"),$("[id=accountingCreateInvoices]").removeClass("order-tab-active"),$("[id=accountingTransactionSummary]").removeClass("order-tab-active"),$("[id=accountingSettings]").removeClass("order-tab-active"),$("[id=accountingManageCards]").removeClass("order-tab-active"),$("[id=accountingInstallerPoints]").addClass("order-tab-active")))}};$((function(){r.init()}));const o=r},5195:(e,t,a)=>{a.d(t,{Z:()=>n});const n={googleKey:a(1601).Z.urlContains("local")?"AIzaSyCNqhRTqZM2fILA4IL2F2uZEXKGAn6T_cw":"AIzaSyDvDROcLtqhfIpsWUdbU7sm5p98xjSrThw"}},1601:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(7757),r=a.n(n);a(6486);function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function i(e,t,a,n,r,o,s){try{var i=e[o](s),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,r)}function c(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function s(e){i(o,n,r,s,c,"next",e)}function c(e){i(o,n,r,s,c,"throw",e)}s(void 0)}))}}var l={getSiteUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return window.location.origin+e},validateEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},validateDomain:function(e){return/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/.test(String(e).toLowerCase())},alertError:function(e){$("#errorModalContent").html(e),$("#errorModal").modal("show"),$(".modal").css({"overflow-y":"scroll"})},alertMsg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=$("#messageModal");a.find("#messageModelTitle").html(e),a.find("#messageModelContent").html(t),a.modal("show"),$(".modal").css({"overflow-y":"scroll"})},confirm:function(e,t,a,n){$(".modal").css({"overflow-y":"scroll"}),e?$("#confirmModalHeader").html(e):$("#confirmModalHeader").html("Are you sure?"),t?$("#confirmModalContent").html(t):$("#confirmModalContent").html("This action is irreversible!"),$("#confirmModal").modal("show"),$("#confirmBtnOk").off("click"),$("#confirmBtnOk").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal").modal("hide"),a()})),$("#confirmBtnCancel").off("click"),$("#confirmBtnCancel").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal").modal("hide"),n()}))},confirm2:function(e,t,a,n){$(".modal").css({"overflow-y":"scroll"}),e?$("#confirmModalHeader2").html(e):$("#confirmModalHeader2").html("Are you sure?"),t?$("#confirmModalContent2").html(t):$("#confirmModalContent2").html("This action is irreversible!"),$("#confirmModal2").modal("show"),$("#confirmBtnOk2").off("click"),$("#confirmBtnOk2").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal2").modal("hide"),a()})),$("#confirmBtnCancel2").off("click"),$("#confirmBtnCancel2").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal2").modal("hide"),n()}))},roundToHalf:function(e){return Math.round(2*e)/2},reloadPage:function(){window.location.reload()},serverErrorMessage:function(){return"An error occured, please try again or contact support if the problem persists."},inchesToFeet:function(e){return e/12},feetToInches:function(e){return 12*e},getDecimal:function(e){return e%1},isMobilePhone:function(){return window.matchMedia("only screen and (max-width: 800px)").matches},isTablet:function(){return window.matchMedia("only screen and (min-device-width: 768px) and (max-device-width: 1366px) and (-webkit-min-device-pixel-ratio: 1)").matches},redirectTo:function(e){window.location.href=e},urlContains:function(e){return-1!=window.location.href.indexOf(e)},stringContains:function(e,t){return-1!=e.indexOf(t)},validateForm:function(e){return c(r().mark((function t(){var a,n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e instanceof HTMLElement)){t.next=17;break}if("form"!==e.localName){t.next=13;break}return a=e.querySelectorAll("input"),n=[],t.next=6,a.forEach((function(t){if(!("validation-except"in t.attributes)&&!["file"].includes(t.type)&&("required"in t.attributes&&!t.value.trim()&&n.push({node:t,type:"required"}),"validation-match"in t.attributes)){var a=t.attributes["validation-match"].value,r=(a=e[a]).value,o=t.value;r.trim()!=o.trim()&&(n.push({node:t,type:"match"}),n.push({node:a,type:"match"}))}}));case 6:return t.sent,document.querySelectorAll(".invalid-feedback").forEach((function(e){return e.remove()})),n.forEach((function(e){var t,a,n=e.node.attributes[e.type+"-error-msg"],r=null!==(t=null===(a=e.node.attributes["error-class"])||void 0===a?void 0:a.value)&&void 0!==t?t:"";if(e.node.classList.add("is-invalid"),n){var o='<div class="invalid-feedback '.concat(r,'">').concat(n.value,"</div>");e.node.insertAdjacentHTML("afterend",o)}})),n.length||(e.querySelectorAll("input").forEach((function(e){"validation-except"in e.attributes||(e.classList.remove("is-invalid"),e.classList.add("is-valid"))})),document.querySelectorAll(".invalid-feedback").forEach((function(e){return e.remove()}))),t.abrupt("return",{ok:!n.length,errors:n});case 13:return console.error("validateForm() acept  HTML element type of <form>. * YOU GIVE US  <".concat(e.localName,">").toUpperCase()),t.abrupt("return",!1);case 15:t.next=19;break;case 17:return console.error("validateForm() acept  HTML element.".toUpperCase()),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t)})))()},loadImageOn:function(e,t){(e=$(e)).length&&e.on("change",(function(e){if((t=$(t)).length){var a=e.target.files[0];t.prop("src",URL.createObjectURL(a))}}))},parseDate:function(e){var t=e.slice(0,10),a=(t=t.replace(/\//g,"-")).split("-");return new Date(a[0],a[1]-1,a[2])},parseUSDate:function(e){var t=e.slice(0,10),a=(t=t.replace(/\//g,"-")).split("-");return new Date(a[2],a[0]-1,a[1])},formatDate:function(e){var t=this.parseDate(e);return new Intl.DateTimeFormat("en",{month:"numeric",day:"numeric",year:"numeric"}).format(t)},formatDateCustom:function(e,t){var a=this.parseDate(e);return new Intl.DateTimeFormat("en",t).format(a)},formatDateTime:function(e){var t=new Date(e.replace(/\s/,"T")),a=t.getHours(),n=t.getMinutes(),r=a>=12?"PM":"AM",o=(a=(a%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+r;return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+"  "+o},formatDateUsa:function(e){var t=this.parseDate(e);return new Intl.DateTimeFormat("en-US").format(t)},formatDateUsaDateString:function(e){var t=this.parseUSDate(e);return new Intl.DateTimeFormat("en-US").format(t)},diffDays:function(e,t){var a=new Date(e),n=new Date(t).getTime()-a.getTime();return parseInt(n/864e5)},isNextDay:function(e,t){return 1==this.diffDays(e,t)},isCutoffTime:function(){var e=new Date;return e.getHours()>=20&&e.getMinutes()>0},getDateStringUsa:function(e){var t=e.getFullYear(),a="".concat(e.getMonth()+1),n="".concat(e.getDate());return 1==n.length&&(n="0"+n),1==a.length&&(a="0"+a),a+"/"+n+"/"+t},getDateString:function(e){var t=e.getFullYear(),a="".concat(e.getMonth()+1),n="".concat(e.getDate());return 1==n.length&&(n="0"+n),1==a.length&&(a="0"+a),"".concat(t,"-").concat(a,"-").concat(n)},getDateTimeString:function(e){var t=e.getFullYear(),a="".concat(e.getMonth()+1),n="".concat(e.getDate());1==n.length&&(n="0"+n),1==a.length&&(a="0"+a);var r=e.getHours(),o=e.getMinutes(),s=(r=(r%=12)||12)+":"+(o=o<10?"0"+o:o);return"".concat(t,"-").concat(a,"-").concat(n,"T").concat(s)},isLastDayOfMonth:function(e){return 1===new Date(e.getTime()+864e5).getDate()},tzOffset:function(){return(new Date).getTimezoneOffset()},previousDay:function(e){return e.setDate(e.getDate()-1),e},isWeekend:function(e){return 6===e.getDay()||0===e.getDay()},create_id:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},parseZonePoints:function(e){return(e=JSON.parse(e)).map((function(e){return{lat:parseFloat(e.lat),lng:parseFloat(e.lng)}}))},orderOptions:function(e){var t=$(e),a=t.map((function(e,t){return{t:$(t).text(),v:t.value}})).get();a.sort((function(e,t){return e.t<t.t?1:e.t>t.t?-1:0})),t.each((function(e,t){t.value=a[e].v,$(t).text(a[e].t)}))},cardNumberInput:function(e){if(e){var t,a,n=document.querySelector(e),r=/^\d{0,16}$/g,o=function(e){return e.replace(/[^\d]/g,"")},s=function(e,t){return Math.floor(e/(t+1))},i=function(e){var t={amex:/^3/,visa:/^4/,mastercard:/^5/,disc:/^6/,genric:/(^1|^2|^7|^8|^9|^0)/};for(var a in t)if(t[a].test(e)){a;break}};n.addEventListener("keydown",(function(e){var n=e.target;t=n.value,a=n.selectionEnd})),n.addEventListener("input",(function(e){var n,c=e.target,l=o(c.value);l.match(r)?(l=function(e,t,a){for(var n=[],r=0;r<e.length;r++)0!==r&&r%t==0&&n.push(a),n.push(e[r]);return n.join("")}(l,4," "),n=a-s(a,4)+s(a+(l.length-t.length),4)+(o(l).length-o(t).length),c.value=""!==l?l:""):(c.value=t,n=a),c.setSelectionRange(n,n),i(c.value)}))}},removeFromArray:function(e,t){return e.splice(e.indexOf(t),1)},getZoneSettings:function(){return c(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(l.getSiteUrl("/get/zone/settings"));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))()},genId:function(){return"id"+Math.floor(99999999999999.66*Math.random()).toString(36).substring(1)},showLoader:function(){$("#loader_image").modal("show")},hideLoader:function(e){setTimeout((function(){$("#loader_image").modal("hide"),e&&($(".modal").css({"overflow-y":"scroll"}),$("#".concat(e)).modal())}),500)},openModal:function(e){$("#".concat(e)).modal()},closeModal:function(e){$("#".concat(e)).modal("hide"),$(".modal").css({"overflow-y":"scroll"})},inputNumber:function(e){var t=o(Array(100).keys());$("".concat(e)).on("keyup",(function(e){var a=$(e.target);a.val()&&(t.includes(parseInt(a.val()))?a.val(parseInt(a.val())):a.val(1))}))},getCurrentUserRole:function(){return c(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get("".concat(l.getSiteUrl(),"/current/user/role"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},getInitialsFromName:function(e){var t=e.split(" ");return(t.shift().charAt(0)+t.pop().charAt(0)).toUpperCase()},initialUppercase:function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},initialUppercaseWord:function(e){if("string"!=typeof e)return"";for(var t=e.split(" "),a=0;a<t.length;a++)""!=t[a]&&void 0!==t[a]&&(t[a]=t[a][0].toUpperCase()+t[a].substr(1).toLowerCase());return t.join(" ")},loadImagePreview:function(e,t){if(e.target.files.length>0){var a=URL.createObjectURL(e.target.files[0]);document.getElementById(t).src=a}},isSuperAdmin:function(){return 1==$("#userRole").val()},log:function(e){return console.log(e),!1},decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},removeEmptyObjectFromArray:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return 0!==Object.keys(e).length}));return t},roundToDecimal:function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}};const d=l},3358:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(7757),r=a.n(n),o=a(5195),s=a(1601),i=a(7087),c=a.n(i),l=a(9350),d=a(6486);function p(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==a.return||a.return()}finally{if(i)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function u(e,t,a,n,r,o,s){try{var i=e[o](s),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,r)}function g(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function s(e){u(o,n,r,s,i,"next",e)}function i(e){u(o,n,r,s,i,"throw",e)}s(void 0)}))}}var f={zones:[]},v=c().create(f,!0,(function(e){if(f.zones.length==_.zones_count){var t=f.zones.filter((function(e){return null!=e}));if(t.length){var a=null;t.forEach((function(e){(null==a||a.zone_fee>e.zone_fee)&&(a=e)})),_.addresIsOut=!1,$.get(s.Z.getSiteUrl("/get/zone/settings")).done((function(e){_._currentZone=a,_.movedNextMonth=!1,_.updateCalendar(_.savedServiceDate,!1);var t=parseFloat(a.zone_fee||0)*(e.install/100);_.ignoreZoneFee?($("[install-post-zone-fee]").html("$0"),$('[name="install_post_zone_fee"]').val(0),$('[name="install_post_zone_fee"]').trigger("change")):($("[install-post-zone-fee]").html("$".concat(t.toFixed(2))),$('[name="install_post_zone_fee"]').val(t),$('[name="install_post_zone_fee"]').get(0).dispatchEvent(new Event("change"))),_.zoneId=a.id}))}else s.Z.alertMsg("Address Out of Service Area","This address appears to be outside the service area. Please verify that the address and pin location are correct."),_._currentZone=null,_.disableAllDates(),_.addresIsOut=!0,$("[install-post-zone-fee]").html("00.00"),$('[name="install_post_zone_fee"]').val("00.00"),$('[name="install_post_zone_fee"]').get(0).dispatchEvent(new Event("change")),$("[googlescript]").remove(),s.Z.hideLoader("")}})),_={createpost:!0,order_id:null,payment_method_office_pay:3,payment_method_at_time_of_order:1,zoneId:null,ignoreZoneFee:!1,total:0,agentChangeCount:0,savedServiceDate:"",init:function(){var e=this;l.Z.init(),$(".open_install_post_modal").on("click",(function(e){$("#import-order-div").show();var t=$("#install_post_modal");_.resetInstallModalForm(),$("#submitOrder").html('<strong class="text-white">SUBMIT INSTALL</strong>'),t.modal(),_.createpost=!0})),-1==window.location.href.indexOf("routes")&&this.initMap(),this.searchAddress(),this.onLocationAdjustmentChange(),this.onPostOfficeChange(),window.onInstallPostSelectPostChange=this.onInstallPostSelectPostChange,window.onInstallPostSelectSignChange=this.onInstallPostSelectSignChange,window.onInstallPostSelectAccessoriesChange=this.onInstallPostSelectAccessoriesChange,window.accessoryClicked=this.accessoryClicked,this.onInstallPostCommentChange(),this.onFileUplaoded(),window.removeFile=this.removeFile,this.totalFee(),this.onDesiredDateChange(),this.onAgentChange(),this.installPostPropertyType(),window.uploadAccessoryFile=this.uploadAccessoryFile,this.onSubmitForm(),this.handleDuplicatedOrder(),this.pricingAdjustment(),this.onCityChange(),$.get(s.Z.getSiteUrl("/get/holidays")).done((function(e){_.holidays=e})),$('[name="document_files[]"').on("change",(function(e){var t=new FormData;Object.values(e.target.files).forEach((function(e,a){t.append("file"+a,e)})),$.ajax({url:s.Z.getSiteUrl("/store/douctment/accessory/".concat(e.target.getAttribute("accessory_id"))),data:t,type:"POST",contentType:!1,processData:!1,cache:!1}).done((function(e){$("#documentModal").find("form").trigger("reset"),$("#documentModal").modal("hide")})).fail((function(e){var t=e.responseJSON,a="<ul>";for(var n in t.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[n]+"</li>";a+="</ul>",s.Z.alertError(a)}))}));var t=$('[name="install_post_panel_type"]');t.length&&t.on("change",(function(e){_.panel_type=e.target.value,$("#sign_image_preview").addClass("d-none").removeClass("d-block"),$('[name="install_post_panel"]').prop("checked",!1),_.panel=""})),$(".cc-number-input").length&&s.Z.cardNumberInput(".cc-number-input"),$("#uploadOtherDoc").on("click",(function(e){_.upload_accessory_file=null})),$("[rush-fee-decline-button]").on("click",(function(t){$(".modal").css({"overflow-y":"scroll"}),e.setRushFee(0),$('[name="install_post_desired_date"][value="custom_date"]').trigger("click")})),$("[rush-fee-accept-button]").on("click",(function(t){$(".modal").css({"overflow-y":"scroll"});var a=$("[rush-order-fee]").attr("rush-order-fee");e.setRushFee(a)}))},setRushFee:function(e){var t=$('input[name="install_post_rush_fee"]');t.val(e),t[0].dispatchEvent(new Event("change")),$("#rushFee").removeClass("d-none")},resetInstallModalForm:function(){var e=$("#install_post_modal");$("#install-post-search-map").html(" "),$("#files_list").html(" "),$("#warning-alerts").html(" "),this.startMap(),$(".list-container-posts,.list-container-signs,.list-container-accessories-install").html(""),$(".order-preview-imgs,.accessory_image_preview").addClass("d-none").removeClass("d-block"),$("[install-post-zone-fee]").html("$0.00"),$("[install-post-signage]").html("$0.00"),$("[install-post-total]").html("$0.00"),$('[name="install_post_signage"]').val(0),$('[name="install_post_zone_fee"]').val(0),$('[name="install_post_comment"]').val(""),$('[name="install_post_comment"]').text(""),this.disableAllDates(),e.find("form").trigger("reset"),_.prices_obj={post:0,panels:0,accessories:0},$("[install-post-adjustments]").html("$0.00"),_.totalAdjusted=0,_.rowCount=0,_.getSignageFee(),_.ignoreZoneFee=!1,_.accessories=[],_.post="",_.panel="",_.panel_type="",_.savedServiceDate="",_.pricingAdjustments={description:[],charge:[],discount:[]}},resetInstallFormKeepOfficeAgent:function(){$("#install_post_modal").find(":input, select").each((function(e,t){"install_post_agent"!=t.name&&"install_post_office"!=t.name&&"install_post_desired_date"!=t.name&&"install_post_panel_type"!=t.name&&"install_post_state"!=t.name&&(t.value="")})),$('[name="install_post_signage"]').val(0),$('[name="install_post_zone_fee"]').val(0),$('[name="install_post_rush_fee"]').val(0),$("#install-post-search-map").html(" "),$("#files_list").html(" "),$("#warning-alerts").html(" "),this.startMap(),$(".list-container-posts,.list-container-signs,.list-container-accessories-install").html(""),$(".order-preview-imgs,.accessory_image_preview").addClass("d-none").removeClass("d-block"),$('[name="install_post_comment"]').val(""),$('[name="install_post_comment"]').text(""),this.disableAllDates(),_.prices_obj={post:0,panels:0,accessories:0},$("[install-post-adjustments]").html("$0.00"),_.totalAdjusted=0,_.rowCount=0,_.getSignageFee(),_.ignoreZoneFee=!1,_.accessories=[],_.post="",_.panel="",_.panel_type="",_.pricingAdjustments={description:[],charge:[],discount:[]}},installPostPropertyType:function(){$('[name="install_post_property_type"]').on("change",(function(e){2==e.target.value||3==e.target.value?$(".install-document-required-warning").addClass("d-block").removeClass("d-none"):$(".install-document-required-warning").addClass("d-none").removeClass("d-block")}))},alertMsgDocument:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,n=$("#documentModal");n.find("#messageModelTitle").html(e),n.find("#messageModelContent").html(t),n.find('[name="document_files[]"]').attr("accessory_id",a),n.modal("show"),$(".modal").css({"overflow-y":"scroll"})},dates:[],onSubmitForm:function(){var e=this;$("#install_post_modal").on("submit",function(){var t=g(r().mark((function t(a){var n,o,i,c,d,p,m,u,g;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.stopImmediatePropagation(),n=$(a.target),a.preventDefault(),!_.addresIsOut){t.next=6;break}return s.Z.alertMsg("Address Out of Service Area","This address appears to be outside the service area. Please verify that the address and pin location are correct."),t.abrupt("return");case 6:if(o=_._files.filter((function(e){return"plat-map"==e._accessory_id||1==e.plat_map})).length,i=$('[name="install_post_property_type"]').val(),c=$('[name="install_post_property_type"] option:selected').text(),0!=o||2!=i&&3!=i){t.next=12;break}return s.Z.alertError("".concat(c," requires a platmap or image of property be attached before order can be completed.")),t.abrupt("return",!1);case 12:s.Z.showLoader(),d=new FormData,p=$("#install_post_modal").find("#address").val(),m=$("#install_post_modal").find("#city").val(),u=$("#install_post_modal").find("#state").val(),g="".concat(p.replace(/[,]/g,"").trim(),", ").concat(m.replace(/[,]/g,"").trim(),", ").concat(u.replace(/[,]/g,"").trim()),d.append("install_post_address",g),d.append("install_post_property_type",n.find('[name="install_post_property_type"]').val()),d.append("install_post_desired_date",n.find('[name="install_post_desired_date"]:checked').val()),d.append("install_post_custom_desired_date",n.find('[name="install_post_custom_desired_date"]').val()),d.append("install_post_office",n.find('[name="install_post_office"]').val()),d.append("install_post_agent",n.find('[name="install_post_agent"]').val()),d.append("install_post_select_post",e.post),d.append("install_post_select_sign",e.panel),d.append("install_post_select_sign_type",e.panel_type),d.append("install_post_select_accessories",JSON.stringify(e.accessories)),d.append("install_post_comment",n.find('[name="install_post_comment"]').val()),d.append("is_create",_.createpost),d.append("ignore_zone_fee",_.ignoreZoneFee),d.append("order_id",_.order_id),e._files.forEach((function(e,t){return d.append("file".concat(t,"_").concat(e._accessory_id),e)})),d.append("install_post_rush_fee",n.find('[name="install_post_rush_fee"]').val()),d.append("install_post_signage",n.find('[name="install_post_signage"]').val()),d.append("install_post_zone_fee",n.find('[name="install_post_zone_fee"]').val()),d.append("install_marker_position",JSON.stringify(_.marker_position)),n.find('[type="submit"]').prop("disabled",!0),n.find('[type="submit"]').html('<strong class="text-white">SENDING...</strong>'),d.append("zone_id",_.zoneId),d.append("pricingAdjustments",JSON.stringify(_.pricingAdjustments)),d.append("total",_.total),d.append("imported_order",$("#imported_order").prop("checked")?1:0),$.ajax({url:s.Z.getSiteUrl("/install/post"),data:d,type:"POST",contentType:!1,processData:!1,cache:!1}).done((function(e){if(e.type&&"error"==e.type)return s.Z.alertError(e.message),n.find('[type="submit"]').prop("disabled",!1),n.find('[type="submit"]').html('<strong class="text-white">TRY AGAIN</strong>'),s.Z.hideLoader(""),!1;if(e.order.editOrder&&!e.order.needPayment&&window.location.reload(),e.order.needPayment){var t=$("#payment_modal");$("[payment-total-amount]").html(parseFloat(e.order.total).toFixed(2)),$("[billing-name]").val(e.billing.name),$("[billing-address]").val(e.billing.address),$("[billing-city]").val(e.billing.city),$("[billing-state]").val(e.billing.state),$("[billing-zip]").val(e.billing.zipcode),$("#use_another_card").prop("checked",!0),$(".form-another-card input").prop("disabled",!1),$("#card_profile_select").prop("disabled",!0),e.order.office.user.authorizenet_profile_id?($("#use_card_profile").prop("checked",!0),$("#card_profile_select").prop("disabled",!1),$(".form-another-card input").prop("disabled",!0),$("#use_another_card").prop("checked",!1),e.order.agent?l.Z.loadOfficeCardsVisibleToAgent($("#card_profile_select"),e.order.office.user.id,e.order.office.payment_method,e.order.agent.payment_method):l.Z.loadCards($("#card_profile_select"),e.order.office.user.id)):($(".form-another-card input").prop("disabled",!1),$("#use_another_card").prop("checked",!0),$("#use_card_profile").prop("checked",!1),$("#card_profile_select").prop("disabled",!0)),e.order.agent&&e.order.agent.user.authorizenet_profile_id&&($("#use_card_profile").prop("checked",!0),$("#card_profile_select").prop("disabled",!1),$(".form-another-card input").prop("disabled",!0),$("#use_another_card").prop("checked",!1),l.Z.loadCards($("#card_profile_select"),e.order.agent.user.id)),s.Z.hideLoader("payment_modal"),t.find('[name="order_id"]').val(e.order.id);var a=$("#install_post_modal");a.length&&a.modal("hide")}else window.location.reload()})).fail((function(e){var t=e.responseJSON,a="<ul>";for(var r in t.errors)$('[name^="'.concat(r,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+t.errors[r]+"</li>";a+="</ul>",s.Z.alertError(a),n.find('[type="submit"]').prop("disabled",!1),n.find('[type="submit"]').html('<strong class="text-white">TRY AGAIN</strong>'),s.Z.hideLoader("")}));case 44:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getSelectValues:function(e){for(var t,a=[],n=e&&e.options,r=0,o=n.length;r<o;r++)(t=n[r]).selected&&a.push(t.value||t.text);return a},onDesiredDateChange:function(){var e=document.getAll('[name="install_post_desired_date"]'),t=$("#selectdate_custom_date");e.forEach((function(e){e.onchange=function(e){var a=e.target.value;$('[name="install_post_desired_date"]').removeAttr("checked"),$(e.target).attr("checked","true"),"custom_date"===a?(_.setRushFee(0),t.removeClass("d-none"),$("#rushFee").addClass("d-none")):($("#rushOrderModal").modal(),t.addClass("d-none"))}}))},disableAllDates:function(){$("#selectdate_custom_date").datepicker("destroy"),$("#selectdate_custom_date").datepicker({beforeShowDay:function(e){return[!1]}})},movedNextMonth:!1,updateCalendar:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if($("#selectdate_custom_date").datepicker("destroy"),$("#selectdate_custom_date").datepicker({onSelect:function(e){return $('[name="install_post_custom_desired_date"]').val(e),_.updateCalendar(s.Z.parseUSDate(e),!0)},beforeShowDay:function(t){var a=s.Z.getDateStringUsa(t),n=s.Z.getDateStringUsa(new Date),r=s.Z.diffDays(a,n),o=a;if(n==a)return[!0];if(_.holidays.includes(a))return[!1];var i="";if(e&&(i=s.Z.getDateStringUsa(e)),r>=1)return i==o?[!0,"ui-state-highlight ui-state-active",""]:[!1];if(_._currentZone){for(var c=_._currentZone,l=[c.su,c.m,c.tu,c.w,c.th,c.f,c.sa],d=0;d<l.length;d++){var p=l[d];if(t.getDay()===d)return[p]}return[!0]}return[!0]}}),e)if(_.createpost){var a=s.Z.getDateStringUsa(e);$("#selectdate_custom_date").datepicker("setDate",a)}else if(t){var n=s.Z.getDateStringUsa(e);$("#selectdate_custom_date").datepicker("setDate",n)}else setTimeout((function(){var t=s.Z.getDateStringUsa(e);$("#selectdate_custom_date").datepicker("setDate",t)}),2e3);else{var r=new Date;s.Z.isLastDayOfMonth(r)&&!_.movedNextMonth&&_.createpost&&(_.movedNextMonth=!0,setTimeout((function(){$("#selectdate_custom_date .ui-datepicker-next").trigger("click")}),3e3)),$("#selectdate_custom_date").find("a.ui-state-active").removeClass("ui-state-active").removeClass("ui-state-highlight").removeClass("ui-state-hover")}},_files:[],onFileUplaoded:function(){var e=this,t=$('input[name="install_post_files[]"]');t.length&&t.on("change",(function(t){var a,n=t.target.files,r=_.upload_accessory_file,o=p(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;s._id=e.genId(),s._accessory_id=r,_._files.push(s),_.displayFiles(e._files),_.setFiles(e._files),"plat-map"!=r?$("[install_accessory_name_id_".concat(r,"]")).addClass("d-none").removeClass("d-block"):$(".install-document-required-warning").addClass("d-none").removeClass("d-block")}}catch(e){o.e(e)}finally{o.f()}}))},setFiles:function(e){var t=$('input[name="install_post_files[]"]');t.length&&(t.files=e)},displayFiles:function(e){var t=$("#files_list");t.length&&(t.html(""),e.forEach((function(e){t.append('\n                <li>\n                    <span>\n                        <a href="#"><strong>'.concat(e.name,"</strong></a>\n                        UPLOADED ").concat(s.Z.formatDateTime((new Date).toISOString()),"\n                        <a class='text-danger c-p' onclick=\"window.removeFile('").concat(e._id,"')\">\n                        <strong>REMOVE</strong></a>\n                    </span>\n                </li>"))})))},removeFile:function(e){return g(r().mark((function t(){var a,n,o,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_._files.filter((function(t){return t._id==e}));case 2:return a=t.sent,t.next=5,_._files.filter((function(t){return t._id!=e}));case 5:n=t.sent,_._files=n,_.setFiles(_._files),_.displayFiles(_._files),o=_._files.filter((function(e){return"plat-map"==e._accessory_id})).length,s=$('[name="install_post_property_type"]').val(),0!=o||2!=s&&3!=s||$(".install-document-required-warning").addClass("d-block").removeClass("d-none"),0==_._files.filter((function(e){return"plat-map"!=e._accessory_id})).length&&($(".accessories-install-document-required-warning").addClass("d-block").removeClass("d-none"),$("[install_accessory_name_id_".concat(a[0]._accessory_id,"]")).addClass("d-block").removeClass("d-none")),_._files.length||(2!=s&&3!=s||$(".install-document-required-warning").addClass("d-block").removeClass("d-none"),$(".accessories-install-document-required-warning").addClass("d-block").removeClass("d-none"),$('input[name="install_post_files[]"]').val(""));case 15:case"end":return t.stop()}}),t)})))()},genId:function(){return"id"+Math.floor(99999999999999.66*Math.random()).toString(36).substring(1)},onInstallPostCommentChange:function(){var e=$('[name="install_post_comment"]');e.length&&e.on("keyup",(function(t){var a=(e.val()||"").trim().length;$(".char-used").html(a),a>500?e.addClass("is-invalid"):e.removeClass("is-invalid")}))},prices_obj:{post:0,panels:0,accessories:0},post:"",panel:"",panel_type:null,accessories:[],onInstallPostSelectPostChange:function(e){var t=$(e.target),a=t.data("image");_.prices_obj.post=parseFloat(t.data("price")),_.post=t.val();var n=$(".install-post-preview-images").find("#post_image_preview");n.removeClass("d-none").addClass("d-block"),n.get(0).src=a,_.getSignageFee()},onInstallPostSelectSignChange:function(e){$('[name="install_post_panel_type"]').prop("checked",!1),_.prices_obj.panels=parseFloat(e.target.dataset.price);var t=e.target.dataset.image;_.panel=e.target.value;var a=$(".install-post-preview-images").find("#sign_image_preview");a.removeClass("d-none").addClass("d-block"),a.get(0).src=t,_.getSignageFee(),_.panel_type=""},selected_arr:[],upload_accessory_file:null,uploadAccessoryFile:function(e){_.upload_accessory_file=e},onInstallPostSelectAccessoriesChange:function(e){_.selected_arr.includes(e.target.value)?(_.selected_arr=_.selected_arr.filter((function(t){return t!=e.target.value})),_.accessories=_.selected_arr,_.prices_obj.accessories-=parseFloat(e.target.dataset.price)):(e.target.setAttribute("checked",!0),_.prices_obj.accessories+=parseFloat(e.target.dataset.price),_.selected_arr.push(e.target.value),_.accessories=_.selected_arr),_.prices_obj.accessories<0&&(_.prices_obj.accessories=0),_.getSignageFee();var t=$(".install-post-preview-images");if(t.length){if(!_.selected_arr.length)return void t.find(".accessory_image_preview").remove();t.find(".accessory_image_preview").remove(),_.selected_arr.forEach((function(e){var a=$("".concat('[name="install_post_accessories[]"]','[value="').concat(e,'"]')),n=a.data("image")||s.Z.getSiteUrl("/private/image/accessory/0");a.length&&t.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(n,'">'))}))}var a=$(e.target);a.is(":checked")&&$.get(s.Z.getSiteUrl("/get/accessory/".concat(a.val(),"/json"))).done((function(e){if(_.createpost&&e.message&&s.Z.alertMsg(e.popup_message_heading,e.popup_message_message),e.prompt){if($("[install_accessory_name_id_".concat(e.id,"]")).length)return;$("#warning-alerts").append("\n                    <div accessory_warning install_accessory_name_id_".concat(e.id,' class="alert alert-warning alert-dismissible fade show accessories-install-document-required-warning" role="alert">\n                        <strong>\n                            <label for="install_post_files" class="text-primary c-p m-0 underline" onclick="window.uploadAccessoryFile(').concat(e.id,')">\n                                UPLOAD FILES\n                            </label>\n                            <i class="fas fa-exclamation-triangle ml-3"></i> Notice!\n                        </strong> Upload required for\n                        <strong>').concat(e.accessory_name,"</strong>\n                    </div>\n                    "))}}))},accessoryClicked:function(e){var t=$(e.target);t.is(":checked")||$("[install_accessory_name_id_".concat(t.val(),"]")).remove()},onPostOfficeChange:function(){var e=this;$(".order-preview-imgs").hide();var t=$('[name="install_post_office"]');t.length&&t.on("change",function(){var t=g(r().mark((function t(a){var n,o,i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.target.value,_.resetFeesOnOfficeAgentChange(),$(".list-container-posts").empty(),$(".list-container-signs").empty(),$(".list-container-accessories-install").empty(),_.hidePreviewsImages(),n.trim()?($(".options-posts,.options-signs,.options-accessories").removeClass("d-none"),$(".order-preview-imgs").show()):($(".options-posts,.options-signs,.options-accessories").addClass("d-none"),$(".order-preview-imgs").hide()),n){t.next=11;break}return $('[name="install_post_agent"]').html(" "),t.abrupt("return");case 11:return t.next=13,e.getAgent(n);case 13:o=t.sent,Array.isArray(o)||(o=Object.values(o)),(i=$('[name="install_post_agent"]')).html(""),i.append(window.e("option",{value:"",htmlContent:"Select Agent"})),o.forEach((function(e){i.append(window.e("option",{value:e.id,htmlContent:e.user.lastNameFirstName}))})),$('[name="install_post_panel_type"]').prop("checked",!1),$.get(s.Z.getSiteUrl("/get/office/".concat(n,"/posts"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-posts");t.empty();var a="";e.forEach((function(e){a+='\n                            <div class="form-check d-flex justify-content-between" post-office-access="">\n                                <input\n                                    type="radio"\n                                    name="install_post_post"\n                                    value="'.concat(e.id,'"\n                                    data-price="').concat(e.price,'"\n                                    data-image="').concat(s.Z.getSiteUrl("/private/image/post/".concat(e.image_path)),'"\n                                    class="form-check-input"\n                                    id="install_post_option_').concat(e.id,'"\n                                    onchange="window.onInstallPostSelectPostChange(event)"\n                                    >\n                                <label class="form-check-label text-dark" for="install_post_option_').concat(e.id,'">').concat(e.post_name,'</label>\n                                <span price="">$').concat(e.price,"</span>\n                            </div>\n                        ")})),t.html(a)})),$.get(s.Z.getSiteUrl("/get/office/".concat(n,"/panels"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-signs");t.empty();e.forEach((function(e){t.append('\n                            <div class="form-check d-flex justify-content-between">\n                                <input type="radio" onchange="window.onInstallPostSelectSignChange(event)" name="install_post_panel" value="'.concat(e.id,'" data-price="').concat(e.price,'" data-image="').concat(s.Z.getSiteUrl("/private/image/panel/".concat(e.image_path)),'" class="form-check-input" id="install_panel_option_').concat(e.id,'">\n                                <label class="form-check-label text-dark" for="install_panel_option_').concat(e.id,'">').concat(e.panel_name,'</label>\n                                <span price="">$').concat(e.price,"</span>\n                            </div>\n                            "))}))})),$.get(s.Z.getSiteUrl("/get/office/".concat(n,"/accessories"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-accessories-install");t.empty();e.forEach((function(e){t.append('\n                            <div class="form-check d-flex justify-content-between">\n                            <input type="checkbox" name="install_post_accessories[]" value="'.concat(e.id,'"\n                                data-price="').concat(e.price,'"\n                                data-image="').concat(s.Z.getSiteUrl("/private/image/panel/"+e.image),'" class="form-check-input"\n                                onchange="window.onInstallPostSelectAccessoriesChange(event)"\n                                onclick="window.accessoryClicked(event)"\n                                id="install_accessory_option_').concat(e.id,'">\n                            <label class="form-check-label text-dark"\n                                for="install_accessory_option_').concat(e.id,'">').concat(e.accessory_name,"</label>\n                            <span price>$").concat(e.price,"</span>\n                        </div>\n                       "))})),$("#warning-alerts").html(" ")}));case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},hidePreviewsImages:function(){$("#post_image_preview,#sign_image_preview").hide().attr("src",""),$(".accessory_image_preview").remove(),_.selected_arr=[]},onAgentChange:function(){$('[name="install_post_agent"]').on("change",(function(e){var t=$(e.target);_.createpost&&_.agentChangeCount++,_.agentChangeCount>0&&_.resetInstallFormKeepOfficeAgent(),_.resetFeesOnOfficeAgentChange(),$('[name="install_post_panel_type"]').prop("checked",!1),_.hidePreviewsImages(),$(".list-container-posts").empty(),$(".list-container-signs").empty(),$(".list-container-accessories-install").empty(),t.val()||$('[name="install_post_office"]').trigger("change"),$.get(s.Z.getSiteUrl("/get/agent/".concat(t.val(),"/posts"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-posts");t.empty();var a="";e.forEach((function(e){a+='\n                        <div class="form-check d-flex justify-content-between" post-office-access="">\n                            <input\n                                type="radio"\n                                name="install_post_post"\n                                value="'.concat(e.id,'"\n                                data-price="').concat(e.price,'"\n                                data-image="').concat(s.Z.getSiteUrl("/private/image/post/".concat(e.image_path)),'"\n                                class="form-check-input"\n                                id="install_post_option_').concat(e.id,'"\n                                onchange="window.onInstallPostSelectPostChange(event)"\n                                >\n                            <label class="form-check-label text-dark" for="install_post_option_').concat(e.id,'">').concat(e.post_name,'</label>\n                            <span price="">$').concat(e.price,"</span>\n                        </div>\n                    ")})),t.html(a)})),$.get(s.Z.getSiteUrl("/get/agent/".concat(t.val(),"/panels"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-signs");t.empty();var a="";e.forEach((function(e){a+='\n                    <div class="form-check d-flex justify-content-between">\n                        <input type="radio" onchange="window.onInstallPostSelectSignChange(event)" name="install_post_panel" value="'.concat(e.id,'" data-price="').concat(e.price,'" data-image="').concat(s.Z.getSiteUrl("/private/image/panel/".concat(e.image_path)),'" class="form-check-input" id="install_panel_option_').concat(e.id,'">\n                        <label class="form-check-label text-dark" for="install_panel_option_').concat(e.id,'">').concat(e.panel_name,'</label>\n                        <span price="">$').concat(e.price,"</span>\n                    </div>\n                    ")})),t.html(a)})),$.get(s.Z.getSiteUrl("/get/agent/".concat(t.val(),"/accessories"))).done((function(e){Array.isArray(e)||(e=Object.values(e));var t=$(".list-container-accessories-install");t.empty();var a="";e.forEach((function(e){a+='\n                    <div class="form-check d-flex justify-content-between">\n                        <input type="checkbox" name="install_post_accessories[]" value="'.concat(e.id,'"\n                            data-price="').concat(e.price,'"\n                            data-image="').concat(s.Z.getSiteUrl("/private/image/panel/"+e.image),'" class="form-check-input"\n                            onchange="window.onInstallPostSelectAccessoriesChange(event)"\n                            onclick="window.accessoryClicked(event)"\n                            id="install_accessory_option_').concat(e.id,'">\n                        <label class="form-check-label text-dark"\n                            for="install_accessory_option_').concat(e.id,'">').concat(e.accessory_name,"</label>\n                        <span price>$").concat(e.price,"</span>\n                    </div>\n                   ")})),t.html(a),$("#warning-alerts").html(" ")})),_.agentChangeCount++}))},getAgent:function(e){return g(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.get(s.Z.getSiteUrl("/office/".concat(e,"/agents/order/by/name/json")));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},googleKey:o.Z.googleKey,initMap:function(){window.initMap=this.startMap;var e="https://maps.googleapis.com/maps/api/js?key=".concat(_.googleKey,"&callback=window.initMap&libraries=drawing,geometry,places&v=weekly");$("body").append(window.e("script",{src:e,googlescript:!0}))},startMap:function(){var e=new google.maps.Map(document.getElementById("install-post-search-map"),{zoom:11,center:{lat:43.633994,lng:-116.433707}});window.map=e,$('[name="install_location_adjustment"]').get(0).checked=!1},marker_position:null,searchAddress:function(){var e=this,t=$("#updateMap");t.length&&t.on("click",function(){var t=g(r().mark((function t(a){var n,o,i,c,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_.marker_position=null,n=$("#install_post_modal").find("#address").val(),o=$("#install_post_modal").find("#city").val(),i=$("#install_post_modal").find("#state").val(),!((0,d.isEmpty)(n)||(0,d.isEmpty)(o)||(0,d.isEmpty)(i))){t.next=7;break}return s.Z.alertError("Please enter property address."),t.abrupt("return",!1);case 7:if(c="".concat(n.replace(/[,]/g,"").trim(),", ").concat(o.replace(/[,]/g,"").trim(),", ").concat(i.replace(/[,]/g,"").trim()),(l=c.split(","))[1]&&l[2]){t.next=12;break}return s.Z.alertMsg("Incorrect Address Formatting","Please use this format using commas to separate city and state: [Address], [City], [State]"),t.abrupt("return",!1);case 12:e.findThePlace(c),$('[name="install_location_adjustment"]').is(":checked")&&$('[name="install_location_adjustment"]').trigger("click"),_.movedNextMonth=!0,_.updateCalendar(_.savedServiceDate,!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.onAddressChange()},hasPendingOrderSameAddress:function(e,t,a,n,o){var i=arguments;return g(r().mark((function c(){var l,d;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l=i.length>5&&void 0!==i[5]?i[5]:0,_.ignoreZoneFee=!1,e=encodeURIComponent(e),r.next=5,$.get("\n            ".concat(s.Z.getSiteUrl(),"/order/check/address/").concat(e,"/lat/").concat(t,"/lng/").concat(a,"/office/").concat(n,"/agent/").concat(o,"/order/").concat(l,"\n        "));case 5:return d=r.sent,r.abrupt("return",d);case 7:case"end":return r.stop()}}),c)})))()},handleDuplicatedOrder:function(){$("#noDuplicateOrderBtn").on("click",(function(){$(".modal").css({"overflow-y":"scroll"}),$('[name="install_post_address"]').val(""),_.ignoreZoneFee=!1,$('[name="install_post_zone_fee"]').trigger("change")})),$("#yesDuplicateOrderBtn").on("click",(function(){$(".modal").css({"overflow-y":"scroll"}),_.ignoreZoneFee=!0,$('[name="install_post_zone_fee"]').trigger("change")}))},addresIsOut:!1,findThePlace:function(e){var t=arguments,a=this;return g(r().mark((function n(){var o,i,c,l,d,p,m,u;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>1&&void 0!==t[1]&&t[1],i=t.length>2&&void 0!==t[2]&&t[2],t.length>3&&void 0!==t[3]&&t[3],c=!(t.length>4&&void 0!==t[4])||t[4],l=new google.maps.places.PlacesService(window.map),d={query:e,fields:["name","geometry"]},p=new google.maps.Geocoder,i?(m=o,window.map.setCenter(m),window.addressMarker&&window.addressMarker.setMap(null),u={url:s.Z.getSiteUrl("/storage/images/map_pin_verified.png"),anchor:new google.maps.Point(0,50)},window.addressMarker=new google.maps.Marker({position:m,map,title:e,icon:u,draggable:!1}),window.addressMarker.setDraggable($('[name="install_location_adjustment"]').get(0).checked),window.addressMarker.addListener("dragend",(function(e){p.geocode({location:e.latLng},(function(t,a){if("OK"===a)if(t[0]){var n=e.latLng.lat(),r=e.latLng.lng();_.marker_position={lat:n,lng:r},_.findThePlace(t[0].formatted_address,_.marker_position,!1,!1,!1)}else s.Z.alertError("No results for this location.");else s.Z.alertError("Address not found. Please verify property address is correct and move the marker to the correct property location on the map.")}))})),c&&window.map.setZoom(17),a.getZoneFee(m),a.getSignageFee()):l.findPlaceFromQuery(d,function(){var t=g(r().mark((function t(n,i){var l,d,m,u,g,f,v,h,y,b,w;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=12;break}return _.addresIsOut=!0,s.Z.alertError("Address not found. Please verify property address is correct and move the marker to the correct property location on the map."),l={lat:43.593469,lng:-116.434029},window.map.setCenter(l),window.map.setZoom(12),window.addressMarker&&window.addressMarker.setMap(null),d={url:s.Z.getSiteUrl("/storage/images/map_pin_verified.png"),anchor:new google.maps.Point(0,50)},window.addressMarker=new google.maps.Marker({position:l,map,title:e,icon:d,draggable:!1}),_.disableAllDates(),window.addressMarker.addListener("dragend",(function(e){p.geocode({location:e.latLng},(function(t,a){if("OK"===a)if(t[0]){var n=e.latLng.lat(),r=e.latLng.lng();_.marker_position={lat:n,lng:r},_.findThePlace(t[0].formatted_address,_.marker_position,!1,!1,!1)}else s.Z.alertError("No results for this location.");else s.Z.alertError("Address not found. Please verify property address is correct and move the marker to the correct property location on the map.")}))})),t.abrupt("return");case 12:if(!n){t.next=36;break}if(m=n[0],u=o||m.geometry.location,g=m.geometry.location.lat(),f=m.geometry.location.lng(),_.marker_position=o||{lat:g,lng:f},window.map.setCenter(u),window.addressMarker&&window.addressMarker.setMap(null),v={url:s.Z.getSiteUrl("/storage/images/map_pin_verified.png"),anchor:new google.maps.Point(0,50)},window.addressMarker=new google.maps.Marker({position:u,map,title:e,icon:v,draggable:!1}),window.addressMarker.setDraggable($('[name="install_location_adjustment"]').get(0).checked),window.addressMarker.addListener("dragend",(function(t){var a=t.latLng.lat(),n=t.latLng.lng();_.marker_position={lat:a,lng:n},_.findThePlace(e,_.marker_position,!1,!1,!1)})),c&&window.map.setZoom(17),a.getZoneFee(u),a.getSignageFee(),h=0,_.createpost||(h=_.order_id),y=$('[name="install_post_office"]').val(),b=$('[name="install_post_agent"]').val()||0,!y&&!b){t.next=36;break}return t.next=34,a.hasPendingOrderSameAddress(e,g,f,y,b,h);case 34:(w=t.sent)&&"404"!=w&&$("#duplicateOrderModal").modal();case 36:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 8:case"end":return n.stop()}}),n)})))()},totalFee:function(){$('[name="install_post_rush_fee"]').on("change",(function(e){var t=$('[name="install_post_zone_fee"]').val();_.ignoreZoneFee&&($('[name="install_post_zone_fee"]').val(0),$("[install-post-zone-fee]").html("$0"),t=0);var a=$('[name="install_post_signage"]').val(),n=e.target.value,r=parseFloat(t)+parseFloat(a)+parseFloat(n)+parseFloat(_.totalAdjusted);_.total=r,$("[install-post-total]").html("$".concat(r.toFixed(2)))})),$('[name="install_post_signage"]').on("change",(function(e){var t=$('[name="install_post_zone_fee"]').val();_.ignoreZoneFee&&($("[install-post-zone-fee]").html("$0"),$('[name="install_post_zone_fee"]').val(0),t=0);var a=$('[name="install_post_rush_fee"]').val(),n=e.target.value,r=parseFloat(t)+parseFloat(n)+parseFloat(a)+parseFloat(_.totalAdjusted);_.total=r,$("[install-post-total]").html("$".concat(r.toFixed(2)))})),$('[name="install_post_zone_fee"]').on("change",(function(e){var t=$('[name="install_post_signage"]').val(),a=$('[name="install_post_rush_fee"]').val(),n=e.target.value;_.ignoreZoneFee&&($("[install-post-zone-fee]").html("$0"),$('[name="install_post_zone_fee"]').val(0),n=0);var r=parseFloat(n)+parseFloat(t)+parseFloat(a)+parseFloat(_.totalAdjusted);_.total=r,$("[install-post-total]").html("$".concat(r.toFixed(2)))}))},getSignageFee:function(){var e=this.prices_obj.post+this.prices_obj.panels+this.prices_obj.accessories;$("[install-post-signage]").html("$".concat(e.toFixed(2))),$('[name="install_post_signage"]').val(e),$('[name="install_post_signage"]').get(0).dispatchEvent(new Event("change"))},_currentZone:null,zones_count:0,getZoneFee:function(e){var t=this;return g(r().mark((function a(){var n,o;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getZones();case 2:n=a.sent,_.zones_count=n.length,!0,100,o=0,v.zones=[],n.forEach((function(t){o++,setTimeout((function(){var a=t.points,n=new google.maps.Polygon({paths:a});t&&(google.maps.geometry.poly.containsLocation(e,n)?v.zones.push(t):v.zones.push(null))}),100*o)}));case 9:case"end":return a.stop()}}),a)})))()},getZones:function(){return g(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(s.Z.getSiteUrl("/get/zones/orderby/zone_fee/desc"));case 2:return t=e.sent,e.next=5,t.map((function(e){return e.points=s.Z.parseZonePoints(e.points),e}));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))()},onLocationAdjustmentChange:function(){var e=$('[name="install_location_adjustment"]');e.length&&e.on("change",(function(t){var a,n;null!==(a=window)&&void 0!==a&&null!==(n=a.addressMarker)&&void 0!==n&&n.setDraggable?window.addressMarker.setDraggable($('[name="install_location_adjustment"]').get(0).checked):(alert("no marker on map"),e.prop("checked",!1))}))},pricingAdjustments:{description:[],charge:[],discount:[]},totalAdjusted:0,rowCount:0,pricingAdjustment:function(){var e=$("#rowTmplInstallAdjustment").html(),t=$("#rowContainerInstallAdjustments");$("#openInstallPriceAdjustmentModalBtn").on("click",(function(){if(0==_.rowCount){_.rowCount++;var a=e.replace(/rowCount/g,_.rowCount);t.empty().append(a)}s.Z.openModal("installPriceAdjustmentModal")})),$("#closeInstallPriceAdjustmentModalBtn").on("click",(function(){s.Z.closeModal("installPriceAdjustmentModal")})),$("#addAdjustmentInstallBtn").on("click",(function(){_.rowCount++;var a=e.replace(/rowCount/g,_.rowCount);t.append(a)})),$("body").on("click",".remove-price-adjustment-row",(function(e){$(e.target).closest(".row").remove()})),$("#savePricingAdjustmentInstallBtn").on("click",(function(){var e,t,a,n=!1,r="",o=_.rowCount;_.pricingAdjustments={description:[],charge:[],discount:[]};for(var i=1;i<=o;i++)$('[name="install_price_adjustment_description['.concat(i,']"]')).length&&(e=$('[name="install_price_adjustment_description['.concat(i,']"]')).val(),t=parseFloat($('[name="install_price_adjustment_charge['.concat(i,']"]')).val())||0,a=parseFloat($('[name="install_price_adjustment_discount['.concat(i,']"]')).val())||0,e||!t&&!a||(r="Please provide description.",n=!0),e||t||a||(r="Please fill out all fields.",n=!0),_.pricingAdjustments.description[i]=e,_.pricingAdjustments.charge[i]=t,_.pricingAdjustments.discount[i]=a);if(n)return s.Z.alertError(r),!1;_.calculateAdjustments(),s.Z.closeModal("installPriceAdjustmentModal")}))},calculateAdjustments:function(){for(var e,t,a=0,n=_.rowCount,r=1;r<=n;r++)e=$('[name="install_price_adjustment_charge['.concat(r,']"]')).val(),t=$('[name="install_price_adjustment_discount['.concat(r,']"]')).val(),e>0&&(a=parseFloat(a)+parseFloat(e)),t>0&&(a=parseFloat(a)-parseFloat(t));_.totalAdjusted=a,_.totalAdjusted<0?$("[install-post-adjustments]").html('<span class="text-danger">- $'.concat(-1*_.totalAdjusted,"</span>")):$("[install-post-adjustments]").html("$".concat(_.totalAdjusted)),$('[name="install_post_zone_fee"]').trigger("change")},resetFeesOnOfficeAgentChange:function(){_.prices_obj={post:0,panels:0,accessories:0},$("[install-post-adjustments]").html("$0.00"),_.totalAdjusted=0,_.rowCount=0,_.ignoreZoneFee=!1,_.pricingAdjustments={description:[],charge:[],discount:[]},_.getSignageFee()},onAddressChange:function(){var e=this;$("#install_post_modal").find("#address").on("change",(function(t){var a=t.target;$(a).val($(a).val().replace(/[,]/g,"").trim()),e.startMap(),e.disableAllDates()}))},onCityChange:function(){$("#install_post_modal").find("#city").on("change",(function(e){var t=e.target;$(t).val($(t).val().replace(/[,]/g,"").trim())}))}};const h=_},2630:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(6486),r=a(1601),o=a(6246),s={add_sign_to_inventory:0,agent_remove_leave_at_property:1,tooglePickupAddress:function(e){"removal"===e?$("#removalOrderPickupAddress").show():$("#removalOrderPickupAddress").hide()},viewInstallDetails:function(e,t){var a=this;r.Z.showLoader();var n="".concat(r.Z.getSiteUrl(),"/order/").concat(e,"/").concat(t);$.get(n).done((function(e){var n="",s=e.office.user.name,i=e.office.user.phone,c="";e.agent&&(n=e.agent.user.name,c=e.agent.user.phone);var l="";switch(e.property_type){case 1:l="Existing Home/Condo";break;case 2:l="New Construction";break;case 3:l="Vacant Land";break;case 4:l="Commercial/Industrial"}e.desired_date_type==o.Z.date.asap?e.service_date="Rush Order":e.service_date=r.Z.formatDateUsa(e.desired_date);var d,p,m="",u="",g="",f="";d=e.post.post_name,p='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/post/".concat(e.post.image_path)),'">'),e.panel?(m='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(e.panel.image_path)),'">'),u=e.panel.panel_name):e.agent_own_sign?u="Agent will Hang Own Sign":e.sign_at_property&&(u="Sign Left at Property"),e.accessories&&($.each(e.accessories,(function(e,t){g+="".concat(t.accessory.accessory_name,", "),f+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),g=g.replace(/\,\s+$/,""));var v="";e.installer?(v=e.installer.name,$("#OrderDetailsInstallerName").removeClass("d-none")):$("#OrderDetailsInstallerName").addClass("d-none");var _="";e.status==o.Z.status_completed?(_=r.Z.formatDateTime(e.date_completed),$("#OrderDetailsInstallerDateCompleted").removeClass("d-none")):$("#OrderDetailsInstallerDateCompleted").addClass("d-none");var h="";e.installer_comments?(h=e.installer_comments.replace(/undefined/g,""),$("#OrderDetailsInstallerComments").removeClass("d-none")):$("#OrderDetailsInstallerComments").addClass("d-none");var y="";e.attachments?($.each(e.attachments,(function(e,t){y+='<a\n                        href="'.concat(r.Z.getSiteUrl("/private/document/file/".concat(t.name)),'"\n                        target="_blank"\n                    >').concat(t.name.substr(0,40),"</a><br>")})),$("#OrderDetailsAttachments").removeClass("d-none")):$("#OrderDetailsAttachments").addClass("d-none");var b="";e.photo1&&(b+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'">\n                </a>')),e.photo2&&(b+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'">\n                </a>')),e.photo3&&(b+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'">\n                </a>')),e.photo1||e.photo2||e.photo3?$("#OrderDetailsInstallerPhotos").removeClass("d-none"):$("#OrderDetailsInstallerPhotos").addClass("d-none");var w={created_at:r.Z.formatDateTime(e.created_at),office:"".concat(s,' <a href="tel:').concat(i,'" class="font-weight-bold">').concat(i,"</a>"),agent:"".concat(n,' <a href="tel:').concat(c,'" class="font-weight-bold">').concat(c,"</a>"),address:e.address,property_type:l,service_date:e.service_date,status:o.Z.getStatus(e.status,t),post:d,panel:u,post_image:p,panel_image:m,accessories:g,accessories_images:f,comments:e.comment,installer_name:v,date_completed:_,installer_comments:h,attachments:y,installer_photos:b,order_total:"$".concat(parseFloat(e.total).toFixed(2))};$("#orderDetailsModalBody").find("span").each((function(e,t){var a=$(t);$.each(w,(function(e,t){a[0].hasAttribute(e)&&a.html(t)}))})),$("#orderDetailsHeader").html("Install Order Details - #".concat(e.order_number)),a.tooglePickupAddress(t),r.Z.hideLoader("orderDetailsModal")})).fail((function(e){r.Z.hideLoader(),r.Z.alertError(r.Z.serverErrorMessage())}))},viewRepairDetails:function(e,t){var a=this;r.Z.showLoader();var n="".concat(r.Z.getSiteUrl(),"/order/").concat(e,"/").concat(t);$.get(n).done((function(e){var n=e.order,s="",i=n.office.user.name,c=n.office.user.phone,l="";n.agent&&(s=n.agent.user.name,l=n.agent.user.phone);var d="";switch(n.property_type){case 1:d="Existing Home/Condo";break;case 2:d="New Construction";break;case 3:d="Vacant Land";break;case 4:d="Commercial/Industrial"}e.service_date_type==o.Z.date.asap?e.service_date="Rush Order":e.service_date=r.Z.formatDateUsa(e.service_date);var p,m,u="",g="",f="",v="";p=n.post.post_name,m='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/post/".concat(n.post.image_path)),'">'),e.panel?(u='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(e.panel.image_path)),'">'),g=e.panel.panel_name):$.isEmptyObject(n.panel)?n.agent_own_sign?g="Agent will Hang Own Sign":n.sign_at_property&&(g="Sign Left at Property"):(u='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(n.panel.image_path)),'">'),g=n.panel.panel_name),e.panel?(u='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(e.panel.image_path)),'">'),g=e.panel.panel_name):e.agent_own_sign?g="Agent will Hang Own Sign":e.sign_at_property&&(g="Sign Left at Property"),$.isEmptyObject(e.accessories)?$.isEmptyObject(n.accessories)||($.each(n.accessories,(function(e,t){f+="".concat(t.accessory.accessory_name,", "),v+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),f=f.replace(/\,\s+$/,"")):($.each(e.accessories,(function(e,t){f+="".concat(t.accessory.accessory_name,", "),v+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),f=f.replace(/\,\s+$/,""));var _="";e.installer?(_=e.installer.name,$("#OrderDetailsInstallerName").removeClass("d-none")):$("#OrderDetailsInstallerName").addClass("d-none");var h="";e.status==o.Z.status_completed?(h=r.Z.formatDateTime(e.date_completed),$("#OrderDetailsInstallerDateCompleted").removeClass("d-none")):$("#OrderDetailsInstallerDateCompleted").addClass("d-none");var y="";e.installer_comments?(y=e.installer_comments.replace(/undefined/g,""),$("#OrderDetailsInstallerComments").removeClass("d-none")):$("#OrderDetailsInstallerComments").addClass("d-none");var b="";e.attachments?($.each(e.attachments,(function(e,t){b+='<a\n                        href="'.concat(r.Z.getSiteUrl("/private/document/file/".concat(t.name)),'"\n                        target="_blank"\n                    >').concat(t.name.substr(0,40),"</a><br>")})),$("#OrderDetailsAttachments").removeClass("d-none")):$("#OrderDetailsAttachments").addClass("d-none");var w="";e.photo1&&(w+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'">\n                </a>')),e.photo2&&(w+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'">\n                </a>')),e.photo3&&(w+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'">\n                </a>')),e.photo1||e.photo2||e.photo3?$("#OrderDetailsInstallerPhotos").removeClass("d-none"):$("#OrderDetailsInstallerPhotos").addClass("d-none");var C={created_at:r.Z.formatDateTime(e.created_at),office:"".concat(i,' <a href="tel:').concat(c,'" class="font-weight-bold">').concat(c,"</a>"),agent:"".concat(s,' <a href="tel:').concat(l,'" class="font-weight-bold">').concat(l,"</a>"),address:n.address,property_type:d,service_date:e.service_date,status:o.Z.getStatus(e.status,t),post:p,panel:g,post_image:m,panel_image:u,accessories:f,accessories_images:v,comments:e.comment,installer_name:_,date_completed:h,installer_comments:y,attachments:b,installer_photos:w,order_total:"$".concat(parseFloat(e.total).toFixed(2))};$("#orderDetailsModalBody").find("span").each((function(e,t){var a=$(t);$.each(C,(function(e,t){a[0].hasAttribute(e)&&a.html(t)}))})),$("#orderDetailsHeader").html("Repair Order Details - #".concat(e.order_number)),a.tooglePickupAddress(t),r.Z.hideLoader("orderDetailsModal")})).fail((function(e){r.Z.hideLoader(),r.Z.alertError(r.Z.serverErrorMessage())}))},viewRemovalDetails:function(e,t){var a=this;r.Z.showLoader();var i="".concat(r.Z.getSiteUrl(),"/order/").concat(e,"/").concat(t);$.get(i).done((function(e){var i=e.order,c={};i.repair&&(c=i.repair);var l="",d=i.office.user.name,p=i.office.user.phone,m="";i.agent&&(l=i.agent.user.name,m=i.agent.user.phone);var u="";switch(i.property_type){case 1:u="Existing Home/Condo";break;case 2:u="New Construction";break;case 3:u="Vacant Land";break;case 4:u="Commercial/Industrial"}e.service_date_type==o.Z.date.asap?e.service_date="Rush Order":e.service_date=r.Z.formatDateUsa(e.service_date);var g,f,v="",_="",h="",y="";g=i.post.post_name,f='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/post/".concat(i.post.image_path)),'">'),$.isEmptyObject(c)||$.isEmptyObject(c.panel)?$.isEmptyObject(i.panel)||(v='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(i.panel.image_path)),'">'),_=i.panel.panel_name):(v='<img style="max-width: 4.8rem; max-height: 5rem;" src="'.concat(r.Z.getSiteUrl("/private/image/panel/".concat(c.panel.image_path)),'">'),_=c.panel.panel_name);var b=e.sign_panel==s.add_sign_to_inventory?"Add to Inventory":"Agent Will Remove/Leave Sign at Property";_+=' (<strong class="font-italic">'.concat(b,"</strong>)"),$.isEmptyObject(c)?$.isEmptyObject(i.accessories)||($.each(i.accessories,(function(e,t){h+="".concat(t.accessory.accessory_name,", "),y+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),h=h.replace(/\,\s+$/,"")):$.isEmptyObject(c.accessories)?($.each(i.accessories,(function(e,t){h+="".concat(t.accessory.accessory_name,", "),y+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),h=h.replace(/\,\s+$/,"")):($.each(c.accessories,(function(e,t){h+="".concat(t.accessory.accessory_name,", "),y+='<img class="ml-1" style="max-width: 4.6rem; max-height: 4.8rem;" src="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(t.accessory.image)),'">')})),h=h.replace(/\,\s+$/,"")),$("#installItems").removeClass("d-none"),$("#deliveryItems").addClass("d-none");var w="";e.installer?(w=e.installer.name,$("#OrderDetailsInstallerName").removeClass("d-none")):$("#OrderDetailsInstallerName").addClass("d-none");var C="";e.status==o.Z.status_completed?(C=r.Z.formatDateTime(e.date_completed),$("#OrderDetailsInstallerDateCompleted").removeClass("d-none")):$("#OrderDetailsInstallerDateCompleted").addClass("d-none");var Z="";e.installer_comments?(Z=e.installer_comments.replace(/undefined/g,""),$("#OrderDetailsInstallerComments").removeClass("d-none")):$("#OrderDetailsInstallerComments").addClass("d-none");var x="";e.attachments?($.each(e.attachments,(function(e,t){x+='<a\n                        href="'.concat(r.Z.getSiteUrl("/private/document/file/".concat(t.name)),'"\n                        target="_blank"\n                    >').concat(t.name.substr(0,40),"</a><br>")})),$("#OrderDetailsAttachments").removeClass("d-none")):$("#OrderDetailsAttachments").addClass("d-none");var k="";e.photo1&&(k+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'">\n                </a>')),e.photo2&&(k+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'">\n                </a>')),e.photo3&&(k+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'">\n                </a>')),e.photo1||e.photo2||e.photo3?$("#OrderDetailsInstallerPhotos").removeClass("d-none"):$("#OrderDetailsInstallerPhotos").addClass("d-none");var S={created_at:r.Z.formatDateTime(e.created_at),office:"".concat(d,' <a href="tel:').concat(p,'" class="font-weight-bold">').concat(p,"</a>"),agent:"".concat(l,' <a href="tel:').concat(m,'" class="font-weight-bold">').concat(m,"</a>"),address:i.address,pickup_address:"null"==e.pickup_address||(0,n.isNull)(e.pickup_address)?"N/A":e.pickup_address,property_type:u,service_date:e.service_date,status:o.Z.getStatus(e.status,t),post:g,panel:_,post_image:f,panel_image:v,accessories:h,accessories_images:y,comments:e.comment,installer_name:w,date_completed:C,installer_comments:Z,attachments:x,installer_photos:k,order_total:"$".concat(parseFloat(e.total).toFixed(2))};$("#orderDetailsModalBody").find("span").each((function(e,t){var a=$(t);$.each(S,(function(e,t){a[0].hasAttribute(e)&&a.html(t)}))})),$("#orderDetailsHeader").html("Removal Order Details - #".concat(e.order_number)),a.tooglePickupAddress(t),("null"==e.pickup_address||(0,n.isNull)(e.pickup_address))&&$("#removalOrderPickupAddress").hide(),r.Z.hideLoader("orderDetailsModal")})).fail((function(e){r.Z.hideLoader(),r.Z.alertError(r.Z.serverErrorMessage())}))},viewDeliveryDetails:function(e,t){var a=this;r.Z.showLoader();var n="".concat(r.Z.getSiteUrl(),"/order/").concat(e,"/").concat(t);$.get(n).done((function(e){var n="",s=e.office.user.name,i=e.office.user.phone,c="";e.agent&&(n=e.agent.user.name,c=e.agent.user.phone),e.service_date_type==o.Z.date.asap?e.service_date="Rush Order":e.service_date=r.Z.formatDateUsa(e.service_date);var l="";$.isEmptyObject(e.pickups)||$.each(e.pickups,(function(e,t){l+="".concat(t.quantity," ").concat(t.panel.panel_name,"<br>")}));var d="";$.isEmptyObject(e.dropoffs)||$.each(e.dropoffs,(function(e,t){d+="".concat(t.quantity," ").concat(t.panel.panel_name,"<br>")}));var p="";e.installer?(p=e.installer.name,$("#deliveryDetailsInstallerName").removeClass("d-none")):$("#deliveryDetailsInstallerName").addClass("d-none");var m="";e.status==o.Z.status_completed?(m=r.Z.formatDateTime(e.date_completed),$("#deliveryDetailsInstallerDateCompleted").removeClass("d-none")):$("#deliveryDetailsInstallerDateCompleted").addClass("d-none");var u="";e.installer_comments?(u=e.installer_comments.replace(/undefined/g,""),$("#deliveryDetailsInstallerComments").removeClass("d-none")):$("#deliveryDetailsInstallerComments").addClass("d-none");var g="";e.photo1&&(g+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo1)),'">\n                </a>')),e.photo2&&(g+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo2)),'">\n                </a>')),e.photo3&&(g+='<a\n                    class="ml-2"\n                    href="'.concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'"\n                    target="_blank"\n                >\n                    <img style="max-width: 4.6rem; max-height: 4.8rem;" src="').concat(r.Z.getSiteUrl("/private/image/accessory/".concat(e.photo3)),'">\n                </a>')),e.photo1||e.photo2||e.photo3?$("#deliveryDetailsInstallerPhotos").removeClass("d-none"):$("#deliveryDetailsInstallerPhotos").addClass("d-none");var f={created_at:r.Z.formatDateTime(e.created_at),office:"".concat(s,' <a href="tel:').concat(i,'" class="font-weight-bold">').concat(i,"</a>"),agent:"".concat(n,' <a href="tel:').concat(c,'" class="font-weight-bold">').concat(c,"</a>"),address:e.address,service_date:e.service_date,status:o.Z.getStatus(e.status,t),comments:e.comment,installer_name:p,date_completed:m,installer_comments:u,installer_photos:g,order_total:"$".concat(parseFloat(e.total).toFixed(2)),pickups:l,dropoffs:d};$("#deliveryDetailsModalBody").find("span").each((function(e,t){var a=$(t);$.each(f,(function(e,t){a[0].hasAttribute(e)&&a.html(t)}))})),$("#deliveryDetailsHeader").html("Delivery Order Details - #".concat(e.order_number)),a.tooglePickupAddress(t),r.Z.hideLoader("deliveryDetailsModal")})).fail((function(e){r.Z.hideLoader(),r.Z.alertError(r.Z.serverErrorMessage())}))}};const i=s},6246:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(7757),r=a.n(n),o=a(6486),s=a(1601),i=a(3358),c=a(2630);function l(e,t,a,n,r,o,s){try{var i=e[o](s),c=i.value}catch(e){return void a(e)}i.done?t(c):Promise.resolve(c).then(n,r)}function d(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function s(e){l(o,n,r,s,i,"next",e)}function i(e){l(o,n,r,s,i,"throw",e)}s(void 0)}))}}var p={status_received:0,status_incomplete:1,status_scheduled:2,status_completed:3,status_cancelled:4,date:{asap:1,desired_date_type:2},userRole:0,table:{},search:new URLSearchParams(window.location.search).get("search")?new URLSearchParams(window.location.search).get("search"):"",init:function(){-1!=window.location.href.indexOf("/dashboard")&&this.datatable(),-1!=window.location.href.indexOf("/order/status")&&(-1==window.location.href.indexOf("history")&&-1==window.location.href.indexOf("routes")&&(this.datatableOrderStatus(),$("#ordersHistory").removeClass("order-tab-active"),$("#ordersActive").addClass("order-tab-active"),$("#ordersRoutes").removeClass("order-tab-active"),$("#ordersPullList").removeClass("order-tab-active")),this.filterOrderStatus(),this.searchOrderStatus(),this.showOrderStatusEntries(),-1!=window.location.href.indexOf("history")&&-1==window.location.href.indexOf("routes")&&($("#ordersHistory").addClass("order-tab-active"),$("#ordersActive").removeClass("order-tab-active"),$("#ordersRoutes").removeClass("order-tab-active"),$("#ordersPullList").removeClass("order-tab-active"),this.datatableOrderStatusHistory()),-1!=window.location.href.indexOf("routes")&&($("#ordersHistory").removeClass("order-tab-active"),$("#ordersActive").removeClass("order-tab-active"),$("#ordersRoutes").addClass("order-tab-active"),$("#ordersPullList").removeClass("order-tab-active"),this.initRoutingMap(),this.onInstallerChange(),this.onRemoveStops(),this.onRouteDateChange()),s.Z.urlContains("pull-list")&&($("#ordersHistory").removeClass("order-tab-active"),$("#ordersActive").removeClass("order-tab-active"),$("#ordersRoutes").removeClass("order-tab-active"),$("#ordersPullList").addClass("order-tab-active"),this.onPullListDateChange(),this.onPullListInstallerChange(),this.onPullListCheckbox())),this.showOrderEntries(),this.orderSearchInput(),window.editOrder=this.editOrder,window.eremoveFile=this.eremoveFile,window.orderCancel=this.orderCancel,window.markOrderCompleted=this.markOrderCompleted,this.deleteOrders(),window.viewDetails=this.viewDetails,this.onHistoryClick(),this.onActiveClick()},orderCancel:function(e){$.get("/get/order/"+e).done((function(t){t.status==p.status_scheduled?s.Z.confirm2("REMOVE FROM ROUTE","Are you sure you wish to remove this order from its scheduled route?",(function(){$.get("/order/".concat(e,"/cancel")).done((function(e){window.location.reload()}))}),(function(){})):s.Z.confirm("CANCEL ORDER","Are you sure you wish to CANCEL this order? This action is irreversible!",(function(){$.get("/order/".concat(e,"/cancel")).done((function(e){window.location.reload()}))}),(function(){}))}))},markOrderCompleted:function(e){s.Z.showLoader(),$.get("/get/order/"+e).done((function(t){var a=t.assigned_to,n="".concat(s.Z.getSiteUrl(),"/admin/installer/order/details/").concat(e,"/install/").concat(a);$("#completeOrderIframe").prop("src",n),setTimeout((function(){s.Z.hideLoader(),s.Z.openModal("markOrderCompletedModal")}),1e3)}))},showOrderEntries:function(){document.getAll(".showOrderEntries").forEach((function(e){(e=$(e)).on("change",(function(e){var t=parseInt(e.target.value);p.tables.forEach((function(e){e.api().context[0]._iDisplayLength=t,e.api().draw()}))}))}))},orderSearchInput:function(){document.getAll(".orderSearchInput").forEach((function(e){(e=$(e)).on("keyup",(function(e){var t=e.target;p.tables.forEach((function(e){e.fnFilter(t.value)}))}))}))},onHistoryClick:function(){var e=this;$("#ordersHistory").on("click",(function(t){t.preventDefault(),e.search?s.Z.redirectTo(s.Z.getSiteUrl("/order/status/history?search=".concat(e.search))):s.Z.redirectTo(s.Z.getSiteUrl("/order/status/history"))}))},onActiveClick:function(){var e=this;$("#ordersActive").on("click",(function(t){t.preventDefault(),e.search?s.Z.redirectTo(s.Z.getSiteUrl("/order/status?search=".concat(e.search))):s.Z.redirectTo(s.Z.getSiteUrl("/order/status"))}))},tables:[],datatable:function(){document.getAll(".ordersTable").forEach((function(e,t){var a=$(e);a.length&&(window["orderTable"+t]=a.dataTable({language:{search:"_INPUT_",searchPlaceholder:"Search..."},pageLength:10,dom:"rtip",ajax:s.Z.getSiteUrl("/datatable/orders/status"),serverSide:!0,columns:[{data:"address",defaultContent:"404",title:"Address",name:"address",visible:1,render:function(e,t,a){return'<a href="'.concat(s.Z.getSiteUrl(),'/order/status"\n                                    style="text-decoration: none;"\n                                >\n                                    ').concat(e,"\n                                </a>")}},{data:"status",defaultContent:"...",title:"Status",name:"orders.status",searchable:!1,orderable:!1,visible:1,render:function(e,t,a){return e==p.status_received?'<span class="badge badge-pill badge-primary">Received</span>':e==p.status_incomplete?a.assigned_to>0?'<span class="badge badge-pill badge-warning">Incomplete</span>':'<span class="badge badge-pill badge-warning">Action Needed</span>':e==p.status_scheduled?'<span class="badge badge-pill badge-info">Scheduled</span>':e==p.status_completed?'<span class="badge badge-pill badge-success">Installed</span>':e==p.status_cancelled?'<span class="badge badge-pill badge-danger">Cancelled</span>':void 0}},{data:"",defaultContent:"...",title:"Service Date",name:"desired_date",visible:1,orderable:!1,render:function(e,t,a){return a.desired_date_type!=p.date.asap?s.Z.formatDateUsa(a.desired_date):"Rush Order"}},{data:"order_number",defaultContent:"404",title:"Order ID#",name:"order_number",visible:1}]}),p.tables.push(a))}))},datatableOrderStatus:function(){var e=this;return d(r().mark((function t(){var a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.userRole=$("#userRole").val(),a="#orderStatusTable",s.Z.isMobilePhone()&&(a="#orderStatusTableMobile"),p.table=$(a).dataTable({language:{search:"_INPUT_",searchPlaceholder:"Search..."},search:{search:e.search},pageLength:10,dom:"rtip",ajax:s.Z.getSiteUrl("/datatable/orders/status"),serverSide:!0,columnDefs:[{className:"text-left",targets:[0,3]},{className:"width-px-100",targets:[4]}],columns:[{data:"address",defaultContent:"404",title:"Address",name:"address",visible:1},{data:"office_name",defaultContent:"404",title:"Office - Agent",name:"office_name",visible:0},{data:"agent_name",defaultContent:"404",title:"Office - Agent",name:"agent_name",visible:0},{data:"",defaultContent:"404",title:"Office - Agent",name:"",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return a.agent_name?"".concat(a.office_name," - ").concat(a.agent_name):"".concat(a.office_name)}},{data:"order_type",defaultContent:"...",title:"Order Type",name:"order_type",orderable:!1,visible:1,render:function(e,t,a){return"install"==e?'<span class="text-success-dark font-weight-bold">Install</span>':"repair"==e?'<span class="text-primary-dark font-weight-bold">Repair</span>':"removal"==e?'<span class="text-danger font-weight-bold">Removal</span>':"delivery"==e?'<span class="text-orange font-weight-bold">Delivery</span>':void 0}},{data:"status",defaultContent:"...",title:"Status",name:"status",orderable:!1,visible:1,render:function(e,t,a){if(e==p.status_received)return'<span class="badge badge-pill badge-primary">Received</span>';if(e==p.status_incomplete)return a.assigned_to>0?'<span class="badge badge-pill badge-warning">Incomplete</span>':'<span class="badge badge-pill badge-warning">Action Needed</span>';if(e==p.status_scheduled)return'<span class="badge badge-pill badge-info">Scheduled</span>';if(e==p.status_completed){if("install"==a.order_type)return'<span class="badge badge-pill badge-success">Installed</span>';if("repair"==a.order_type)return'<span class="badge badge-pill badge-success">Repaired</span>';if("removal"==a.order_type)return'<span class="badge badge-pill badge-success">Removed</span>';if("delivery"==a.order_type)return'<span class="badge badge-pill badge-success">Delivered</span>'}else if(e==p.status_cancelled)return'<span class="badge badge-pill badge-danger">Cancelled</span>'}},{data:"",defaultContent:"404",title:"Service Date",name:"desired_date",visible:1,orderable:!1,render:function(e,t,a){return a.desired_date_type!=p.date.asap?s.Z.formatDateUsa(a.desired_date):"Rush Order"}},{defaultContent:"...",title:"Action",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){var n='<div class="d-flex justify-content-center">';return a.status==p.status_completed?n+='<a class="link" onclick="window.viewDetails('.concat(a.id,", '").concat(a.order_type,'\')">\n                                    <img src="').concat(s.Z.getSiteUrl(),'/images/ViewDetails_Icon.png" title="View Details" alt="View Details" class="width-px-40">\n                                </a>'):("install"==a.order_type&&(n+="<a class='link text-danger text-center' onclick=\"window.orderCancel(".concat(a.id,')">\n                                <img src="').concat(s.Z.getSiteUrl(),'/images/Cancel_Icon.png" title="Cancel" alt="Cancel" class="width-px-40">\n                            </a>')),"repair"==a.order_type&&(n+="<a class='link text-danger mx-1' onclick=\"window.repairOrderCancel(".concat(a.id,')">\n                                <img src="').concat(s.Z.getSiteUrl(),'/images/Cancel_Icon.png" title="Cancel" alt="Cancel" class="width-px-40">\n                            </a>')),"removal"==a.order_type&&(n+="<a class='link text-danger mx-1' onclick=\"window.removalOrderCancel(".concat(a.id,')">\n                                <img src="').concat(s.Z.getSiteUrl(),'/images/Cancel_Icon.png" title="Cancel" alt="Cancel" class="width-px-40">\n                            </a>')),"delivery"==a.order_type&&(n+="<a class='link text-danger mx-1' onclick=\"window.deliveryOrderCancel(".concat(a.id,')">\n                                <img src="').concat(s.Z.getSiteUrl(),'/images/Cancel_Icon.png" title="Cancel" alt="Cancel" class="width-px-40">\n                            </a>')),a.status!=p.status_scheduled&&("install"==a.order_type&&(n+="<a class='link mx-1' onclick=\"window.editOrder(".concat(a.id,')">\n                                    <img src="').concat(s.Z.getSiteUrl(),'/images/Edit_Icon.png" title="Edit" alt="Edit" class="width-px-40">\n                                </a>')),"repair"==a.order_type&&(n+="<a class='link mx-1' onclick=\"window.editRepairOrder(".concat(a.id,')">\n                                    <img src="').concat(s.Z.getSiteUrl(),'/images/Edit_Icon.png" title="Edit" alt="Edit" class="width-px-40">\n                                </a>')),"removal"==a.order_type&&(n+="<a class='link mx-1' onclick=\"window.editRemovalOrder(".concat(a.id,')">\n                                    <img src="').concat(s.Z.getSiteUrl(),'/images/Edit_Icon.png" title="Edit" alt="Edit" class="width-px-40">\n                                </a>')),"delivery"==a.order_type&&(n+="<a class='link mx-1' onclick=\"window.editDeliveryOrder(".concat(a.id,')">\n                                    <img src="').concat(s.Z.getSiteUrl(),'/images/Edit_Icon.png" title="Edit" alt="Edit" class="width-px-40">\n                                </a>'))),a.status==p.status_scheduled&&1==p.userRole&&("install"==a.order_type&&(n+="<br><a class='link text-success font-weight-bold mx-1' onclick=\"window.markOrderCompleted(".concat(a.id,')">\n                                        <img src="').concat(s.Z.getSiteUrl(),'/images/Complete_Icon.png" title="Complete" alt="Complete" class="width-px-40">\n                                    </a>')),"repair"==a.order_type&&(n+="<br><a class='link text-success font-weight-bold mx-1' onclick=\"window.markRepairOrderCompleted(".concat(a.id,')">\n                                        <img src="').concat(s.Z.getSiteUrl(),'/images/Complete_Icon.png" title="Complete" alt="Complete" class="width-px-40">\n                                    </a>')),"removal"==a.order_type&&(n+="<br><a class='link text-success font-weight-bold mx-1' onclick=\"window.markRemovalOrderCompleted(".concat(a.id,')">\n                                        <img src="').concat(s.Z.getSiteUrl(),'/images/Complete_Icon.png" title="Complete" alt="Complete" class="width-px-40">\n                                    </a>')),"delivery"==a.order_type&&(n+="<br><a class='link text-success font-weight-bold mx-1' onclick=\"window.markDeliveryOrderCompleted(".concat(a.id,')">\n                                        <img src="').concat(s.Z.getSiteUrl(),'/images/Complete_Icon.png" title="Complete" alt="Complete" class="width-px-40">\n                                    </a>'))),n+='<a class="link mx-1" onclick="window.viewDetails('.concat(a.id,", '").concat(a.order_type,'\')">\n                            <img src="').concat(s.Z.getSiteUrl(),'/images/ViewDetails_Icon.png" title="View Details" alt="View Details" class="width-px-40">\n                        </a>'),n+="</div>")}},{data:"order_number",defaultContent:"...",title:"Order ID#",name:"order_number",visible:1}]});case 4:case"end":return t.stop()}}),t)})))()},datatableOrderStatusHistory:function(){var e="#orderStatusTable";s.Z.isMobilePhone()&&(e="#orderStatusTableMobile"),p.table=$(e).dataTable({retrieve:!0,language:{search:"_INPUT_",searchPlaceholder:"Search..."},search:{search:this.search},pageLength:10,dom:"rtip",ajax:s.Z.getSiteUrl("/datatable/order/status/history"),serverSide:!0,columnDefs:[{className:"text-left",targets:[0,3]},{className:"width-px-100",targets:[4]}],columns:[{data:"address",defaultContent:"404",title:"Address",name:"address",visible:1},{data:"office_name",defaultContent:"404",title:"Office - Agent",name:"office_name",visible:0},{data:"agent_name",defaultContent:"404",title:"Office - Agent",name:"agent_name",visible:0},{data:"",defaultContent:"404",title:"Office - Agent",name:"",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return a.agent_name?"".concat(a.office_name," - ").concat(a.agent_name):"".concat(a.office_name)}},{data:"order_type",defaultContent:"...",title:"Order Type",name:"order_type",orderable:!1,visible:1,render:function(e,t,a){return"install"==e?'<span class="text-success-dark font-weight-bold">Install</span>':"repair"==e?'<span class="text-primary-dark font-weight-bold">Repair</span>':"removal"==e?'<span class="text-danger font-weight-bold">Removal</span>':"delivery"==e?'<span class="text-orange font-weight-bold">Delivery</span>':void 0}},{data:"status",defaultContent:"...",title:"Status",name:"status",orderable:!1,visible:1,render:function(e,t,a){if(e==p.status_received)return'<span class="badge badge-pill badge-primary">Received</span>';if(e==p.status_incomplete)return a.assigned_to>0?'<span class="badge badge-pill badge-warning">Incomplete</span>':'<span class="badge badge-pill badge-warning">Action Needed</span>';if(e==p.status_scheduled)return'<span class="badge badge-pill badge-info">Scheduled</span>';if(e==p.status_completed){if("install"==a.order_type)return'<span class="badge badge-pill badge-success">Installed</span>';if("repair"==a.order_type)return'<span class="badge badge-pill badge-success">Repaired</span>';if("removal"==a.order_type)return'<span class="badge badge-pill badge-success">Removed</span>';if("delivery"==a.order_type)return'<span class="badge badge-pill badge-success">Delivered</span>'}else if(e==p.status_cancelled)return'<span class="badge badge-pill badge-danger">Cancelled</span>'}},{data:"",defaultContent:"404",title:"Service Date",name:"desired_date",visible:1,orderable:!1,render:function(e,t,a){return a.desired_date_type!=p.date.asap?s.Z.formatDateUsa(a.desired_date):"Rush Order"}},{defaultContent:"...",title:"Action",visible:1,searchable:!1,orderable:!1,render:function(e,t,a){return'<a class="link" onclick="window.viewDetails('.concat(a.id,", '").concat(a.order_type,'\')">\n                                <img src="').concat(s.Z.getSiteUrl(),'/images/ViewDetails_Icon.png" title="View Details" alt="View Details" class="width-px-40">\n                            </a>')}},{data:"order_number",defaultContent:"...",title:"Order ID#",name:"order_number",visible:1}]})},filterOrderStatus:function(){$("#filterOrders").on("change",(function(e){p.table.fnFilter(e.target.value)}))},searchOrderStatus:function(){this.search?$("#searchOrders").val(this.search):$("#searchOrders").val(""),$("body").on("keyup","#searchOrders",(function(e){p.table.fnFilter(e.target.value)}))},showOrderStatusEntries:function(){$("body").on("change","#showOrderStatusEntries",(function(e){var t=parseInt(e.target.value);p.table.api().context[0]._iDisplayLength=t,p.table.api().draw()}))},editOrder:function(e){i.Z.ignoreZoneFee=!1,s.Z.showLoader(),$("#import-order-div").hide(),$("#install_post_modal").length&&$.get("/get/order/"+e).done((function(e){i.Z.resetInstallModalForm(),i.Z.createpost=!1,i.Z.order_id=e.id,i.Z.upload_accessory_file=null,i.Z._files=[],p.setOfficeAndAgent(e),p.setPropertyInfo(e),p.setDate(e),p.setComment(e),p.setFiles(e),p.setFooter()}))},loadSavedAdjustments:function(e){var t=$("#rowTmplInstallAdjustment").html(),a=$("#rowContainerInstallAdjustments"),n=0;i.Z.pricingAdjustments={description:[],charge:[],discount:[]},a.empty(),$.each(e,(function(e,r){i.Z.rowCount++;var o=t.replace(/rowCount/g,i.Z.rowCount);a.append(o),$('[name="install_price_adjustment_description['.concat(i.Z.rowCount,']"]')).val(r.description),$('[name="install_price_adjustment_charge['.concat(i.Z.rowCount,']"]')).val(r.charge),$('[name="install_price_adjustment_discount['.concat(i.Z.rowCount,']"]')).val(r.discount),i.Z.pricingAdjustments.description[e]=r.description,i.Z.pricingAdjustments.charge[e]=r.charge,i.Z.pricingAdjustments.discount[e]=r.discount,n=parseFloat(n)+parseFloat(r.charge),n=parseFloat(n)-parseFloat(r.discount),i.Z.totalAdjusted=n,i.Z.totalAdjusted<0?$("[install-post-adjustments]").html('<span class="text-danger">- $'.concat(-1*i.Z.totalAdjusted,"</span>")):$("[install-post-adjustments]").html("$".concat(i.Z.totalAdjusted))})),i.Z.calculateAdjustments()},setOfficeAndAgent:function(e){var t=$('[name="install_post_office"]');t.find('option[value="'.concat(e.office_id,'"]')).prop("selected",!0),t.trigger("change"),setTimeout((function(){var t=$('[name="install_post_agent"]');e.agent_id&&(t.find('option[value="'.concat(e.agent_id,'"]')).prop("selected",!0),i.Z.agentChangeCount=0,t.get(0).dispatchEvent(new Event("change"))),setTimeout((function(){$('[name="install_post_post"][value="'.concat(e.post_id,'"]')).trigger("click"),$('[name="install_post_panel"][value="'.concat(e.panel_id,'"]')).trigger("click"),e.accessories.forEach((function(e){$('[name="install_post_accessories[]"][value="'.concat(e.accessory_id,'"]')).trigger("click")})),setTimeout((function(){if(e.files.length){2==e.property_type||3==e.property_type?$(".install-document-required-warning").addClass("d-block").removeClass("d-none"):$(".install-document-required-warning").addClass("d-none").removeClass("d-block"),$("#attachments .alert").addClass("d-none").removeClass("d-block");var t=e.accessories.map((function(e){return e.accessory})),a=[];e.files.forEach((function(e){a.push(e.accessory_id)}));var n=e.files.filter((function(e){return 1==e.plat_map}));2!=e.property_type&&3!=e.property_type||n.length||$(".install-document-required-warning").addClass("d-block").removeClass("d-none"),t.forEach((function(e){if(0==a.includes(e.id)&&1==e.prompt){var t="[install_accessory_name_id_".concat(e.id,"]");$(t).removeClass("d-none").addClass("d-block")}}))}e.agent_own_sign&&$('[name="install_post_panel_type"][value="-1"]').trigger("click"),e.sign_at_property&&$('[name="install_post_panel_type"][value="-2"]').trigger("click"),$("#loader_image").modal("hide"),$(".modal").css({"overflow-y":"scroll"}),i.Z.rowCount=0,e.adjustments&&p.loadSavedAdjustments(e.adjustments),$("#install_post_modal").modal()}),Math.floor(2e3/3))}),6e3)}),2e3)},setPropertyInfo:function(e){var t,a=$("#address"),n=$("#city"),r=$("#state");a.length&&n.length&&r.length&&(a.val(e.address.split(",")[0]),n.val(e.address.split(",")[1]),$("#state option[value=".concat(null===(t=e.address.split(",")[2])||void 0===t?void 0:t.trimStart().substr(0,2),"]")).attr("selected","selected"),1==e.ignore_zone_fee&&(i.Z.ignoreZoneFee=!0),i.Z.findThePlace(e.address,{lat:Number(e.latitude),lng:Number(e.longitude)},!0));var o=$('[name="install_post_property_type"]');o.length&&(o.find('option[value="'.concat(e.property_type,'"]')).prop("selected",!0),2==e.property_type||3==e.property_type?$(".install-document-required-warning").addClass("d-block").removeClass("d-none"):$(".install-document-required-warning").addClass("d-none").removeClass("d-block"))},setDate:function(e){var t=$("#selectdate_custom_date");if(1==e.desired_date_type)$('[name="install_post_desired_date"][value="asap"]').prop("checked",!0),t.addClass("d-none"),i.Z.setRushFee(e.rush_fee);else{$('[name="install_post_desired_date"][value="custom_date"]').trigger("click");var a=s.Z.parseDate(e.desired_date);setTimeout((function(){t.removeClass("d-none"),i.Z.updateCalendar(a),$('[name="install_post_custom_desired_date"]').val(s.Z.formatDateUsa(e.desired_date)),i.Z.savedServiceDate=a}),6e3),$("#rushFee").addClass("d-none")}},setComment:function(e){$('[name="install_post_comment"]').text(e.comment)},setFiles:function(e){$("#files_list").html(" "),e.files.forEach((function(e){i.Z._files.push(e),$("#files_list").append('\n                <li>\n                    <span>\n                    <a target="_blank" href="'.concat(s.Z.getSiteUrl("/private/document/file/".concat(e.name)),'"><strong>').concat(e.name,"</strong></a> UPLOADED ").concat(s.Z.formatDateTime(e.created_at),'\n                    <a class="text-danger c-p" onclick="window.eremoveFile(event,').concat(e.id,')"><strong>REMOVE</strong></a>\n                    </span>\n                </li>\n            '))}));var t=$('[name="install_post_property_type"]').val();0!=e.files.length||2!=t&&3!=t||$(".install-document-required-warning").addClass("d-block").removeClass("d-none")},setFooter:function(){$("#submitOrder").html('<strong class="text-white">UPDATE ORDER</strong>').prop("disabled",!1)},eremoveFile:function(e,t){$.get("/order/delete/file/".concat(t)).done((function(t){if(e.target.parentNode.parentNode.parentNode.remove(),!$("ul#files_list li").length){var a=$('[name="install_post_property_type"]').val();2!=a&&3!=a||$(".install-document-required-warning").addClass("d-block").removeClass("d-none"),$(".accessories-install-document-required-warning").addClass("d-block").removeClass("d-none")}i.Z._files=[]}))},deleteOrders:function(){$("#deleteAllOrders").on("click",(function(e){$(e.target);s.Z.confirm("","",(function(){var e=s.Z.getSiteUrl("/order/delete/all");$.post(e).done((function(e){"success"==e.type&&window.location.reload()})).fail((function(e){console.error(e)}))}),(function(){return""}))})),$("#deleteAllOrdersStatus").on("click",(function(e){$(e.target);s.Z.confirm("","",(function(){var e=s.Z.getSiteUrl("/order/status/delete/all");$.post(e).done((function(e){"success"==e.type&&window.location.reload()})).fail((function(e){console.error(e)}))}),(function(){return""}))}))},initRoutingMap:function(){window.initRoutingMap=this.startRoutingMap;var e="https://maps.googleapis.com/maps/api/js?key=".concat(i.Z.googleKey,"&callback=window.initRoutingMap&libraries=drawing,geometry,places&v=weekly");$("body").append(window.e("script",{src:e,googlescript:!0}))},startRoutingMap:function(){var e=new google.maps.Map(document.getElementById("routeMap"),{zoom:10,center:{lat:43.633994,lng:-116.433707},mapTypeId:google.maps.MapTypeId.ROADMAP});window.routeMap=e,$("#installerSelect").trigger("change")},previousMarkers:[],previousPolylines:[],routeOrders:{},installerId:{},totalAssigned:0,totalUnassigned:0,oms:{},assignedCounter:0,loadRoutesOnMap:function(e,t){p.assignedCounter=0,p.routeOrders=e,p.installerId=t;var a=window.routeMap;p.oms=new OverlappingMarkerSpiderfier(a,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0,circleSpiralSwitchover:0,keepSpiderfied:!0,nearbyDistance:25,spiralFootSeparation:26,spiralLengthStart:11,spiralLengthFactor:4});var n=p.previousMarkers;if(n.length)for(var i=0;i<n.length;i++)n[i].setMap(null);var c=p.previousPolylines;if(c.length)for(var l=0;l<c.length;l++)c[l].setMap(null);var m=new google.maps.InfoWindow,u=[],g=[];if(e.length){$.each(e,(function(e,t){var a,n,r,i,c,l={};l.order_type=t.order_type,l.latitude="null"==t.pickup_latitude||(0,o.isNull)(t.pickup_latitude)?t.latitude:t.pickup_latitude,l.longitude="null"==t.pickup_longitude||(0,o.isNull)(t.pickup_longitude)?t.longitude:t.pickup_longitude,t.assigned_to>0?("install"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),i=s.Z.getInitialsFromName(t.installer_name),n=t.stop_number>=10?""+t.stop_number:""+t.stop_number,a="".concat(i," ").concat(r," ").concat(n)),"delivery"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),i=s.Z.getInitialsFromName(t.installer_name),n=t.stop_number>=10?""+t.stop_number:""+t.stop_number,a="".concat(i," ").concat(r," ").concat(n)),"repair"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),i=s.Z.getInitialsFromName(t.installer_name),n=t.stop_number>=10?""+t.stop_number:""+t.stop_number,a="".concat(i," ").concat(r," ").concat(n)),"removal"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),i=s.Z.getInitialsFromName(t.installer_name),n=t.stop_number>=10?""+t.stop_number:""+t.stop_number,a="".concat(i," ").concat(r," ").concat(n)),l.label=a,l.assigned=!0,l.routing_color=t.routing_color,l.stop_number=t.stop_number,l.installerId=t.installer_id):(2==t.desired_date_type?("install"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),c=t.desired_date.substr(8,2),a="".concat(c," ").concat(r)),"repair"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),c=t.desired_date.substr(8,2),a="".concat(c," ").concat(r)),"delivery"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),c=t.desired_date.substr(8,2),a="".concat(c," ").concat(r)),"removal"==t.order_type&&(r=""+s.Z.initialUppercase(t.order_type),c=t.desired_date.substr(8,2),a="".concat(c," ").concat(r)),l.label=a,l.rushOrder=!1):(l.label="RUSH",l.rushOrder=!0),l.assigned=!1,l.installerId=0),l.address="null"==t.pickup_address||(0,o.isNull)(t.pickup_address)?t.address:t.pickup_address,t.desired_date&&(l.desired_date=s.Z.formatDate(t.desired_date)),1==t.desired_date_type&&(l.desired_date="Rush Order"),l.office_name=t.office_name,l.agent_name=t.agent_name||"",l.order_number=t.order_number,l.order_id=t.id,g[e]=l})),p.totalAssigned=0,p.totalUnassigned=0;for(var f=0;f<g.length;f++){var v=g[f],_=new google.maps.LatLng(v.latitude,v.longitude);u.push(v);var h=void 0,y=void 0;if(v.installerId>0){p.totalAssigned++,h={url:s.Z.getSiteUrl("/images/route_map_pin_template2.png"),anchor:new google.maps.Point(0,20),labelOrigin:{x:14,y:10}},v.rushOrder&&(h={url:s.Z.getSiteUrl("/images/route_map_pin_template_rush_order.png"),anchor:new google.maps.Point(0,20),labelOrigin:{x:14,y:10}});var b="0";"install"==v.order_type&&(b="1px"),"repair"==v.order_type&&(b="2px"),"delivery"==v.order_type&&(b="1px"),document.head.insertAdjacentHTML("beforeend",'\n                        <style class="routing-style">\n                            .route-map-label'.concat(v.installerId,"{\n                                background-color: ").concat(v.routing_color,";\n                                width: 16px;\n                                height: 16px;\n                                border-radius: 51%;\n                                margin-left: -8px;\n                                padding: 1px ").concat("0"," 0 ").concat(b,";\n                                text-align: left;\n                            }\n                        </style>\n                    ")),y={text:v.label,fontSize:"11px",fontWeight:"700",color:"#FFFFFF",className:"route-map-label".concat(v.installerId)}}else if(p.totalUnassigned++,h={url:s.Z.getSiteUrl("/images/route_map_pin_template_unassigned.png"),anchor:new google.maps.Point(0,20),labelOrigin:{x:14,y:10}},v.rushOrder)h={url:s.Z.getSiteUrl("/images/route_map_pin_template_rush_order.png"),anchor:new google.maps.Point(0,20),labelOrigin:{x:14,y:11}},y={text:v.label,fontSize:"12px",fontWeight:"700"};else{var w="38px";"repair"==v.order_type&&(w="39px"),"removal"==v.order_type&&(w="45px"),"delivery"==v.order_type&&(w="42px"),document.head.insertAdjacentHTML("beforeend",'\n                            <style class="routing-unassigned-style">\n                                .route-map-label-unassigned'.concat(v.order_type,"{\n                                    margin-left: ").concat(w,";\n                                    padding: 1px 0 0 0;\n                                    text-align: left;\n                                }\n                            </style>\n                        ")),y={text:v.label,fontSize:"12px",fontWeight:"700",className:"route-map-label-unassigned".concat(v.order_type)}}var C=new google.maps.Marker({position:_,map:a,icon:h,label:y});p.previousMarkers.push(C),function(e,n){google.maps.event.addListener(e,"spider_click",(function(r){var o,i="",c="",l=$("#installerSelect").data("installers");if(t>0){if(!n.assigned){var d={installerId:t,orderType:n.order_type,orderId:n.order_id,route_date:$("#routeDateSelect").val()};return p.assignJob(d),!1}$.each(l,(function(e,a){var n=a.id==t?"selected":"";i+='<option value="'.concat(a.id,'" ').concat(n,">").concat(a.name,"</option>")}));var u=0;$.each(p.routeOrders,(function(e,t){t.assigned_to>0&&u++}));for(var g=1,f=1;f<u+1;f++){var v="";f==n.stop_number&&(g=f,v="selected"),c+='<option value="'.concat(f,'" ').concat(v,">").concat(f,"</option>")}o='\n                                    <div style="width:330px; height:173px; text-align:left; padding:2px; line-height:20px;">\n                                        <strong>Order Type:</strong> '.concat(s.Z.initialUppercase(n.order_type),'\n                                        <strong class="ml-4">Order #:</strong> ').concat(n.order_number,"<br>\n                                        <strong>Address:</strong>  ").concat(n.address,"<br>\n                                        <strong>Service Date:</strong>  ").concat(n.desired_date,'<br><br>\n                                        <strong>Assign To:</strong>\n                                        <select class="marker-select-installer width-px-170 border-solid-1" >\n                                            <option value="0"></option>\n                                            ').concat(i,'\n                                        </select><br>\n                                        <strong>Stop Number:</strong>\n                                        <select class="marker-select-stop width-px-50 border-solid-1 mt-1" >\n                                            ').concat(c,'\n                                        </select><br>\n                                        <div class="d-flex justify-content-between mt-3">\n                                            <button\n                                                type="button"\n                                                data-order-id="').concat(n.order_id,'"\n                                                data-order-type="').concat(n.order_type,'"\n                                                data-installer="').concat(t,'"\n                                                class="btn btn-danger btn-sm marker-unassign"\n                                            >\n                                                Unassign\n                                            </button>\n                                            <button\n                                                type="button"\n                                                data-order-id="').concat(n.order_id,'"\n                                                data-order-type="').concat(n.order_type,'"\n                                                data-installer="').concat(t,'"\n                                                data-stop-number="').concat(g,'"\n                                                class="btn btn-orange btn-sm marker-update-assignment"\n                                            >\n                                                Update\n                                            </button>\n                                        </div>\n                                    </div>\n                                ')}else if(n.installerId>0){$.each(l,(function(e,t){var a=t.id==n.installerId?"selected":"";i+='<option value="'.concat(t.id,'" ').concat(a,">").concat(t.name,"</option>")}));var _=0;$.each(p.routeOrders,(function(e,t){t.assigned_to>0&&t.assigned_to==n.installerId&&_++}));for(var h=1,y=1;y<=_;y++){var b="";y==n.stop_number&&(h=y,b="selected"),c+='<option value="'.concat(y,'" ').concat(b,">").concat(y,"</option>")}o='\n                                    <div class="col-12" style="width:330px; height:173px; text-align:left; padding:2px; line-height:20px;">\n                                        <strong>Order Type:</strong> '.concat(s.Z.initialUppercase(n.order_type),'\n                                        <strong class="ml-4">Order #:</strong> ').concat(n.order_number,"<br>\n                                        <strong>Address:</strong>  ").concat(n.address,"<br>\n                                        <strong>Service Date:</strong>  ").concat(n.desired_date,'<br><br>\n                                        <strong>Assign To:</strong>\n                                        <select class="marker-select-installer width-px-170 border-solid-1" >\n                                            <option value="0"></option>\n                                            ').concat(i,'\n                                        </select><br>\n                                        <strong>Stop Number:</strong>\n                                        <select class="marker-select-stop width-px-50 border-solid-1 mt-1" >\n                                            ').concat(c,'\n                                        </select><br>\n                                        <div class="d-flex justify-content-between mt-3">\n                                            <button\n                                                type="button"\n                                                data-order-id="').concat(n.order_id,'"\n                                                data-order-type="').concat(n.order_type,'"\n                                                data-installer="').concat(n.installerId,'"\n                                                class="btn btn-danger btn-sm marker-unassign"\n                                            >\n                                                Unassign\n                                            </button>\n                                            <button\n                                                type="button"\n                                                data-order-id="').concat(n.order_id,'"\n                                                data-order-type="').concat(n.order_type,'"\n                                                data-installer="').concat(n.installerId,'"\n                                                data-stop-number="').concat(h,'"\n                                                class="btn btn-orange btn-sm marker-update-assignment"\n                                            >\n                                                Update\n                                            </button>\n                                        </div>\n                                    </div>\n                                ')}else $.each(l,(function(e,t){i+='<option value="'.concat(t.id,'">').concat(t.name,"</option>")})),o='\n                                    <div class="col-12" style="width:330px; height:145px; text-align:left; padding:2px; line-height:20px;">\n                                        <strong>Order Type:</strong> '.concat(s.Z.initialUppercase(n.order_type),'\n                                        <strong class="ml-4">Order #:</strong> ').concat(n.order_number,"<br>\n                                        <strong>Address:</strong>  ").concat(n.address,"<br>\n                                        <strong>Service Date:</strong>  ").concat(n.desired_date,'<br><br>\n                                        <strong>Assign To:</strong>\n                                        <select class="marker-select-installer width-px-170 border-solid-1 col-12" >\n                                            <option value="0"></option>\n                                            ').concat(i,'\n                                        </select><br>\n                                        <div class="text-right mt-3">\n                                            <button\n                                                type="button"\n                                                data-order-id="').concat(n.order_id,'"\n                                                data-order-type="').concat(n.order_type,'"\n                                                data-installer="0"\n                                                class="btn btn-orange btn-sm marker-assign-installer"\n                                            >\n                                                Assign\n                                            </button>\n                                        </div>\n                                    </div>\n                                ');m.setContent(o),m.open(a,e)}))}(C,v),p.oms.addMarker(C)}$("#totalAssigned").html(" ".concat(p.totalAssigned)),$("#totalUnassigned").html(" ".concat(p.totalUnassigned)),p.totalAssigned<=1&&s.Z.hideLoader(),p.delay=0;var Z=u.map((function(e){return e.installerId})),x=[];$.each(Z,(function(e,t){if(!x.includes(t)&&t>0){var a=u.filter((function(e){return e.installerId==t}));$.each(a,(function(e,t){if(a[e+1]){var n={origin:"".concat(t.latitude,", ").concat(t.longitude),destination:"".concat(a[e+1].latitude,", ").concat(a[e+1].longitude)};p.processDirection(n,t)}})),x.push(t)}}))}$("body").on("change",".marker-select-installer",(function(e){e.stopImmediatePropagation();var t=$(e.target);$(".marker-assign-installer").data("installer",t.val()),$(".marker-update-assignment").data("installer",t.val())})),$("body").on("change",".marker-select-stop",(function(e){e.stopImmediatePropagation();var t=$(e.target);$(".marker-update-assignment").data("stop-number",t.val())})),$("body").on("click",".marker-assign-installer",function(){var e=d(r().mark((function e(t){var a,n,o,i,c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopImmediatePropagation(),a=$(t.target),n=a.data("installer"),o=a.data("order-type"),i=a.data("order-id"),0!=n){e.next=8;break}return s.Z.alertError("Please select installer."),e.abrupt("return",!1);case 8:c="".concat(s.Z.getSiteUrl(),"/order/assign"),l={installerId:n,orderType:o,orderId:i,route_date:$("#routeDateSelect").val()},$.post(c,l).done((function(e){if("error"==e.type)return s.Z.alertError(e.message),!1;$("#installerSelect").trigger("change")}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$("body").on("click",".marker-update-assignment",function(){var e=d(r().mark((function e(t){var a,n,o,i,c,l,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopImmediatePropagation(),a=$(t.target),n=a.data("installer"),o=a.data("order-type"),i=a.data("order-id"),c=a.data("stop-number"),0!=n){e.next=9;break}return s.Z.alertError("Please select installer."),e.abrupt("return",!1);case 9:return l="".concat(s.Z.getSiteUrl(),"/order/assign/update"),d={installerId:n,orderType:o,stopNumber:c,orderId:i,route_date:$("#routeDateSelect").val()},e.next=13,$.post(l,d);case 13:e.sent&&$("#installerSelect").trigger("change");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$("body").on("click",".marker-unassign",function(){var e=d(r().mark((function e(t){var a,n,o,i,c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopImmediatePropagation(),a=$(t.target),n=a.data("installer"),o=a.data("order-type"),i=a.data("order-id"),0!=n){e.next=8;break}return s.Z.alertError("Please select installer."),e.abrupt("return",!1);case 8:return c="".concat(s.Z.getSiteUrl(),"/order/unassign"),l={orderType:o,orderId:i,route_date:$("#routeDateSelect").val()},e.next=12,$.post(c,l);case 12:e.sent&&$("#installerSelect").trigger("change");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},delay:0,processDirection:function(e,t){return d(r().mark((function a(){var n,o,i,c,l,d;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=window.routeMap,o={origin:e.origin,destination:e.destination},a.next=4,$.post("".concat(s.Z.getSiteUrl(),"/order/get/direction"),o);case 4:(i=a.sent)&&(i=JSON.parse(i),(c=i.routes[0].overview_polyline.points)&&(l=google.maps.geometry.encoding.decodePath(c),(d=new google.maps.Polyline({map:n,strokeColor:"".concat(t.routing_color)})).setPath(l),p.previousPolylines.push(d)));case 6:case"end":return a.stop()}}),a)})))()},assignJob:function(e){return d(r().mark((function t(){var a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(s.Z.getSiteUrl(),"/order/assign"),t.next=3,$.post(a,e);case 3:t.sent&&$("#installerSelect").trigger("change");case 5:case"end":return t.stop()}}),t)})))()},onInstallerChange:function(){var e=this;$("#installerSelect").on("change",function(){var t=d(r().mark((function t(a){var n,i,c,l,d,m,u,g,f,v,_;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{p.oms.unspiderfy()}catch(e){}return n=$(a.target),i=n.val(),c=$("#installCardTmpl").html(),l=$("#repairCardTmpl").html(),d=$("#removalCardTmpl").html(),m=$("#deliveryCardTmpl").html(),(u=$("#installerCardContainer")).empty(),g=$("#routeDateSelect").val(),f="".concat(s.Z.getSiteUrl(),"/get/installer/orders"),t.next=13,$.post(f,{installerId:i,route_date:g});case 13:v=t.sent,window.markers={},e.loadRoutesOnMap(v,i),_="",$.each(v,(function(e,t){var a=s.Z.initialUppercaseWord("null"==t.pickup_address||(0,o.isNull)(t.pickup_address)?t.address:t.pickup_address);if(a.length>32&&(a="".concat(a.substr(0,30),"...")),t.assigned_to>0||0==i){if("install"==t.order_type){var n=c.replace(/replace_address/g,a),r=t.office_name;t.agent_name&&(r="".concat(t.agent_name,", ").concat(t.office_name)),(r=s.Z.initialUppercaseWord(r)).length>32&&(r="".concat(r.substr(0,30),"...")),n=(n=n.replace(/agent_office/g,r)).replace(/post_name/g,t.post_name.length>32?"".concat(t.post_name.substr(0,30),"..."):t.post_name),_+=n}if("repair"==t.order_type){var p=l.replace(/replace_address/g,a),u=t.office_name;t.agent_name&&(u="".concat(t.agent_name,", ").concat(t.office_name)),(u=s.Z.initialUppercaseWord(u)).length>32&&(u="".concat(u.substr(0,30),"...")),p=(p=p.replace(/agent_office/g,u)).replace(/post_name/g,t.post_name.length>32?"".concat(t.post_name.substr(0,30),"..."):t.post_name),_+=p}if("removal"==t.order_type){var g=d.replace(/replace_address/g,a),f=t.office_name;t.agent_name&&(f="".concat(t.agent_name,", ").concat(t.office_name)),(f=s.Z.initialUppercaseWord(f)).length>32&&(f="".concat(f.substr(0,30),"...")),g=(g=g.replace(/agent_office/g,f)).replace(/post_name/g,t.post_name.length>32?"".concat(t.post_name.substr(0,30),"..."):t.post_name),_+=g}if("delivery"==t.order_type){var v=m.replace(/replace_address/g,a),h=t.office_name;t.agent_name&&(h="".concat(t.agent_name,", ").concat(t.office_name)),(h=s.Z.initialUppercaseWord(h)).length>32&&(h="".concat(h.substr(0,30),"...")),v=v.replace(/agent_office/g,h);var y="Pickup";1==t.post_name&&(y="Dropoff"),v=v.replace(/post_name/g,y),_+=v}}})),u.append(_);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onRemoveStops:function(){$("#removeStops").on("click",(function(e){var t="All Installers";$("#installerSelect").val()>0&&(t=$("#installerSelect option:selected").text()),$("#removeFor").html(t),$("#removeStopsModal").modal()})),$("#confirmRemoveStopsBtn").on("click",(function(e){s.Z.showLoader();var t=$("#installerSelect").val(),a="".concat(s.Z.getSiteUrl(),"/order/remove/stops");$.post(a,{installerId:t}).done((function(e){$("#installerSelect").trigger("change"),s.Z.closeModal("removeStopsModal")}))}))},viewDetails:function(e,t){if(!e||!t)return!1;"delivery"==t&&c.Z.viewDeliveryDetails(e,t),"install"==t&&c.Z.viewInstallDetails(e,t),"repair"==t&&c.Z.viewRepairDetails(e,t),"removal"==t&&c.Z.viewRemovalDetails(e,t)},getStatus:function(e,t){var a="";return e==p.status_received&&(a="Received"),e==p.status_incomplete&&(a="Action Needed"),e==p.status_cancelled&&(a="Cancelled"),e==p.status_scheduled&&(a="Scheduled"),e==p.status_completed&&("install"==t&&(a="Installed"),"repair"==t&&(a="Repaired"),"removal"==t&&(a="Removed"),"delivery"==t&&(a="Delivered")),a},onRouteDateChange:function(){$("#routeDateSelect").on("change",function(){var e=d(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$("#installerSelect").trigger("change");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$(".pull-list-date-select").on("change",function(){var e=d(r().mark((function e(t){var a,n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=$(t.target),n=a.val(),o="".concat(s.Z.getSiteUrl(),"/order/status/pull-list/").concat(n),s.Z.showLoader(),s.Z.redirectTo(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onPullListDateChange:function(){$(".pull-list-date-select").on("change",function(){var e=d(r().mark((function e(t){var a,n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=$(t.target),n=a.val(),o="".concat(s.Z.getSiteUrl(),"/order/status/pull-list/").concat(n),s.Z.showLoader(),s.Z.redirectTo(o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onPullListInstallerChange:function(){$(".pull-list-installer-select").on("change",function(){var e=d(r().mark((function e(t){var a,n,o,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=$(t.target),n=$(".pull-list-date-select").val(),o=a.val(),i="".concat(s.Z.getSiteUrl(),"/order/status/pull-list/").concat(n,"/").concat(o),s.Z.showLoader(),s.Z.redirectTo(i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onPullListCheckbox:function(){$(".pull-list-item").each((function(e,t){var a=$(t),n=a.data("name"),r=s.Z.getDateString(new Date);r=r.replace(/\-/g,"");var o="".concat(r,"-").concat(n),i=s.Z.getDateString(s.Z.previousDay(new Date));i=i.replace(/\-/g,"");for(var c=0;c<localStorage.length;c++)s.Z.stringContains(localStorage.key(c),i)&&localStorage.removeItem(localStorage.key(c));null===localStorage.getItem(o)?a.prop("checked",!1):a.prop("checked",!0)})),$(".pull-list-item").on("change",(function(e){var t=$(e.target),a=t.data("name"),n=s.Z.getDateString(new Date);n=n.replace(/\-/g,"");var r="".concat(n,"-").concat(a);t.is(":checked")?localStorage.setItem(r,a):localStorage.removeItem(r)}))}};const m=p}},e=>{e.O(0,[898],(()=>{return t=5572,e(e.s=t);var t}));e.O()}]);