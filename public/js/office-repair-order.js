"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[758],{9350:(e,r,a)=>{a.d(r,{Z:()=>o});var t=a(1601),n={init:function(){this.onPaymentFormSubmit();var e='[name="payment_type"]',r=".form-another-card input",a='[name="card_profile"]',t=".form-another-card select";$(r).prop("disabled",!0),$(e).on("change",(function(n){var o=n.target;$(e).prop("checked",!1),o.checked=!0,"use_another_card"==o.getAttribute("id")?($(r).prop("disabled",!1),$(a).prop("disabled",!0),$(t).prop("disabled",!1)):($(a).prop("disabled",!1),$(r).prop("disabled",!0),$(t).prop("disabled",!0)),console.log(o)})),$('[name="repair_payment_type"]').on("change",(function(e){var a=e.target;$('[name="repair_payment_type"]').prop("checked",!1),a.checked=!0,"repair_use_another_card"==a.getAttribute("id")?($(r).prop("disabled",!1),$(t).prop("disabled",!1),$('[name="repair_card_profile"]').prop("disabled",!0)):($('[name="repair_card_profile"]').prop("disabled",!1),$(r).prop("disabled",!0),$(t).prop("disabled",!0))})),$('[name="removal_payment_type"]').on("change",(function(e){var a=e.target;$('[name="removal_payment_type"]').prop("checked",!1),a.checked=!0,"removal_use_another_card"==a.getAttribute("id")?($(r).prop("disabled",!1),$('[name="removal_card_profile"]').prop("disabled",!0),$(t).prop("disabled",!1)):($('[name="removal_card_profile"]').prop("disabled",!1),$(r).prop("disabled",!0),$(t).prop("disabled",!0))})),$('[name="delivery_payment_type"]').on("change",(function(e){var a=e.target;$('[name="delivery_payment_type"]').prop("checked",!1),a.checked=!0,"delivery_use_another_card"==a.getAttribute("id")?($(r).prop("disabled",!1),$('[name="delivery_card_profile"]').prop("disabled",!0),$(t).prop("disabled",!1)):($('[name="delivery_card_profile"]').prop("disabled",!1),$(r).prop("disabled",!0),$(t).prop("disabled",!0))})),this.orderHold(),this.repairOrderHold(),this.removalOrderHold(),this.deliveryOrderHold(),this.onRepairPaymentFormSubmit(),this.onRemovalPaymentFormSubmit(),this.onDeliveryPaymentFormSubmit(),this.onCardDeclinedOrderHold()},onPaymentFormSubmit:function(){var e=$("#paymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),t.Z.showLoader();var r={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;r[e.name]=e.value})),$.post(t.Z.getSiteUrl("/payment/pay"),r).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var r,a=$('[name="order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("install"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),t.Z.openModal("cardDeclinedModal"),t.Z.hideLoader(""),"card declined"==(null===(r=e.messages.message[1])||void 0===r?void 0:r.text)&&($('[name="payment_type"]').trigger("change"),$("#card_profile_select").empty())}})).fail((function(e){var r=e.responseJSON,a="<ul>";for(var n in a+="<li class='text-danger'><b>"+r.message+"</b></li>",r.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+r.errors[n]+"</li>";a+="</ul>",t.Z.alertError(a),t.Z.hideLoader("")}))}))},loadCards:function(e,r){var a="".concat(t.Z.getSiteUrl(),"/payment/get-saved-cards/").concat(r);$.get(a).done((function(r){console.log(r);var a="";$.each(r,(function(r,t){0==e.find('option[value="'.concat(t.customerProfileId,"::").concat(r,'"]')).length&&(a+='<option value="'.concat(t.customerProfileId,"::").concat(r,'">').concat(t.cardType,": XXXX-XXXX-").concat(t.cardNumber,"  exp ").concat(t.expDate,"</option>"))})),e.append(a)})).fail((function(e){t.Z.alertError("Unable to load cards due to server error.")}))},loadAgentCardsVisibleToOffice:function(e,r,a){var n="".concat(t.Z.getSiteUrl(),"/payment/get-agent-cards-visible-to-office/").concat(r,"/").concat(a);$.get(n).done((function(r){console.log(r);var a="";$.each(r,(function(r,t){0==e.find('option[value="'.concat(t.customerProfileId,"::").concat(r,'"]')).length&&(a+='<option value="'.concat(t.customerProfileId,"::").concat(r,'">').concat(t.cardType,": XXXX-XXXX-").concat(t.cardNumber,"  exp ").concat(t.expDate,"</option>"))})),console.log(a),e.append(a)})).fail((function(e){t.Z.alertError("Unable to load cards due to server error.")}))},loadOfficeCardsVisibleToAgent:function(e,r,a,n,o){var i="".concat(t.Z.getSiteUrl(),"/payment/get-office-cards-visible-to-agents/").concat(r,"/").concat(a,"/").concat(n);$.get(i).done((function(r){console.log(r);var a="";$.each(r,(function(r,t){0==e.find('option[value="'.concat(t.customerProfileId,"::").concat(r,'"]')).length&&(a+='<option value="'.concat(t.customerProfileId,"::").concat(r,'">').concat(t.cardType,": XXXX-XXXX-").concat(t.cardNumber,"  exp ").concat(t.expDate,"</option>"))})),e.append(a),"function"==typeof o&&o()})).fail((function(e){t.Z.alertError("Unable to load cards due to server error.")}))},orderHold:function(){$(".order-hold").on("click",(function(e){e.stopImmediatePropagation(),t.Z.showLoader();var r=$('[name="order_id"]').val(),a="".concat(t.Z.getSiteUrl(),"/order/email/").concat(r);$.get(a).done((function(e){window.location.reload()}))}))},repairOrderHold:function(){$(".repair-order-hold").on("click",(function(e){e.stopImmediatePropagation(),t.Z.showLoader();var r=$('[name="repair_order_id"]').val(),a="".concat(t.Z.getSiteUrl(),"/repair/order/email/").concat(r);$.get(a).done((function(e){window.location.reload()}))}))},removalOrderHold:function(){$(".removal-order-hold").on("click",(function(e){e.stopImmediatePropagation(),t.Z.showLoader();var r=$('[name="removal_order_id"]').val(),a="".concat(t.Z.getSiteUrl(),"/removal/order/email/").concat(r);$.get(a).done((function(e){window.location.reload()}))}))},deliveryOrderHold:function(){$(".delivery-order-hold").on("click",(function(e){e.stopImmediatePropagation(),t.Z.showLoader();var r=$('[name="delivery_order_id"]').val(),a="".concat(t.Z.getSiteUrl(),"/delivery/order/email/").concat(r);$.get(a).done((function(e){window.location.reload()}))}))},onRepairPaymentFormSubmit:function(){var e=$("#repairPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),t.Z.showLoader();var r={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;r[e.name]=e.value})),$.post("".concat(t.Z.getSiteUrl(),"/payment/repair/pay"),r).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var r,a=$('[name="repair_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("repair"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),t.Z.openModal("cardDeclinedModal"),t.Z.hideLoader(""),"card declined"==(null===(r=e.messages.message[1])||void 0===r?void 0:r.text)&&($('[name="repair_payment_type"]').trigger("change"),$("#repair_card_profile_select").empty())}})).fail((function(e){console.log(e);var r=e.responseJSON,a="<ul>";for(var n in a+="<li class='text-danger'><b>"+r.message+"</b></li>",r.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+r.errors[n]+"</li>";a+="</ul>",t.Z.alertError(a),t.Z.hideLoader("")}))}))},multiplePosts:!1,onRemovalPaymentFormSubmit:function(){var e=$("#removalPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),t.Z.showLoader();var r={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;r[e.name]=e.value})),r.multiplePosts=n.multiplePosts,$.post("".concat(t.Z.getSiteUrl(),"/payment/removal/pay"),r).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var r,a=$('[name="removal_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("removal"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),t.Z.openModal("cardDeclinedModal"),t.Z.hideLoader(""),"card declined"==(null===(r=e.messages.message[1])||void 0===r?void 0:r.text)&&($('[name="removal_payment_type"]').trigger("change"),$("#removal_card_profile_select").empty())}})).fail((function(e){console.log(e);var r=e.responseJSON,a="<ul>";for(var n in a+="<li class='text-danger'><b>"+r.message+"</b></li>",r.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+r.errors[n]+"</li>";a+="</ul>",t.Z.alertError(a),t.Z.hideLoader("")}))}))},onDeliveryPaymentFormSubmit:function(){var e=$("#deliveryPaymentForm");e.length&&e.on("submit",(function(e){e.stopImmediatePropagation(),e.preventDefault(),t.Z.showLoader();var r={};$(e.target).serializeArray().forEach((function(e){if("_token"==e.name)return null;r[e.name]=e.value})),$.post("".concat(t.Z.getSiteUrl(),"/payment/delivery/pay"),r).done((function(e){if(console.log(e),"Error"!=e.messages.resultCode&&e.transactionResponse.authCode)window.location.reload();else{var r,a=$('[name="delivery_order_id"]').val();$("#actionNeededModal").find("#actionNeededOrdertype").val("delivery"),$("#actionNeededModal").find("#actionNeededOrderId").val(a),t.Z.openModal("cardDeclinedModal"),t.Z.hideLoader(""),"card declined"==(null===(r=e.messages.message[1])||void 0===r?void 0:r.text)&&($('[name="delivery_payment_type"]').trigger("change"),$("#delivery_card_profile_select").empty())}})).fail((function(e){console.log(e);var r=e.responseJSON,a="<ul>";for(var n in a+="<li class='text-danger'><b>"+r.message+"</b></li>",r.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),a+="<li class='text-danger'>"+r.errors[n]+"</li>";a+="</ul>",t.Z.alertError(a),t.Z.hideLoader("")}))}))},onCardDeclinedOrderHold:function(){$("#cardDeclinedHoldOrderBtn").on("click",(function(e){e.stopImmediatePropagation(),t.Z.closeModal("cardDeclinedModal"),t.Z.openModal("actionNeededModal")})),$("#closeActionNeededModalBtn").on("click",(function(e){e.stopImmediatePropagation(),t.Z.showLoader();var r={order_type:$("#actionNeededOrdertype").val(),order_id:$("#actionNeededOrderId").val()};$.post("".concat(t.Z.getSiteUrl(),"/order/action-needed/email"),r).done((function(e){t.Z.closeModal("actionNeededModal"),window.location.reload()})).fail((function(e){t.Z.alertError(t.Z.serverErrorMessage()),t.Z.hideLoader("")}))}))}};const o=n},5195:(e,r,a)=>{a.d(r,{Z:()=>t});const t={googleKey:a(1601).Z.urlContains("local")?"AIzaSyCNqhRTqZM2fILA4IL2F2uZEXKGAn6T_cw":"AIzaSyAFcHd4cAMJHgHl1OFUOPluT-jpNoULOnM"}},1601:(e,r,a)=>{a.d(r,{Z:()=>l});var t=a(7757),n=a.n(t);a(6486);function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return i(e,r);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return i(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var a=0,t=new Array(r);a<r;a++)t[a]=e[a];return t}function c(e,r,a,t,n,o,i){try{var c=e[o](i),s=c.value}catch(e){return void a(e)}c.done?r(s):Promise.resolve(s).then(t,n)}function s(e){return function(){var r=this,a=arguments;return new Promise((function(t,n){var o=e.apply(r,a);function i(e){c(o,t,n,i,s,"next",e)}function s(e){c(o,t,n,i,s,"throw",e)}i(void 0)}))}}var d={getSiteUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return window.location.origin+e},validateEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},validateDomain:function(e){return/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/.test(String(e).toLowerCase())},alertError:function(e){$("#errorModalContent").html(e),$("#errorModal").modal("show"),$(".modal").css({"overflow-y":"scroll"})},alertMsg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=$("#messageModal");a.find("#messageModelTitle").html(e),a.find("#messageModelContent").html(r),a.modal("show"),$(".modal").css({"overflow-y":"scroll"})},confirm:function(e,r,a,t){$(".modal").css({"overflow-y":"scroll"}),e?$("#confirmModalHeader").html(e):$("#confirmModalHeader").html("Are you sure?"),r?$("#confirmModalContent").html(r):$("#confirmModalContent").html("This action is irreversible!"),$("#confirmModal").modal("show"),$("#confirmBtnOk").off("click"),$("#confirmBtnOk").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal").modal("hide"),a()})),$("#confirmBtnCancel").off("click"),$("#confirmBtnCancel").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal").modal("hide"),t()}))},confirm2:function(e,r,a,t){$(".modal").css({"overflow-y":"scroll"}),e?$("#confirmModalHeader2").html(e):$("#confirmModalHeader2").html("Are you sure?"),r?$("#confirmModalContent2").html(r):$("#confirmModalContent2").html("This action is irreversible!"),$("#confirmModal2").modal("show"),$("#confirmBtnOk2").off("click"),$("#confirmBtnOk2").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal2").modal("hide"),a()})),$("#confirmBtnCancel2").off("click"),$("#confirmBtnCancel2").on("click",(function(e){e.stopImmediatePropagation(),$("#confirmModal2").modal("hide"),t()}))},roundToHalf:function(e){return Math.round(2*e)/2},reloadPage:function(){window.location.reload()},serverErrorMessage:function(){return"An error occured, please try again or contact support if the problem persists."},inchesToFeet:function(e){return e/12},feetToInches:function(e){return 12*e},getDecimal:function(e){return e%1},isMobilePhone:function(){return window.matchMedia("only screen and (max-width: 800px)").matches},isTablet:function(){return window.matchMedia("only screen and (min-device-width: 768px) and (max-device-width: 1366px) and (-webkit-min-device-pixel-ratio: 1)").matches},redirectTo:function(e){window.location.href=e},urlContains:function(e){return-1!=window.location.href.indexOf(e)},stringContains:function(e,r){return-1!=e.indexOf(r)},validateForm:function(e){return s(n().mark((function r(){var a,t;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(e instanceof HTMLElement)){r.next=17;break}if("form"!==e.localName){r.next=13;break}return a=e.querySelectorAll("input"),t=[],r.next=6,a.forEach((function(r){if(!("validation-except"in r.attributes)&&!["file"].includes(r.type)&&("required"in r.attributes&&!r.value.trim()&&t.push({node:r,type:"required"}),"validation-match"in r.attributes)){var a=r.attributes["validation-match"].value,n=(a=e[a]).value,o=r.value;n.trim()!=o.trim()&&(t.push({node:r,type:"match"}),t.push({node:a,type:"match"}))}}));case 6:return r.sent,document.querySelectorAll(".invalid-feedback").forEach((function(e){return e.remove()})),t.forEach((function(e){var r,a,t=e.node.attributes[e.type+"-error-msg"],n=null!==(r=null===(a=e.node.attributes["error-class"])||void 0===a?void 0:a.value)&&void 0!==r?r:"";if(e.node.classList.add("is-invalid"),t){var o='<div class="invalid-feedback '.concat(n,'">').concat(t.value,"</div>");e.node.insertAdjacentHTML("afterend",o)}})),t.length||(e.querySelectorAll("input").forEach((function(e){"validation-except"in e.attributes||(e.classList.remove("is-invalid"),e.classList.add("is-valid"))})),document.querySelectorAll(".invalid-feedback").forEach((function(e){return e.remove()}))),r.abrupt("return",{ok:!t.length,errors:t});case 13:return console.error("validateForm() acept  HTML element type of <form>. * YOU GIVE US  <".concat(e.localName,">").toUpperCase()),r.abrupt("return",!1);case 15:r.next=19;break;case 17:return console.error("validateForm() acept  HTML element.".toUpperCase()),r.abrupt("return",!1);case 19:case"end":return r.stop()}}),r)})))()},loadImageOn:function(e,r){(e=$(e)).length&&e.on("change",(function(e){if((r=$(r)).length){var a=e.target.files[0];r.prop("src",URL.createObjectURL(a))}}))},parseDate:function(e){var r=e.slice(0,10),a=(r=r.replace(/\//g,"-")).split("-");return new Date(a[0],a[1]-1,a[2])},parseUSDate:function(e){var r=e.slice(0,10),a=(r=r.replace(/\//g,"-")).split("-");return new Date(a[2],a[0]-1,a[1])},formatDate:function(e){var r=this.parseDate(e);return new Intl.DateTimeFormat("en",{month:"numeric",day:"numeric",year:"numeric"}).format(r)},formatDateCustom:function(e,r){var a=this.parseDate(e);return new Intl.DateTimeFormat("en",r).format(a)},formatDateTime:function(e){var r=new Date(e.replace(/\s/,"T")),a=r.getHours(),t=r.getMinutes(),n=a>=12?"PM":"AM",o=(a=(a%=12)||12)+":"+(t=t<10?"0"+t:t)+" "+n;return r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()+"  "+o},formatDateUsa:function(e){var r=this.parseDate(e);return new Intl.DateTimeFormat("en-US").format(r)},formatDateUsaDateString:function(e){var r=this.parseUSDate(e);return new Intl.DateTimeFormat("en-US").format(r)},diffDays:function(e,r){var a=new Date(e),t=new Date(r).getTime()-a.getTime();return parseInt(t/864e5)},isNextDay:function(e,r){return 1==this.diffDays(e,r)},isCutoffTime:function(){var e=new Date;return e.getHours()>=20&&e.getMinutes()>0},getDateStringUsa:function(e){var r=e.getFullYear(),a="".concat(e.getMonth()+1),t="".concat(e.getDate());return 1==t.length&&(t="0"+t),1==a.length&&(a="0"+a),a+"/"+t+"/"+r},getDateString:function(e){var r=e.getFullYear(),a="".concat(e.getMonth()+1),t="".concat(e.getDate());return 1==t.length&&(t="0"+t),1==a.length&&(a="0"+a),"".concat(r,"-").concat(a,"-").concat(t)},getDateTimeString:function(e){var r=e.getFullYear(),a="".concat(e.getMonth()+1),t="".concat(e.getDate());1==t.length&&(t="0"+t),1==a.length&&(a="0"+a);var n=e.getHours(),o=e.getMinutes(),i=(n=(n%=12)||12)+":"+(o=o<10?"0"+o:o);return"".concat(r,"-").concat(a,"-").concat(t,"T").concat(i)},isLastDayOfMonth:function(e){return 1===new Date(e.getTime()+864e5).getDate()},tzOffset:function(){return(new Date).getTimezoneOffset()},previousDay:function(e){return e.setDate(e.getDate()-1),e},isWeekend:function(e){return 6===e.getDay()||0===e.getDay()},create_id:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},parseZonePoints:function(e){return(e=JSON.parse(e)).map((function(e){return{lat:parseFloat(e.lat),lng:parseFloat(e.lng)}}))},orderOptions:function(e){var r=$(e),a=r.map((function(e,r){return{t:$(r).text(),v:r.value}})).get();a.sort((function(e,r){return e.t<r.t?1:e.t>r.t?-1:0})),r.each((function(e,r){r.value=a[e].v,$(r).text(a[e].t)}))},cardNumberInput:function(e){if(e){var r,a,t=document.querySelector(e),n=/^\d{0,16}$/g,o=function(e){return e.replace(/[^\d]/g,"")},i=function(e,r){return Math.floor(e/(r+1))},c=function(e){var r={amex:/^3/,visa:/^4/,mastercard:/^5/,disc:/^6/,genric:/(^1|^2|^7|^8|^9|^0)/};for(var a in r)if(r[a].test(e)){a;break}};t.addEventListener("keydown",(function(e){var t=e.target;r=t.value,a=t.selectionEnd})),t.addEventListener("input",(function(e){var t,s=e.target,d=o(s.value);d.match(n)?(d=function(e,r,a){for(var t=[],n=0;n<e.length;n++)0!==n&&n%r==0&&t.push(a),t.push(e[n]);return t.join("")}(d,4," "),t=a-i(a,4)+i(a+(d.length-r.length),4)+(o(d).length-o(r).length),s.value=""!==d?d:""):(s.value=r,t=a),s.setSelectionRange(t,t),c(s.value)}))}},removeFromArray:function(e,r){return e.splice(e.indexOf(r),1)},getZoneSettings:function(){return s(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(d.getSiteUrl("/get/zone/settings"));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))()},genId:function(){return"id"+Math.floor(99999999999999.66*Math.random()).toString(36).substring(1)},showLoader:function(){$("#loader_image").modal("show")},hideLoader:function(e){setTimeout((function(){$("#loader_image").modal("hide"),e&&($(".modal").css({"overflow-y":"scroll"}),$("#".concat(e)).modal())}),500)},openModal:function(e){$("#".concat(e)).modal()},closeModal:function(e){$("#".concat(e)).modal("hide"),$(".modal").css({"overflow-y":"scroll"})},inputNumber:function(e){var r=o(Array(100).keys());$("".concat(e)).on("keyup",(function(e){var a=$(e.target);a.val()&&(r.includes(parseInt(a.val()))?a.val(parseInt(a.val())):a.val(1))}))},getCurrentUserRole:function(){return s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get("".concat(d.getSiteUrl(),"/current/user/role"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},getInitialsFromName:function(e){var r=e.split(" ");return(r.shift().charAt(0)+r.pop().charAt(0)).toUpperCase()},initialUppercase:function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},initialUppercaseWord:function(e){if("string"!=typeof e)return"";for(var r=e.split(" "),a=0;a<r.length;a++)""!=r[a]&&void 0!==r[a]&&(r[a]=r[a][0].toUpperCase()+r[a].substr(1).toLowerCase());return r.join(" ")},loadImagePreview:function(e,r){if(e.target.files.length>0){var a=URL.createObjectURL(e.target.files[0]);document.getElementById(r).src=a}},isSuperAdmin:function(){return 1==$("#userRole").val()},log:function(e){return console.log(e),!1},decodeHtml:function(e){var r=document.createElement("textarea");return r.innerHTML=e,r.value},removeEmptyObjectFromArray:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=e.filter((function(e){return 0!==Object.keys(e).length}));return r},roundToDecimal:function(e,r){var a=Math.pow(10,r);return Math.round(e*a)/a}};const l=d},8619:(e,r,a)=>{var t=a(7757),n=a.n(t),o=a(1601),i=a(5195),c=a(9350);function s(e,r){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,r){if(!e)return;if("string"==typeof e)return d(e,r);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return d(e,r)}(e))||r&&e&&"number"==typeof e.length){a&&(e=a);var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw o}}}}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var a=0,t=new Array(r);a<r;a++)t[a]=e[a];return t}function l(e,r,a,t,n,o,i){try{var c=e[o](i),s=c.value}catch(e){return void a(e)}c.done?r(s):Promise.resolve(s).then(t,n)}function p(e){return function(){var r=this,a=arguments;return new Promise((function(t,n){var o=e.apply(r,a);function i(e){l(o,t,n,i,c,"next",e)}function c(e){l(o,t,n,i,c,"throw",e)}i(void 0)}))}}var u={status_received:0,status_incomplete:1,status_scheduled:2,status_completed:3,status_cancelled:4,repair_order_id:0,countClickAccessory:{},countClickPanel:{},installedAccessories:{},order:{},zone:{},settings:{},total:0,totalPost:0,totalPanel:0,totalAccessories:0,accessories:[],create:!0,payment_method_office_pay:3,repairAccessories:{},repairAccessoryActions:{},dailyOrderCap:0,countOrders:null,init:function(){this.loadDatatable(),this.repairOrderSearchInput(),this.showRepairOrderEntries(),window.createRepairOrder=this.createRepairOrder,window.editRepairOrder=this.editRepairOrder,window.repairOrderCancel=this.repairOrderCancel,this.onDesiredDateChange(),o.Z.urlContains("/order/status")||this.initRepairMap(),this.totalFee(),$.get(o.Z.getSiteUrl("/get/holidays")).done((function(e){u.holidays=e})),$.get(o.Z.getSiteUrl("/get/zone/settings")).done((function(e){u.dailyOrderCap=e.daily_order_cap})),$.get(o.Z.getSiteUrl("/office/count-orders")).done((function(e){u.countOrders=e})),window.onAccessoryChange=this.onAccessoryChange,window.onSignPanelClick=this.onSignPanelClick,this.onCommentChange(),this.onFileUploaded(),window.repairRemoveFile=this.repairRemoveFile,this.onSubmitForm(),c.Z.init(),o.Z.cardNumberInput(".cc-number-input"),window.eRepairRemoveFile=this.eRepairRemoveFile},repairOrderCancel:function(e){o.Z.confirm("","This action is irreversible!",(function(){$.get("/repair/order/".concat(e,"/cancel")).done((function(e){window.location.reload()}))}),(function(){}))},loadDatatable:function(){var e="#repairOrdersTable";o.Z.isMobilePhone()&&(e="#repairOrdersTableMobile"),o.Z.isTablet()&&(e="#repairOrdersTableTablet"),u.table=$(e).dataTable({language:{search:"_INPUT_",searchPlaceholder:"Search..."},infoCallback:function(e,r,a,t,n,o){return"Showing ".concat(r," to ").concat(a," of ").concat(n," entries")},pageLength:10,dom:"rtip",ajax:o.Z.getSiteUrl("/datatable/office/orders/repair"),serverSide:!0,columns:[{data:"address",defaultContent:"",title:"Address",name:"orders.address",visible:1},{data:"repair_status",defaultContent:"",title:"Repair Status",name:"status",visible:0},{data:"repair_order_number",defaultContent:"",title:"Repair Order Id",name:"order_number",visible:0},{data:"order_number",defaultContent:"",title:"Order Id",name:"orders.order_number",visible:0},{data:"status",defaultContent:"",title:"Status",name:"status",searchable:!1,orderable:!1,visible:1,render:function(e,r,a){var t=a.desired_date;1==a.desired_date_type&&(t=a.updated_at);var n='<span class="font-weight-bold" style="color: #267F00">\n                            INSTALLED '.concat(o.Z.formatDate(t),"\n                        </span>");if("repair"==a.order_type){var i=parseInt(a.repair_status),c=1==a.desired_date_type?"Rush Order":o.Z.formatDate(a.desired_date);n='<span class="text-primary-dark font-weight-bold">\n                                REPAIR '.concat(c,"\n                            </span>"),n+="<br>",i==u.status_received?n+='<span class="badge badge-pill badge-primary">Received</span>':i==u.status_incomplete?a.assigned_to>0?n+='<span class="badge badge-pill badge-warning">Incomplete</span>':n+='<span class="badge badge-pill badge-warning">Action Needed</span>':i==u.status_scheduled?n+='<span class="badge badge-pill badge-info">Scheduled</span>':i==u.status_completed?n+='<span class="badge badge-pill badge-success">Completed</span>':i==u.status_cancelled&&(n+='<span class="badge badge-pill badge-danger">Cancelled</span>')}return n}},{defaultContent:"...",title:"Action",visible:1,searchable:!1,orderable:!1,render:function(e,r,a){var t='<div class="d-flex justify-content-between">';if("install"==a.order_type)return t+="<a class='link mx-1' onclick=\"window.createRepairOrder(".concat(a.id,')">\n                                <img src="./images/Repair_Icon.png" title="Create" alt="Create" class="width-px-40">\n                            </a>'),t+="</div>";if("repair"==a.order_type){var n=parseInt(a.repair_status);if([u.status_received,u.status_incomplete].includes(n)&&(t+="<a class='link mx-1' onclick=\"window.editRepairOrder(".concat(a.id,')">\n                                    <img src="./images/Repair_Icon.png" title="Edit" alt="Edit" class="width-px-40">\n                                </a>')),[u.status_received,u.status_incomplete].includes(n))return t+="<a class='link text-danger mx-1' onclick=\"window.repairOrderCancel(".concat(a.id,')">\n                                    <img src="./images/Cancel_Icon.png" title="Cancel" alt="Cancel" class="width-px-40">\n                                </a>'),t+="</div>"}return t+="</div>"}},{data:"all_order_number",defaultContent:"404",title:"Order ID#",name:"all_order_number",searchable:!1,visible:1,render:function(e,r,a){return a.order_number}}]})},repairOrderSearchInput:function(){$("body").on("keyup","#repairOrderSearchInput",(function(e){var r=e.target.value;u.table.fnFilter(r)}))},showRepairOrderEntries:function(){$("body").on("change","#showRepairOrderEntries",(function(e){var r=parseInt(e.target.value);u.table.api().context[0]._iDisplayLength=r,u.table.api().draw()}))},previousPanel:0,onSignPanelClick:function(e){var r=$(e.target),a=r.data("price"),t=r.val();u.countClickPanel[t]=u.countClickPanel[t]||0,u.countClickPanel[t]=parseInt(u.countClickPanel[t])+1,1==u.countClickPanel[t]?(u.totalPanel=a,u.setRepairFee(),$("#repair_sign_image_preview").removeClass("d-none").prop("src",r.data("image")).show(),u.previousPanel=t):u.previousPanel==t?(r.prop("checked",!1),u.countClickPanel[t]=0,u.totalPanel=0,u.setRepairFee(),$("#repair_sign_image_preview").addClass("d-none").prop("src",""),u.existingPanelImg&&$("#repair_sign_image_preview").removeClass("d-none").prop("src",u.existingPanelImg).show()):(u.totalPanel=a,u.setRepairFee(),$("#repair_sign_image_preview").removeClass("d-none").prop("src",r.data("image")).show(),u.previousPanel=t)},onAccessoryChange:function(e){var r=$(e.target),a=r.val(),t=!1;$.each(u.installedAccessories,(function(e,r){r.accessory_id==a&&(t=!0)})),u.countClickAccessory[a]=u.countClickAccessory[a]||0,u.countClickAccessory[a]=parseInt(u.countClickAccessory[a])+1,r.addClass("css-checkbox");var n=$(".repair-order-preview-images");r.removeClass("repair-accessory add-replace"),r.removeClass("repair-accessory remove"),r.is(":checked")?(n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(r.data("image"),'" id="repairAccessoryImg').concat(r.val(),'">')),$("#accessory_icon_".concat(a)).hasClass("fa-plus-square")||$("#accessory_icon_".concat(a)).addClass("fa-plus-square"),$("#accessory_icon_".concat(a)).removeClass("fa-minus-square").show(),$("#accessory_icon_".concat(a)).removeClass("fa-minus-square").show(),r.addClass("repair-accessory add-replace")):($("#repairAccessoryImg".concat(r.val())).remove(),t?u.countClickAccessory[a]>1?($("#accessory_icon_".concat(a)).hide(),r.removeClass("css-checkbox"),r.prop("checked",!0),u.countClickAccessory[a]=0,n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(r.data("image"),'" id="repairAccessoryImg').concat(r.val(),'">'))):($("#accessory_icon_".concat(a)).removeClass("fa-plus-square").addClass("fa-minus-square").show(),r.addClass("repair-accessory remove")):($("#accessory_icon_".concat(a)).hide(),r.removeClass("css-checkbox"),r.removeClass("add-accessory")));var i=0;u.accessories=[],$('[name="repair_order_accessories[]"]').each((function(e,r){var a=$(r);t=!1,$.each(u.installedAccessories,(function(e,a){a.accessory_id==r.value&&(t=!0)})),!t&&a.is(":checked")&&(i+=parseFloat(r.dataset.price)),u.accessories[e]={},a.hasClass("repair-accessory add-replace")&&(u.accessories[e].accessory_id=r.value,u.accessories[e].action=0),a.hasClass("repair-accessory remove")&&(u.accessories[e].accessory_id=r.value,u.accessories[e].action=1),u.accessories=o.Z.removeEmptyObjectFromArray(u.accessories),console.log(u.accessories)})),u.totalAccessories=i,u.setRepairFee()},loadOfficePanels:function(e){var r=e.office.id;$.get(o.Z.getSiteUrl("/get/office/".concat(r,"/panels"))).done((function(r){Array.isArray(r)||(r=Object.values(r));var a=$(".list-container-signs");a.empty();var t="";r.forEach((function(r){var a=0;u.create?a=e.panel_id:e.repair&&e.repair.panel_id&&(a=e.repair.panel_id),r.id,t+='\n                    <div class="form-check d-flex justify-content-between">\n                        <input type="radio" name="repair_order_panel" value="'.concat(r.id,'"\n                            data-price="').concat(r.price,'"\n                            data-image="').concat(o.Z.getSiteUrl("/private/image/panel/".concat(r.image_path)),'"\n                            class="form-check-input" id="repair_panel_option_').concat(r.id,'"\n                            onclick="window.onSignPanelClick(event)"\n                        >\n                        <label class="form-check-label text-dark" for="repair_panel_option_').concat(r.id,'">').concat(r.panel_name,"</label>\n                        <span>$").concat(r.price,"</span>\n                    </div>\n                ")})),a.append(t),u.create||(u.rowCount=0,e.repair.adjustments&&u.loadSavedAdjustments(e.repair.adjustments))}))},loadOfficeAccessories:function(e){var r=e.office.id;$.get(o.Z.getSiteUrl("/get/office/".concat(r,"/accessories"))).done((function(r){Array.isArray(r)||(r=Object.values(r));var a=$(".list-container-accessories-repair");a.empty();var t="",n=$(".repair-order-preview-images");$(".accessory_image_preview").remove(),u.installedAccessories=e.accessories;var i=e.accessories;u.create||e.repair&&!$.isEmptyObject(e.repair.accessories)&&(i=e.repair.accessories,u.repairAccessories=e.repair.accessories);var c=0,s=[],d=-1;r.forEach((function(e){var r="";u.create||$.each(u.installedAccessories,(function(a,t){t.accessory_id==e.id&&(r="checked",s[e.id]=!0)})),$.each(i,(function(a,t){if(t.accessory_id==e.id){r="checked";var i="".concat(o.Z.getSiteUrl("/private/image/accessory/"+e.image));s[e.id]=!1,$.each(u.installedAccessories,(function(r,a){a.accessory_id==e.id&&(s[e.id]=!0)})),u.create||s[e.id]||(c+=parseFloat(e.price)),u.create||(s[e.id]=!1,0==(d=t.action)&&n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(i,'" id="repairAccessoryImg').concat(e.id,'">'))),(u.create||s[e.id])&&n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(i,'" id="repairAccessoryImg').concat(e.id,'">'))}})),t='\n                <div class="form-check d-flex justify-content-between">\n                    <input type="checkbox" name="repair_order_accessories[]" value="'.concat(e.id,'"\n                        data-price="').concat(e.price,'"\n                        data-image="').concat(o.Z.getSiteUrl("/private/image/accessory/"+e.image),'"\n                        class="form-check-input"\n                        id="repair_accessory_option_').concat(e.id,'"\n                        ').concat(r,"\n                        ").concat(r?"ignore-in-total":"",'\n                        onchange="window.onAccessoryChange(event)"\n                    >\n                    <label class="form-check-label text-dark css-label" for="repair_accessory_option_').concat(e.id,'">\n                        <span id="accessory_icon_').concat(e.id,'" class="fa fa-plus-square"></span>\n                        <span class="pl-1">').concat(e.accessory_name,"<span>\n                    </label>\n                    <span>$").concat(e.price,"</span>\n                </div>\n                "),a.append(t),u.create||!r||s[e.id]||(0==d&&($("#repair_accessory_option_".concat(e.id)).prop("checked",!0),$("#repair_accessory_option_".concat(e.id)).addClass("css-checkbox"),$("#repair_accessory_option_".concat(e.id)).addClass("repair-accessory add-replace"),$("#accessory_icon_".concat(e.id)).removeClass("fa-minus-square").addClass("fa-plus-square").show()),1==d&&($("#repair_accessory_option_".concat(e.id)).prop("checked",!1),$("#repair_accessory_option_".concat(e.id)).addClass("css-checkbox"),$("#repair_accessory_option_".concat(e.id)).addClass("repair-accessory remove"),$("#accessory_icon_".concat(e.id)).removeClass("fa-plus-square").addClass("fa-minus-square").show()))})),u.create||(u.totalAccessories=c,u.setRepairFee())}))},loadAgentPanels:function(e){var r=e.agent.id;$.get(o.Z.getSiteUrl("/get/agent/".concat(r,"/panels"))).done((function(r){Array.isArray(r)||(r=Object.values(r));var a=$(".list-container-signs");a.empty();var t="";r.forEach((function(r){var a=0;u.create?a=e.panel_id:e.repair&&e.repair.panel_id&&(a=e.repair.panel_id),r.id,t+='\n                    <div class="form-check d-flex justify-content-between">\n                        <input type="radio" name="repair_order_panel" value="'.concat(r.id,'"\n                            data-price="').concat(r.price,'"\n                            data-image="').concat(o.Z.getSiteUrl("/private/image/panel/".concat(r.image_path)),'"\n                            class="form-check-input" id="repair_panel_option_').concat(r.id,'"\n                            onclick="window.onSignPanelClick(event)"\n                        >\n                        <label class="form-check-label text-dark" for="repair_panel_option_').concat(r.id,'">').concat(r.panel_name,"</label>\n                        <span>$").concat(r.price,"</span>\n                    </div>\n                ")})),a.append(t),u.create||(u.rowCount=0,e.repair.adjustments&&u.loadSavedAdjustments(e.repair.adjustments))}))},loadAgentAccessories:function(e){var r=e.agent.id;$.get(o.Z.getSiteUrl("/get/agent/".concat(r,"/accessories"))).done((function(r){Array.isArray(r)||(r=Object.values(r));var a=$(".list-container-accessories-repair");a.empty();var t="",n=$(".repair-order-preview-images");$(".accessory_image_preview").remove(),u.installedAccessories=e.accessories;var i=e.accessories;u.create||e.repair&&!$.isEmptyObject(e.repair.accessories)&&(i=e.repair.accessories,u.repairAccessories=e.repair.accessories);var c=0,s=[],d=-1;r.forEach((function(e){var r="";u.create||$.each(u.installedAccessories,(function(a,t){t.accessory_id==e.id&&(r="checked",s[e.id]=!0)})),$.each(i,(function(a,t){if(t.accessory_id==e.id){r="checked";var i="".concat(o.Z.getSiteUrl("/private/image/accessory/"+e.image));s[e.id]=!1,$.each(u.installedAccessories,(function(r,a){a.accessory_id==e.id&&(s[e.id]=!0)})),u.create||s[e.id]||(c+=parseFloat(e.price)),u.create||(s[e.id]=!1,0==(d=t.action)&&n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(i,'" id="repairAccessoryImg').concat(e.id,'">'))),(u.create||s[e.id])&&n.append('<img class="max-width-125px max-height-113px accessory_image_preview" src="'.concat(i,'" id="repairAccessoryImg').concat(e.id,'">'))}})),t='\n                <div class="form-check d-flex justify-content-between">\n                    <input type="checkbox" name="repair_order_accessories[]" value="'.concat(e.id,'"\n                        data-price="').concat(e.price,'"\n                        data-image="').concat(o.Z.getSiteUrl("/private/image/accessory/"+e.image),'"\n                        class="form-check-input"\n                        id="repair_accessory_option_').concat(e.id,'"\n                        ').concat(r,"\n                        ").concat(r?"ignore-in-total":"",'\n                        onchange="window.onAccessoryChange(event)"\n                    >\n                    <label class="form-check-label text-dark css-label" for="repair_accessory_option_').concat(e.id,'">\n                        <span id="accessory_icon_').concat(e.id,'" class="fa fa-plus-square"></span>\n                        <span class="pl-1">').concat(e.accessory_name,"<span>\n                    </label>\n                    <span>$").concat(e.price,"</span>\n                </div>\n                "),a.append(t),u.create||!r||s[e.id]||(0==d&&($("#repair_accessory_option_".concat(e.id)).prop("checked",!0),$("#repair_accessory_option_".concat(e.id)).addClass("css-checkbox"),$("#repair_accessory_option_".concat(e.id)).addClass("repair-accessory add-replace"),$("#accessory_icon_".concat(e.id)).removeClass("fa-minus-square").addClass("fa-plus-square").show()),1==d&&($("#repair_accessory_option_".concat(e.id)).prop("checked",!1),$("#repair_accessory_option_".concat(e.id)).addClass("css-checkbox"),$("#repair_accessory_option_".concat(e.id)).addClass("repair-accessory remove"),$("#accessory_icon_".concat(e.id)).removeClass("fa-plus-square").addClass("fa-minus-square").show()))})),u.create||(u.totalAccessories=c,u.setRepairFee())}))},setOfficeAndAgent:function(e){$("#repairOrderOffice").val(e.office.user.name),e.agent?($("#repairOrderAgent").val(e.agent.user.name),this.loadAgentPanels(e),this.loadAgentAccessories(e)):(this.loadOfficePanels(e),this.loadOfficeAccessories(e))},googleKey:i.Z.googleKey,initRepairMap:function(){window.initRepairMap=this.startRepairMap;var e="https://maps.googleapis.com/maps/api/js?key=".concat(u.googleKey,"&callback=window.initRepairMap&libraries=drawing,geometry,places&v=weekly");$("body").append(window.e("script",{src:e,googlescript:!0}))},startRepairMap:function(){var e=new google.maps.Map(document.getElementById("repairOrderMap"),{zoom:11,center:{lat:43.633994,lng:-116.433707}});window.repairMap=e},loadAddressOnMap:function(e,r){window.repairMap.setCenter(r);var a=window.repairMap,t={url:o.Z.getSiteUrl("/storage/images/map_pin_verified.png"),anchor:new google.maps.Point(0,50)};new google.maps.Marker({position:r,map:a,title:e,icon:t,draggable:!1}),window.repairMap.setZoom(17)},setPropertyInfo:function(e){var r;$("#repairOrderAddress").val(e.address.split(",")[0]),$("#repairOrderCity").val(e.address.split(",")[1]),$("#repairOrderState option[value=".concat(null===(r=e.address.split(",")[2])||void 0===r?void 0:r.trimStart().substr(0,2),"]")).attr("selected","selected"),u.loadAddressOnMap(e.address,{lat:Number(e.latitude),lng:Number(e.longitude)}),$("#repairOrderPropertyType").find('option[value="'.concat(e.property_type,'"]')).prop("selected",!0)},getRepairZone:function(e){return p(n().mark((function r(){var a;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,$.get(o.Z.getSiteUrl("/repair/get/zone/".concat(e)));case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}}),r)})))()},movedNextMonth:!1,updateCalendar:function(e){if($("#repairOrderDatePicker").datepicker("destroy"),$("#repairOrderDatePicker").datepicker({onSelect:function(e){return console.log(e),$('[name="repair_order_custom_desired_date"]').val(e),u.updateCalendar(o.Z.parseUSDate(e))},beforeShowDay:function(r){var a=o.Z.getDateStringUsa(r);if(u.holidays.includes(a))return[!1];var t=$.datepicker.formatDate("yy-mm-dd",new Date(r)),n=u.countOrders[t];if(void 0!==n&&n>=u.dailyOrderCap)return[!1];var i=o.Z.getDateStringUsa(new Date),c=o.Z.diffDays(a,i),s=i,d=a,l="";if(e&&(l=o.Z.getDateStringUsa(e)),o.Z.isNextDay(s,a)&&o.Z.isCutoffTime())return[!1];if(s==d)return s==l?[!0,"ui-state-highlight ui-state-active",""]:[!1];if(c>=1)return l==d?[!0,"ui-state-highlight ui-state-active",""]:[!1];if(u.zone.data){for(var p=u.zone.data,m=[p.su,p.m,p.tu,p.w,p.th,p.f,p.sa],f=0;f<m.length;f++){var g=m[f];if(r.getDay()===f)return[g]}return[!0]}return[!0]}}),e){var r=o.Z.getDateStringUsa(e);$("#repairOrderDatePicker").datepicker("setDate",r)}else{var a=new Date;o.Z.isLastDayOfMonth(a)&&!u.movedNextMonth&&u.create&&(u.movedNextMonth=!0,setTimeout((function(){$("#repairOrderDatePicker .ui-datepicker-next").trigger("click")}),3e3))}},setDate:function(e){var r=$("#repairOrderDatePicker");1==e.service_date_type?(u.updateCalendar(!1),$('[name="repair_order_desired_date"][value="asap"]').prop("checked",!0),r.addClass("d-none")):($("#rushFeeRepair").addClass("d-none"),$('[name="repair_order_desired_date"][value="custom_date"]').prop("checked",!0),$('[name="repair_order_desired_date"][value="custom_date"]').trigger("change"),setTimeout((function(){r.removeClass("d-none"),$('[name="repair_order_custom_desired_date"]').val(e.service_date),u.updateCalendar(o.Z.parseDate(e.service_date))}),1e3))},setPostSignAccessories:function(e){if($('label[for="repairOrderPost"]').html(e.post.post_name),u.create)$("#repair_replace_post").prop("checked",!1),$("#relocate_post").prop("checked",!1);else{u.rowCount=0,e.repair.adjustments&&u.loadSavedAdjustments(e.repair.adjustments);var r=0;e.repair&&e.repair.replace_repair_post?($("#repair_replace_post").prop("checked",!0),r=parseFloat(r)+parseFloat($("#repair_replace_post").val())):$("#repair_replace_post").prop("checked",!1),e.repair&&e.repair.relocate_post?($("#relocate_post").prop("checked",!0),r+=parseFloat($("#relocate_post").val())):$("#relocate_post").prop("checked",!1),u.totalPost=r,u.setRepairFee()}var a=o.Z.getSiteUrl("/private/image/post/".concat(e.post.image_path));$("#repair_post_image_preview").removeClass("d-none").prop("src",a).show();var t={};if(e.repair&&e.repair.panel?(t=e.repair.panel,u.totalPanel=t.price,u.setRepairFee()):t=e.panel,t){$("#selectedPanel").show(),$('label[for="repairOrderPanel"]').html(t.panel_name);var n=o.Z.getSiteUrl("/private/image/panel/".concat(t.image_path));$("#repair_sign_image_preview").removeClass("d-none").prop("src",n).show(),u.existingPanelImg=n}else $("#selectedPanel").hide()},resetForm:function(){this.startRepairMap(),$("#repair_post_image_preview").addClass("d-none"),$("#repairOrderAgent").val(""),$('[name="repair_order_comment"]').val(""),$("[repair-adjustments]").html("$0.00"),u.totalAdjusted=0,this.resetTotals(),this.setRushFee(0),this.setRepairFee(),$('[name="repair_order_desired_date"][value="custom_date"]').trigger("click"),$(".list-container-accessories-repair").empty()},createRepairOrder:function(e){u.resetForm(),o.Z.showLoader(),$.get("/repair/get/install-order/"+e).done(function(){var e=p(n().mark((function e(r){var a,t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.create=!0,u.order=r,u.order_id=u.order.id,e.next=5,u.getRepairZone(u.order.id);case 5:return u.zone=e.sent,e.next=8,o.Z.getZoneSettings();case 8:u.settings=e.sent,u.setOfficeAndAgent(r),u.setPropertyInfo(r),u.setPostSignAccessories(r),u.movedNextMonth=!1,u.updateCalendar(!1),u.setFooter(),u.zone.data&&u.settings&&(a=u.zone.data,t=u.settings,i=parseFloat(a.zone_fee)*t.repair/100,$('[name="repair_order_zone_fee"]').val(i),$("[repair-zone-fee]").html("$".concat(i.toFixed(2))),$('[name="repair_order_zone_fee"]').trigger("change")),o.Z.hideLoader("repairOrderModal");case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},setFooter:function(){u.create?$("#submitRepairOrder").html('<strong class="text-white">SUBMIT REPAIR</strong>').prop("disabled",!1):$("#submitRepairOrder").html('<strong class="text-white">UPDATE ORDER</strong>').prop("disabled",!1)},setComment:function(e){$('[name="repair_order_comment"]').val(e.comment)},setAttachments:function(e){$("#files_list_repair").html(" "),e.attachments.forEach((function(e){$("#files_list_repair").append('\n                <li>\n                    <span>\n                    <a target="_blank" href="'.concat(o.Z.getSiteUrl("/private/document/file/".concat(e.file_name)),'"><strong>').concat(e.file_name,"</strong></a> UPLOADED ").concat(o.Z.formatDateTime(e.created_at),'\n                    <a class="text-danger c-p" onclick="window.eRepairRemoveFile(event, ').concat(e.id,')"><strong>REMOVE</strong></a>\n                    </span>\n                </li>\n            '))}))},editRepairOrder:function(e){u.resetForm(),o.Z.showLoader(),$.get("/repair/get/order/"+e).done(function(){var e=p(n().mark((function e(r){var a,t,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.create=!1,u.repair_order_id=r.id,u.order=r.order,u.order_id=u.order.id,e.next=6,u.getRepairZone(u.order.id);case 6:return u.zone=e.sent,e.next=9,o.Z.getZoneSettings();case 9:u.settings=e.sent,u.setOfficeAndAgent(r.order),u.setPropertyInfo(r.order),u.setPostSignAccessories(r.order),u.setDate(r,!1),u.setComment(r),u.setAttachments(r),u.setFooter(),u.setRushFee(r.rush_fee),r.total>0?u.zone.data&&u.settings&&(a=u.zone.data,t=u.settings,i=parseFloat(a.zone_fee)*t.repair/100,$('[name="repair_order_zone_fee"]').val(i),$("[repair-zone-fee]").html("$".concat(i.toFixed(2))),$('[name="repair_order_zone_fee"]').trigger("change")):(u.totalPost=0,u.totalPanel=0,u.totalAccessories=0,$('[name="repair_order_zone_fee"]').val(0),$('[name="repair_trip_fee"]').val(0),$('[name="repair_order_fee"]').val(0),$("[repair-fee]").html("$0.00"),$("[repair-trip-fee]").html("$0.00"),$('[name="repair_order_zone_fee"]').trigger("change")),o.Z.hideLoader("repairOrderModal");case 20:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},onDesiredDateChange:function(){var e=this,r=document.getAll('[name="repair_order_desired_date"]'),a=$("#repairOrderDatePicker");r.forEach((function(e){e.onchange=function(e){var r=e.target.value;$('[name="repair_order_desired_date"]').removeAttr("checked"),$(e.target).prop("checked",!0),"custom_date"===r?(u.setRushFee(0),a.removeClass("d-none"),$("#rushFeeRepair").addClass("d-none")):($("#repairRushOrderModal").modal(),a.addClass("d-none"))}})),$("[repair-rush-fee-decline-button]").on("click",(function(r){$(".modal").css({"overflow-y":"scroll"}),e.setRushFee(0),$('[name="repair_order_desired_date"][value="custom_date"]').trigger("click")})),$("[repair-rush-fee-accept-button]").on("click",(function(r){$(".modal").css({"overflow-y":"scroll"});var a=$('[name="repair_order_desired_date"]').attr("repair-rush-order-fee");e.setRushFee(a)}))},setRushFee:function(e){var r=$('input[name="repair_order_rush_fee"]');r.val(e),r.trigger("change"),e>0&&$("#rushFeeRepair").removeClass("d-none")},totalFee:function(){$('[name="repair_order_rush_fee"]').on("change",(function(e){var r=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(r.toFixed(2))),u.total=r})),$('[name="repair_order_fee"]').on("change",(function(e){var r=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(r.toFixed(2))),u.total=r})),$('[name="repair_order_zone_fee"]').on("change",(function(e){var r=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(r.toFixed(2))),u.total=r})),$('[name="repair_options_post[]"]').on("change",(function(e){var r=$(e.target);if(r.is(":checked")){var a=0;$('[name="repair_options_post[]"]').each((function(e,r){r.checked&&(a+=parseFloat(r.value))})),u.totalPost=a;var t=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(t.toFixed(2)));var n=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories);$("[repair-fee]").html("$".concat(n.toFixed(2))),u.total=t}else{u.totalPost=u.totalPost-parseFloat(r.val());var o=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(o.toFixed(2)));var i=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories);$("[repair-fee]").html("$".concat(i.toFixed(2))),u.total=o}}))},getTotalFees:function(){var e=$('[name="repair_order_rush_fee"]').val(),r=$('[name="repair_order_zone_fee"]').val(),a=$('[name="repair_trip_fee"]').val();return parseFloat(a)+parseFloat(r)+parseFloat(e)},onCommentChange:function(){var e=$('[name="repair_order_comment"]');e.length&&e.on("keyup",(function(r){var a=(e.val()||"").trim().length;$(".char-used").html(a),a>500?e.addClass("is-invalid"):e.removeClass("is-invalid")}))},_files:[],onFileUploaded:function(){var e=this,r=$('input[name="repair_order_files[]"]');r.length&&r.on("change",(function(r){var a,t=s(r.target.files);try{for(t.s();!(a=t.n()).done;){var n=a.value;n._id=o.Z.genId(),u._files.push(n),u.displayFiles(e._files),u.setFiles(e._files)}}catch(e){t.e(e)}finally{t.f()}}))},setFiles:function(e){var r=$('input[name="repair_order_files[]"]');r.length&&(r.files=e)},displayFiles:function(e){var r=$("#files_list_repair");r.length&&(r.html(""),e.forEach((function(e){r.append('\n                <li>\n                    <span>\n                        <a href="#"><strong>'.concat(e.name,"</strong></a>\n                        UPLOADED ").concat(o.Z.formatDateTime((new Date).toISOString()),"\n                        <a class='text-danger c-p' onclick=\"window.repairRemoveFile('").concat(e._id,"')\"><strong>REMOVE</strong></a>\n                    </span>\n                </li>"))})))},repairRemoveFile:function(e){return p(n().mark((function r(){var a;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u._files.filter((function(r){return r._id!=e}));case 2:a=r.sent,u._files=a,u.setFiles(u._files),u.displayFiles(u._files),u._files.length||$('input[name="repair_order_files[]"]').val("");case 7:case"end":return r.stop()}}),r)})))()},eRepairRemoveFile:function(e,r){$.get("/repair/order/delete/file/".concat(r)).done((function(r){e.target.parentNode.parentNode.parentNode.remove()}))},setRepairFee:function(){var e=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories);$("[repair-fee]").html("$".concat(e.toFixed(2))),$('[name="repair_order_fee"]').val(e);var r=parseFloat(u.totalPost)+parseFloat(u.totalPanel)+parseFloat(u.totalAccessories)+u.getTotalFees()+parseFloat(u.totalAdjusted);$("[repair-total]").html("$".concat(r.toFixed(2))),u.total=r},resetTotals:function(){u.totalPost=0,u.totalPanel=0,u.totalAccessories=0},onSubmitForm:function(){$("#repairOrderForm").on("submit",(function(e){o.Z.showLoader(),e.preventDefault();var r=$(e.target),a=new FormData;a.append("repair_order_desired_date",r.find('[name="repair_order_desired_date"]:checked').val()),a.append("repair_order_custom_desired_date",r.find('[name="repair_order_custom_desired_date"]').val()),$("#repair_replace_post").is(":checked")?a.append("repair_replace_post",1):a.append("repair_replace_post",0),$("#relocate_post").is(":checked")?a.append("relocate_post",1):a.append("relocate_post",0),a.append("panel_id",r.find('[name="repair_order_panel"]:checked').val()),a.append("repair_order_select_accessories",JSON.stringify(u.accessories)),a.append("repair_order_comment",r.find('[name="repair_order_comment"]').val()),a.append("create_order",u.create),a.append("order_id",u.order_id),a.append("repair_order_id",u.repair_order_id),u._files.forEach((function(e,r){return a.append("file".concat(r),e)})),a.append("repair_trip_fee",r.find('[name="repair_trip_fee"]').val()),a.append("repair_order_rush_fee",r.find('[name="repair_order_rush_fee"]').val()),a.append("repair_order_fee",r.find('[name="repair_order_fee"]').val()),a.append("repair_order_zone_fee",r.find('[name="repair_order_zone_fee"]').val()),a.append("total",u.total),r.find('[type="submit"]').prop("disabled",!0),r.find('[type="submit"]').html('<strong class="text-white">SENDING...</strong>'),$.ajax({url:r.prop("action"),data:a,type:"POST",contentType:!1,processData:!1,cache:!1}).done((function(e){if(e.type&&"error"==e.type)return o.Z.alertError(e.message),r.find('[type="submit"]').prop("disabled",!1),r.find('[type="submit"]').html('<strong class="text-white">TRY AGAIN</strong>'),o.Z.hideLoader(""),!1;if(e.repairOrder.editOrder&&!e.repairOrder.needPayment&&window.location.reload(),e.repairOrder.needPayment){$("[repair-payment-total-amount]").html(parseFloat(e.repairOrder.total).toFixed(2)),$("[repair-payment-card-name]").val(e.billing.name),$("[repair-billing-name]").val(e.billing.name),$("[repair-billing-address]").val(e.billing.address),$("[repair-billing-city]").val(e.billing.city),$("[repair-billing-state]").val(e.billing.state),$("[repair-billing-zip]").val(e.billing.zipcode),e.repairOrder.office.user.authorizenet_profile_id?($("#repair_use_card_profile").prop("checked",!0),$("#repair_card_profile_select").prop("disabled",!1),$(".form-another-card input").prop("disabled",!0),$("#repair_use_another_card").prop("checked",!1),c.Z.loadCards($("#repair_card_profile_select"),e.repairOrder.office.user.id)):($(".form-another-card input").prop("disabled",!1),$("#repair_use_another_card").prop("checked",!0),$("#repair_use_card_profile").prop("checked",!1),$("#repair_card_profile_select").prop("disabled",!0)),e.repairOrder.agent&&e.repairOrder.agent.user.authorizenet_profile_id&&($("#repair_use_card_profile").prop("checked",!0),$("#repair_card_profile_select").prop("disabled",!1),$(".form-another-card input").prop("disabled",!0),$("#repair_use_another_card").prop("checked",!1),c.Z.loadAgentCardsVisibleToOffice($("#repair_card_profile_select"),e.repairOrder.agent.user.id,e.repairOrder.office.user.id));var a=$("#repairOrderModal");a.length&&a.modal("hide");var t=$("#repairPaymentModal");t.length&&(t.find('[name="repair_order_id"]').val(e.repairOrder.id),o.Z.hideLoader("repairPaymentModal"))}else window.location.reload()})).fail((function(e){var a=e.responseJSON,t="<ul>";for(var n in a.errors)$('[name^="'.concat(n,'"]')).addClass("is-invalid"),t+="<li class='text-danger'>"+a.errors[n]+"</li>";t+="</ul>",o.Z.alertError(t),r.find('[type="submit"]').prop("disabled",!1),r.find('[type="submit"]').html('<strong class="text-white">TRY AGAIN</strong>'),o.Z.hideLoader("")}))}))},loadSavedAdjustments:function(e){var r=$("#rowTmplRepair").html(),a=$("#rowContainerRepair"),t=0;u.pricingAdjustments={description:[],charge:[],discount:[]},a.empty(),$.each(e,(function(e,n){u.rowCount++;var o=r.replace(/rowCount/g,u.rowCount);a.append(o),$('[name="repair_price_adjustment_description['.concat(u.rowCount,']"]')).val(n.description),$('[name="repair_price_adjustment_charge['.concat(u.rowCount,']"]')).val(n.charge),$('[name="repair_price_adjustment_discount['.concat(u.rowCount,']"]')).val(n.discount),t=parseFloat(t)+parseFloat(n.charge),t=parseFloat(t)-parseFloat(n.discount),u.pricingAdjustments.description[e]=n.description,u.pricingAdjustments.charge[e]=n.charge,u.pricingAdjustments.discount[e]=n.discount,u.totalAdjusted=t,u.totalAdjusted<0?$("[repair-adjustments]").html('<span class="text-danger">- $'.concat(-1*u.totalAdjusted,"</span>")):$("[repair-adjustments]").html("$".concat(u.totalAdjusted))})),this.calculateAdjustments()},calculateAdjustments:function(){for(var e,r,a=0,t=u.rowCount,n=1;n<=t;n++)e=$('[name="repair_price_adjustment_charge['.concat(n,']"]')).val(),r=$('[name="repair_price_adjustment_discount['.concat(n,']"]')).val(),e>0&&(a=parseFloat(a)+parseFloat(e)),r>0&&(a=parseFloat(a)-parseFloat(r));u.totalAdjusted=a,u.totalAdjusted<0?$("[repair-adjustments]").html('<span class="text-danger">- $'.concat(-1*u.totalAdjusted,"</span>")):$("[repair-adjustments]").html("$".concat(u.totalAdjusted)),$('[name="repair_order_zone_fee"]').trigger("change")}};$((function(){u.init()}))}},e=>{e.O(0,[898],(()=>{return r=8619,e(e.s=r);var r}));e.O()}]);